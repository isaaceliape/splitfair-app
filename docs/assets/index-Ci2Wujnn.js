(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&e(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function e(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();const Rn="/splitfair-app/assets/AboutSection-B-RtKxza.css";class Ln extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.showOptions=!1}connectedCallback(){this.render()}onClickAboutBtn(r){r.preventDefault(),this.showOptions=!this.showOptions,this.render(),this.dispatchEvent(new CustomEvent("is-menun-open",{detail:this.showOptions}))}render(){this.shadowRoot.innerHTML=`
      <link rel="stylesheet" href="${Rn}">
      <section class="AboutSection ${this.showOptions?"showOptions":""}">
        <a href="#" class="about"> about </a>
        <div class="overlay">
          <div class="left-content"></div>
          <div class="right-content">
            <h1 class="title">About</h1>
          </div>
        </div>
      </section>
    `,this.shadowRoot.querySelector(".about").addEventListener("click",this.onClickAboutBtn),this.shadowRoot.querySelector(".left-content").addEventListener("click",this.onClickAboutBtn)}}customElements.define("about-section",Ln);const Dn="/splitfair-app/assets/DownloadAppSection-Bw2xVM7L.css";class In extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.showOptions=!1}connectedCallback(){this.render()}onClickDownloadApp(r){r.preventDefault(),this.showOptions=!this.showOptions,this.render(),this.dispatchEvent(new CustomEvent("is-menu-open",{detail:this.showOptions}))}render(){this.shadowRoot.innerHTML=`
      <link rel="stylesheet" href="${Dn}">
      <section class="DownloadAppSection ${this.showOptions?"showOptions":""}">
        <a href="#" class="download-app"> download app </a>
        <div class="overlay">
          <div class="left-content"></div>
          <div class="right-content">
            <a href="#" class="link desktop"> Desktop </a>
            <a href="#" class="link mobile"> Mobile </a>
          </div>
        </div>
      </section>
    `,this.shadowRoot.querySelector(".download-app").addEventListener("click",this.onClickDownloadApp),this.shadowRoot.querySelector(".left-content").addEventListener("click",this.onClickDownloadApp)}}customElements.define("download-app-section",In);const Un="/splitfair-app/assets/NumberPad-Cn01bI45.css";class $n extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.timeout=null,this.onKeyDownBound=this.onKeyDown.bind(this),this.onKeyupBound=this.onKeyup.bind(this)}connectedCallback(){this.render(),document.addEventListener("keydown",this.onKeyDownBound),document.addEventListener("keyup",this.onKeyupBound)}disconnectedCallback(){document.removeEventListener("keydown",this.onKeyDownBound),document.removeEventListener("keyup",this.onKeyupBound)}onTap(r){const t=r.currentTarget;clearTimeout(this.timeout),t.classList.add("pressed"),this.timeout=setTimeout(()=>{t.classList.remove("pressed")},200),this.dispatchEvent(new CustomEvent("tapped-button",{detail:t.innerText.trim()}))}onKeyup(r){const t=r.key==="Backspace",e=r.key==="Enter",i=this.isNumberKey(r.key);if(i&&this.dispatchEvent(new CustomEvent("tapped-button",{detail:r.key})),t&&this.dispatchEvent(new CustomEvent("tapped-button",{detail:"<"})),e&&this.dispatchEvent(new CustomEvent("tapped-button",{detail:"Enter"})),i||t||e){const n=t?"Backspace":e?"Enter":r.key,o=this.shadowRoot.querySelector(`.button-${n}`);o&&(o.classList.add("pressed"),setTimeout(()=>{o.classList.remove("pressed")},200))}}onKeyDown(r){}isNumberKey(r){var t=new RegExp("^[0-9]+$");return t.test(r)}render(){this.shadowRoot.innerHTML=`
      <link rel="stylesheet" href="${Un}">
      <div class="NumberPad">
        <div class="button-row">
          <div class="button button-7">7</div>
          <div class="button button-8">8</div>
          <div class="button button-9">9</div>
        </div>
        <div class="button-row">
          <div class="button button-4">4</div>
          <div class="button button-5">5</div>
          <div class="button button-6">6</div>
        </div>
        <div class="button-row">
          <div class="button button-1">1</div>
          <div class="button button-2">2</div>
          <div class="button button-3">3</div>
        </div>
        <div class="button-row">
          <div class="button clear button-Backspace">&lt;</div>
          <div class="button button-0">0</div>
          <div class="button enter button-Enter">Enter</div>
        </div>
      </div>
    `,this.shadowRoot.querySelectorAll(".button").forEach(r=>{r.addEventListener("click",this.onTap)})}}customElements.define("number-pad",$n);var V=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bn(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var nr={exports:{}},ur={},fr={},X={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var r=Math.PI/180;function t(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}var e=function(i){var n=i.indexOf("msie ");if(n>0)return parseInt(i.substring(n+5,i.indexOf(".",n)),10);var o=i.indexOf("trident/");if(o>0){var s=i.indexOf("rv:");return parseInt(i.substring(s+3,i.indexOf(".",s)),10)}var h=i.indexOf("edge/");return h>0?parseInt(i.substring(h+5,i.indexOf(".",h)),10):!1};a._parseUA=function(i){var n=i.toLowerCase(),o=/(chrome)[ /]([\w.]+)/.exec(n)||/(webkit)[ /]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ /]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[],s=!!i.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i),h=!!i.match(/IEMobile/i);return{browser:o[1]||"",version:o[2]||"0",isIE:e(n),mobile:s,ieMobile:h}},a.glob=typeof V<"u"?V:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},a.Konva={_global:a.glob,version:"6.0.0",isBrowser:t(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle:function(i){return a.Konva.angleDeg?i*r:i},enableTrace:!1,_pointerEventsEnabled:!1,hitOnDragEnabled:!1,captureTouchEventsEnabled:!1,listenClickTap:!1,inDblClickWindow:!1,pixelRatio:void 0,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging:function(){return a.Konva.DD.isDragging},isDragReady:function(){return!!a.Konva.DD.node},UA:a._parseUA(a.glob.navigator&&a.glob.navigator.userAgent||""),document:a.glob.document,_injectGlobal:function(i){a.glob.Konva=i},_parseUA:a._parseUA},a._NODES_REGISTRY={},a._registerNode=function(i){a._NODES_REGISTRY[i.prototype.getClassName()]=i,a.Konva[i.prototype.getClassName()]=i}})(X);var J={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var r=X,t=function(){function d(){}return d.toCollection=function(v){var m=new d,T=v.length,E;for(E=0;E<T;E++)m.push(v[E]);return m},d._mapMethod=function(v){d.prototype[v]=function(){var m=this.length,T,E=[].slice.call(arguments);for(T=0;T<m;T++)this[T][v].apply(this[T],E);return this}},d.mapMethods=function(v){var m=v.prototype;for(var T in m)d._mapMethod(T)},d}();a.Collection=t,t.prototype=[],t.prototype.each=function(d){for(var v=0;v<this.length;v++)d(this[v],v)},t.prototype.toArray=function(){var d=[],v=this.length,m;for(m=0;m<v;m++)d.push(this[m]);return d};var e=function(){function d(v){v===void 0&&(v=[1,0,0,1,0,0]),this.m=v&&v.slice()||[1,0,0,1,0,0]}return d.prototype.copy=function(){return new d(this.m)},d.prototype.point=function(v){var m=this.m;return{x:m[0]*v.x+m[2]*v.y+m[4],y:m[1]*v.x+m[3]*v.y+m[5]}},d.prototype.translate=function(v,m){return this.m[4]+=this.m[0]*v+this.m[2]*m,this.m[5]+=this.m[1]*v+this.m[3]*m,this},d.prototype.scale=function(v,m){return this.m[0]*=v,this.m[1]*=v,this.m[2]*=m,this.m[3]*=m,this},d.prototype.rotate=function(v){var m=Math.cos(v),T=Math.sin(v),E=this.m[0]*m+this.m[2]*T,x=this.m[1]*m+this.m[3]*T,N=this.m[0]*-T+this.m[2]*m,k=this.m[1]*-T+this.m[3]*m;return this.m[0]=E,this.m[1]=x,this.m[2]=N,this.m[3]=k,this},d.prototype.getTranslation=function(){return{x:this.m[4],y:this.m[5]}},d.prototype.skew=function(v,m){var T=this.m[0]+this.m[2]*m,E=this.m[1]+this.m[3]*m,x=this.m[2]+this.m[0]*v,N=this.m[3]+this.m[1]*v;return this.m[0]=T,this.m[1]=E,this.m[2]=x,this.m[3]=N,this},d.prototype.multiply=function(v){var m=this.m[0]*v.m[0]+this.m[2]*v.m[1],T=this.m[1]*v.m[0]+this.m[3]*v.m[1],E=this.m[0]*v.m[2]+this.m[2]*v.m[3],x=this.m[1]*v.m[2]+this.m[3]*v.m[3],N=this.m[0]*v.m[4]+this.m[2]*v.m[5]+this.m[4],k=this.m[1]*v.m[4]+this.m[3]*v.m[5]+this.m[5];return this.m[0]=m,this.m[1]=T,this.m[2]=E,this.m[3]=x,this.m[4]=N,this.m[5]=k,this},d.prototype.invert=function(){var v=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),m=this.m[3]*v,T=-this.m[1]*v,E=-this.m[2]*v,x=this.m[0]*v,N=v*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),k=v*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=m,this.m[1]=T,this.m[2]=E,this.m[3]=x,this.m[4]=N,this.m[5]=k,this},d.prototype.getMatrix=function(){return this.m},d.prototype.setAbsolutePosition=function(v,m){var T=this.m[0],E=this.m[1],x=this.m[2],N=this.m[3],k=this.m[4],A=this.m[5],D=(T*(m-A)-E*(v-k))/(T*N-E*x),R=(v-k-x*D)/T;return this.translate(R,D)},d.prototype.decompose=function(){var v=this.m[0],m=this.m[1],T=this.m[2],E=this.m[3],x=this.m[4],N=this.m[5],k=v*E-m*T,A={x,y:N,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(v!=0||m!=0){var D=Math.sqrt(v*v+m*m);A.rotation=m>0?Math.acos(v/D):-Math.acos(v/D),A.scaleX=D,A.scaleY=k/D,A.skewX=(v*T+m*E)/k,A.skewY=0}else if(T!=0||E!=0){var R=Math.sqrt(T*T+E*E);A.rotation=Math.PI/2-(E>0?Math.acos(-T/R):-Math.acos(T/R)),A.scaleX=k/R,A.scaleY=R,A.skewX=0,A.skewY=(v*T+m*E)/k}return A.rotation=a.Util._getRotation(A.rotation),A},d}();a.Transform=e;var i="[object Array]",n="[object Number]",o="[object String]",s="[object Boolean]",h=Math.PI/180,l=180/Math.PI,u="#",w="",O="0",f="Konva warning: ",y="Konva error: ",g="rgb(",P={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},b=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,G=[];a.Util={_isElement:function(d){return!!(d&&d.nodeType==1)},_isFunction:function(d){return!!(d&&d.constructor&&d.call&&d.apply)},_isPlainObject:function(d){return!!d&&d.constructor===Object},_isArray:function(d){return Object.prototype.toString.call(d)===i},_isNumber:function(d){return Object.prototype.toString.call(d)===n&&!isNaN(d)&&isFinite(d)},_isString:function(d){return Object.prototype.toString.call(d)===o},_isBoolean:function(d){return Object.prototype.toString.call(d)===s},isObject:function(d){return d instanceof Object},isValidSelector:function(d){if(typeof d!="string")return!1;var v=d[0];return v==="#"||v==="."||v===v.toUpperCase()},_sign:function(d){return d===0?0:d>0?1:-1},requestAnimFrame:function(d){G.push(d),G.length===1&&requestAnimationFrame(function(){var v=G;G=[],v.forEach(function(m){m()})})},createCanvasElement:function(){var d=document.createElement("canvas");try{d.style=d.style||{}}catch{}return d},createImageElement:function(){return document.createElement("img")},_isInDocument:function(d){for(;d=d.parentNode;)if(d==document)return!0;return!1},_simplifyArray:function(d){var v=[],m=d.length,T=a.Util,E,x;for(E=0;E<m;E++)x=d[E],T._isNumber(x)?x=Math.round(x*1e3)/1e3:T._isString(x)||(x=x.toString()),v.push(x);return v},_urlToImage:function(d,v){var m=new r.glob.Image;m.onload=function(){v(m)},m.src=d},_rgbToHex:function(d,v,m){return((1<<24)+(d<<16)+(v<<8)+m).toString(16).slice(1)},_hexToRgb:function(d){d=d.replace(u,w);var v=parseInt(d,16);return{r:v>>16&255,g:v>>8&255,b:v&255}},getRandomColor:function(){for(var d=(Math.random()*16777215<<0).toString(16);d.length<6;)d=O+d;return u+d},get:function(d,v){return d===void 0?v:d},getRGB:function(d){var v;return d in P?(v=P[d],{r:v[0],g:v[1],b:v[2]}):d[0]===u?this._hexToRgb(d.substring(1)):d.substr(0,4)===g?(v=b.exec(d.replace(/ /g,"")),{r:parseInt(v[1],10),g:parseInt(v[2],10),b:parseInt(v[3],10)}):{r:0,g:0,b:0}},colorToRGBA:function(d){return d=d||"black",a.Util._namedColorToRBA(d)||a.Util._hex3ColorToRGBA(d)||a.Util._hex6ColorToRGBA(d)||a.Util._rgbColorToRGBA(d)||a.Util._rgbaColorToRGBA(d)||a.Util._hslColorToRGBA(d)},_namedColorToRBA:function(d){var v=P[d.toLowerCase()];return v?{r:v[0],g:v[1],b:v[2],a:1}:null},_rgbColorToRGBA:function(d){if(d.indexOf("rgb(")===0){d=d.match(/rgb\(([^)]+)\)/)[1];var v=d.split(/ *, */).map(Number);return{r:v[0],g:v[1],b:v[2],a:1}}},_rgbaColorToRGBA:function(d){if(d.indexOf("rgba(")===0){d=d.match(/rgba\(([^)]+)\)/)[1];var v=d.split(/ *, */).map(Number);return{r:v[0],g:v[1],b:v[2],a:v[3]}}},_hex6ColorToRGBA:function(d){if(d[0]==="#"&&d.length===7)return{r:parseInt(d.slice(1,3),16),g:parseInt(d.slice(3,5),16),b:parseInt(d.slice(5,7),16),a:1}},_hex3ColorToRGBA:function(d){if(d[0]==="#"&&d.length===4)return{r:parseInt(d[1]+d[1],16),g:parseInt(d[2]+d[2],16),b:parseInt(d[3]+d[3],16),a:1}},_hslColorToRGBA:function(d){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(d)){var v=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(d);v[0];var m=v.slice(1),T=Number(m[0])/360,E=Number(m[1])/100,x=Number(m[2])/100,N=void 0,k=void 0,A=void 0;if(E===0)return A=x*255,{r:Math.round(A),g:Math.round(A),b:Math.round(A),a:1};x<.5?N=x*(1+E):N=x+E-x*E;for(var D=2*x-N,R=[0,0,0],S=0;S<3;S++)k=T+1/3*-(S-1),k<0&&k++,k>1&&k--,6*k<1?A=D+(N-D)*6*k:2*k<1?A=N:3*k<2?A=D+(N-D)*(2/3-k)*6:A=D,R[S]=A*255;return{r:Math.round(R[0]),g:Math.round(R[1]),b:Math.round(R[2]),a:1}}},haveIntersection:function(d,v){return!(v.x>d.x+d.width||v.x+v.width<d.x||v.y>d.y+d.height||v.y+v.height<d.y)},cloneObject:function(d){var v={};for(var m in d)this._isPlainObject(d[m])?v[m]=this.cloneObject(d[m]):this._isArray(d[m])?v[m]=this.cloneArray(d[m]):v[m]=d[m];return v},cloneArray:function(d){return d.slice(0)},_degToRad:function(d){return d*h},_radToDeg:function(d){return d*l},_getRotation:function(d){return r.Konva.angleDeg?a.Util._radToDeg(d):d},_capitalize:function(d){return d.charAt(0).toUpperCase()+d.slice(1)},throw:function(d){throw new Error(y+d)},error:function(d){console.error(y+d)},warn:function(d){r.Konva.showWarnings&&console.warn(f+d)},extend:function(d,v){function m(){this.constructor=d}m.prototype=v.prototype;var T=d.prototype;d.prototype=new m;for(var E in T)T.hasOwnProperty(E)&&(d.prototype[E]=T[E]);d.__super__=v.prototype,d.super=v},_getControlPoints:function(d,v,m,T,E,x,N){var k=Math.sqrt(Math.pow(m-d,2)+Math.pow(T-v,2)),A=Math.sqrt(Math.pow(E-m,2)+Math.pow(x-T,2)),D=N*k/(k+A),R=N*A/(k+A),S=m-D*(E-d),c=T-D*(x-v),p=m+R*(E-d),_=T+R*(x-v);return[S,c,p,_]},_expandPoints:function(d,v){var m=d.length,T=[],E,x;for(E=2;E<m-2;E+=2)x=a.Util._getControlPoints(d[E-2],d[E-1],d[E],d[E+1],d[E+2],d[E+3],v),T.push(x[0]),T.push(x[1]),T.push(d[E]),T.push(d[E+1]),T.push(x[2]),T.push(x[3]);return T},each:function(d,v){for(var m in d)v(m,d[m])},_inRange:function(d,v,m){return v<=d&&d<m},_getProjectionToSegment:function(d,v,m,T,E,x){var N,k,A,D=(d-m)*(d-m)+(v-T)*(v-T);if(D==0)N=d,k=v,A=(E-m)*(E-m)+(x-T)*(x-T);else{var R=((E-d)*(m-d)+(x-v)*(T-v))/D;R<0?(N=d,k=v,A=(d-E)*(d-E)+(v-x)*(v-x)):R>1?(N=m,k=T,A=(m-E)*(m-E)+(T-x)*(T-x)):(N=d+R*(m-d),k=v+R*(T-v),A=(N-E)*(N-E)+(k-x)*(k-x))}return[N,k,A]},_getProjectionToLine:function(d,v,m){var T=a.Util.cloneObject(d),E=Number.MAX_VALUE;return v.forEach(function(x,N){if(!(!m&&N===v.length-1)){var k=v[(N+1)%v.length],A=a.Util._getProjectionToSegment(x.x,x.y,k.x,k.y,d.x,d.y),D=A[0],R=A[1],S=A[2];S<E&&(T.x=D,T.y=R,E=S)}}),T},_prepareArrayForTween:function(d,v,m){var T,E=[],x=[];if(d.length>v.length){var N=v;v=d,d=N}for(T=0;T<d.length;T+=2)E.push({x:d[T],y:d[T+1]});for(T=0;T<v.length;T+=2)x.push({x:v[T],y:v[T+1]});var k=[];return x.forEach(function(A){var D=a.Util._getProjectionToLine(A,E,m);k.push(D.x),k.push(D.y)}),k},_prepareToStringify:function(d){var v;d.visitedByCircularReferenceRemoval=!0;for(var m in d)if(d.hasOwnProperty(m)&&d[m]&&typeof d[m]=="object"){if(v=Object.getOwnPropertyDescriptor(d,m),d[m].visitedByCircularReferenceRemoval||a.Util._isElement(d[m]))if(v.configurable)delete d[m];else return null;else if(a.Util._prepareToStringify(d[m])===null)if(v.configurable)delete d[m];else return null}return delete d.visitedByCircularReferenceRemoval,d},_assign:function(d,v){for(var m in v)d[m]=v[m];return d},_getFirstPointerId:function(d){return d.touches?d.changedTouches[0].identifier:999}}})(J);var rt={},Y={},W={};Object.defineProperty(W,"__esModule",{value:!0});var Dt=X,dt=J;function It(a){return dt.Util._isString(a)?'"'+a+'"':Object.prototype.toString.call(a)==="[object Number]"||dt.Util._isBoolean(a)?a:Object.prototype.toString.call(a)}function Vn(a){return a>255?255:a<0?0:Math.round(a)}W.RGBComponent=Vn;function Hn(a){return a>1?1:a<1e-4?1e-4:a}W.alphaComponent=Hn;function zn(){if(Dt.Konva.isUnminified)return function(a,r){return dt.Util._isNumber(a)||dt.Util.warn(It(a)+' is a not valid value for "'+r+'" attribute. The value should be a number.'),a}}W.getNumberValidator=zn;function Wn(){if(Dt.Konva.isUnminified)return function(a,r){var t=dt.Util._isNumber(a),e=a==="auto";return t||e||dt.Util.warn(It(a)+' is a not valid value for "'+r+'" attribute. The value should be a number or "auto".'),a}}W.getNumberOrAutoValidator=Wn;function jn(){if(Dt.Konva.isUnminified)return function(a,r){return dt.Util._isString(a)||dt.Util.warn(It(a)+' is a not valid value for "'+r+'" attribute. The value should be a string.'),a}}W.getStringValidator=jn;function Kn(){if(Dt.Konva.isUnminified)return function(a,r){return dt.Util._isFunction(a)||dt.Util.warn(It(a)+' is a not valid value for "'+r+'" attribute. The value should be a function.'),a}}W.getFunctionValidator=Kn;function Yn(){if(Dt.Konva.isUnminified)return function(a,r){return dt.Util._isArray(a)?a.forEach(function(t){dt.Util._isNumber(t)||dt.Util.warn('"'+r+'" attribute has non numeric element '+t+". Make sure that all elements are numbers.")}):dt.Util.warn(It(a)+' is a not valid value for "'+r+'" attribute. The value should be a array of numbers.'),a}}W.getNumberArrayValidator=Yn;function Xn(){if(Dt.Konva.isUnminified)return function(a,r){var t=a===!0||a===!1;return t||dt.Util.warn(It(a)+' is a not valid value for "'+r+'" attribute. The value should be a boolean.'),a}}W.getBooleanValidator=Xn;function qn(a){if(Dt.Konva.isUnminified)return function(r,t){return dt.Util.isObject(r)||dt.Util.warn(It(r)+' is a not valid value for "'+t+'" attribute. The value should be an object with properties '+a),r}}W.getComponentValidator=qn;(function(a){Object.defineProperty(a,"__esModule",{value:!0});var r=J,t=W,e="get",i="set";a.Factory={addGetterSetter:function(n,o,s,h,l){this.addGetter(n,o,s),this.addSetter(n,o,h,l),this.addOverloadedGetterSetter(n,o)},addGetter:function(n,o,s){var h=e+r.Util._capitalize(o);n.prototype[h]=n.prototype[h]||function(){var l=this.attrs[o];return l===void 0?s:l}},addSetter:function(n,o,s,h){var l=i+r.Util._capitalize(o);n.prototype[l]||a.Factory.overWriteSetter(n,o,s,h)},overWriteSetter:function(n,o,s,h){var l=i+r.Util._capitalize(o);n.prototype[l]=function(u){return s&&u!==void 0&&u!==null&&(u=s.call(this,u,o)),this._setAttr(o,u),h&&h.call(this),this}},addComponentsGetterSetter:function(n,o,s,h,l){var u=s.length,w=r.Util._capitalize,O=e+w(o),f=i+w(o),y,g;n.prototype[O]=function(){var b={};for(y=0;y<u;y++)g=s[y],b[g]=this.getAttr(o+w(g));return b};var P=t.getComponentValidator(s);n.prototype[f]=function(b){var G=this.attrs[o],d;h&&(b=h.call(this,b)),P&&P.call(this,b,o);for(d in b)b.hasOwnProperty(d)&&this._setAttr(o+w(d),b[d]);return this._fireChangeEvent(o,G,b),l&&l.call(this),this},this.addOverloadedGetterSetter(n,o)},addOverloadedGetterSetter:function(n,o){var s=r.Util._capitalize(o),h=i+s,l=e+s;n.prototype[o]=function(){return arguments.length?(this[h](arguments[0]),this):this[l]()}},addDeprecatedGetterSetter:function(n,o,s,h){r.Util.error("Adding deprecated "+o);var l=e+r.Util._capitalize(o),u=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";n.prototype[l]=function(){r.Util.error(u);var w=this.attrs[o];return w===void 0?s:w},this.addSetter(n,o,h,function(){r.Util.error(u)}),this.addOverloadedGetterSetter(n,o)},backCompat:function(n,o){r.Util.each(o,function(s,h){var l=n.prototype[h],u=e+r.Util._capitalize(s),w=i+r.Util._capitalize(s);function O(){l.apply(this,arguments),r.Util.error('"'+s+'" method is deprecated and will be removed soon. Use ""'+h+'" instead.')}n.prototype[s]=O,n.prototype[u]=O,n.prototype[w]=O})},afterSetFilter:function(){this._filterUpToDate=!1}}})(Y);var xt={},Xt={},Di=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(Xt,"__esModule",{value:!0});var ar=J,Ii=X,oi=",",Jn="(",Qn=")",Zn="([",ta="])",ea=";",ra="()",ia="=",si=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],na=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],aa=100,Ee=function(){function a(r){this.canvas=r,this._context=r._canvas.getContext("2d"),Ii.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}return a.prototype.fillShape=function(r){r.fillEnabled()&&this._fill(r)},a.prototype._fill=function(r){},a.prototype.strokeShape=function(r){r.hasStroke()&&this._stroke(r)},a.prototype._stroke=function(r){},a.prototype.fillStrokeShape=function(r){this.fillShape(r),this.strokeShape(r)},a.prototype.getTrace=function(r){var t=this.traceArr,e=t.length,i="",n,o,s,h;for(n=0;n<e;n++)o=t[n],s=o.method,s?(h=o.args,i+=s,r?i+=ra:ar.Util._isArray(h[0])?i+=Zn+h.join(oi)+ta:i+=Jn+h.join(oi)+Qn):(i+=o.property,r||(i+=ia+o.val)),i+=ea;return i},a.prototype.clearTrace=function(){this.traceArr=[]},a.prototype._trace=function(r){var t=this.traceArr,e;t.push(r),e=t.length,e>=aa&&t.shift()},a.prototype.reset=function(){var r=this.getCanvas().getPixelRatio();this.setTransform(1*r,0,0,1*r,0,0)},a.prototype.getCanvas=function(){return this.canvas},a.prototype.clear=function(r){var t=this.getCanvas();r?this.clearRect(r.x||0,r.y||0,r.width||0,r.height||0):this.clearRect(0,0,t.getWidth()/t.pixelRatio,t.getHeight()/t.pixelRatio)},a.prototype._applyLineCap=function(r){var t=r.getLineCap();t&&this.setAttr("lineCap",t)},a.prototype._applyOpacity=function(r){var t=r.getAbsoluteOpacity();t!==1&&this.setAttr("globalAlpha",t)},a.prototype._applyLineJoin=function(r){var t=r.getLineJoin();t&&this.setAttr("lineJoin",t)},a.prototype.setAttr=function(r,t){this._context[r]=t},a.prototype.arc=function(r,t,e,i,n,o){this._context.arc(r,t,e,i,n,o)},a.prototype.arcTo=function(r,t,e,i,n){this._context.arcTo(r,t,e,i,n)},a.prototype.beginPath=function(){this._context.beginPath()},a.prototype.bezierCurveTo=function(r,t,e,i,n,o){this._context.bezierCurveTo(r,t,e,i,n,o)},a.prototype.clearRect=function(r,t,e,i){this._context.clearRect(r,t,e,i)},a.prototype.clip=function(){this._context.clip()},a.prototype.closePath=function(){this._context.closePath()},a.prototype.createImageData=function(r,t){var e=arguments;if(e.length===2)return this._context.createImageData(r,t);if(e.length===1)return this._context.createImageData(r)},a.prototype.createLinearGradient=function(r,t,e,i){return this._context.createLinearGradient(r,t,e,i)},a.prototype.createPattern=function(r,t){return this._context.createPattern(r,t)},a.prototype.createRadialGradient=function(r,t,e,i,n,o){return this._context.createRadialGradient(r,t,e,i,n,o)},a.prototype.drawImage=function(r,t,e,i,n,o,s,h,l){var u=arguments,w=this._context;u.length===3?w.drawImage(r,t,e):u.length===5?w.drawImage(r,t,e,i,n):u.length===9&&w.drawImage(r,t,e,i,n,o,s,h,l)},a.prototype.ellipse=function(r,t,e,i,n,o,s,h){this._context.ellipse(r,t,e,i,n,o,s,h)},a.prototype.isPointInPath=function(r,t){return this._context.isPointInPath(r,t)},a.prototype.fill=function(){this._context.fill()},a.prototype.fillRect=function(r,t,e,i){this._context.fillRect(r,t,e,i)},a.prototype.strokeRect=function(r,t,e,i){this._context.strokeRect(r,t,e,i)},a.prototype.fillText=function(r,t,e){this._context.fillText(r,t,e)},a.prototype.measureText=function(r){return this._context.measureText(r)},a.prototype.getImageData=function(r,t,e,i){return this._context.getImageData(r,t,e,i)},a.prototype.lineTo=function(r,t){this._context.lineTo(r,t)},a.prototype.moveTo=function(r,t){this._context.moveTo(r,t)},a.prototype.rect=function(r,t,e,i){this._context.rect(r,t,e,i)},a.prototype.putImageData=function(r,t,e){this._context.putImageData(r,t,e)},a.prototype.quadraticCurveTo=function(r,t,e,i){this._context.quadraticCurveTo(r,t,e,i)},a.prototype.restore=function(){this._context.restore()},a.prototype.rotate=function(r){this._context.rotate(r)},a.prototype.save=function(){this._context.save()},a.prototype.scale=function(r,t){this._context.scale(r,t)},a.prototype.setLineDash=function(r){this._context.setLineDash?this._context.setLineDash(r):"mozDash"in this._context?this._context.mozDash=r:"webkitLineDash"in this._context&&(this._context.webkitLineDash=r)},a.prototype.getLineDash=function(){return this._context.getLineDash()},a.prototype.setTransform=function(r,t,e,i,n,o){this._context.setTransform(r,t,e,i,n,o)},a.prototype.stroke=function(){this._context.stroke()},a.prototype.strokeText=function(r,t,e,i){this._context.strokeText(r,t,e,i)},a.prototype.transform=function(r,t,e,i,n,o){this._context.transform(r,t,e,i,n,o)},a.prototype.translate=function(r,t){this._context.translate(r,t)},a.prototype._enableTrace=function(){var r=this,t=si.length,e=ar.Util._simplifyArray,i=this.setAttr,n,o,s=function(h){var l=r[h],u;r[h]=function(){return o=e(Array.prototype.slice.call(arguments,0)),u=l.apply(r,arguments),r._trace({method:h,args:o}),u}};for(n=0;n<t;n++)s(si[n]);r.setAttr=function(){i.apply(r,arguments);var h=arguments[0],l=arguments[1];(h==="shadowOffsetX"||h==="shadowOffsetY"||h==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),r._trace({property:h,val:l})}},a.prototype._applyGlobalCompositeOperation=function(r){var t=r.getGlobalCompositeOperation();t!=="source-over"&&this.setAttr("globalCompositeOperation",t)},a}();Xt.Context=Ee;na.forEach(function(a){Object.defineProperty(Ee.prototype,a,{get:function(){return this._context[a]},set:function(r){this._context[a]=r}})});var oa=function(a){Di(r,a);function r(){return a!==null&&a.apply(this,arguments)||this}return r.prototype._fillColor=function(t){var e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)},r.prototype._fillPattern=function(t){var e=t.getFillPatternX(),i=t.getFillPatternY(),n=Ii.Konva.getAngle(t.getFillPatternRotation()),o=t.getFillPatternOffsetX(),s=t.getFillPatternOffsetY(),h=t.getFillPatternScaleX(),l=t.getFillPatternScaleY();(e||i)&&this.translate(e||0,i||0),n&&this.rotate(n),(h||l)&&this.scale(h,l),(o||s)&&this.translate(-1*o,-1*s),this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)},r.prototype._fillLinearGradient=function(t){var e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))},r.prototype._fillRadialGradient=function(t){var e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))},r.prototype._fill=function(t){var e=t.fill(),i=t.getFillPriority();if(e&&i==="color"){this._fillColor(t);return}var n=t.getFillPatternImage();if(n&&i==="pattern"){this._fillPattern(t);return}var o=t.getFillLinearGradientColorStops();if(o&&i==="linear-gradient"){this._fillLinearGradient(t);return}var s=t.getFillRadialGradientColorStops();if(s&&i==="radial-gradient"){this._fillRadialGradient(t);return}e?this._fillColor(t):n?this._fillPattern(t):o?this._fillLinearGradient(t):s&&this._fillRadialGradient(t)},r.prototype._strokeLinearGradient=function(t){var e=t.getStrokeLinearGradientStartPoint(),i=t.getStrokeLinearGradientEndPoint(),n=t.getStrokeLinearGradientColorStops(),o=this.createLinearGradient(e.x,e.y,i.x,i.y);if(n){for(var s=0;s<n.length;s+=2)o.addColorStop(n[s],n[s+1]);this.setAttr("strokeStyle",o)}},r.prototype._stroke=function(t){var e=t.dash(),i=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!i){this.save();var n=this.getCanvas().getPixelRatio();this.setTransform(n,0,0,n,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)");var o=t.getStrokeLinearGradientColorStops();o?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),i||this.restore()}},r.prototype._applyShadow=function(t){var e=ar.Util,i=e.get(t.getShadowRGBA(),"black"),n=e.get(t.getShadowBlur(),5),o=e.get(t.getShadowOffset(),{x:0,y:0}),s=t.getAbsoluteScale(),h=this.canvas.getPixelRatio(),l=s.x*h,u=s.y*h;this.setAttr("shadowColor",i),this.setAttr("shadowBlur",n*Math.min(Math.abs(l),Math.abs(u))),this.setAttr("shadowOffsetX",o.x*l),this.setAttr("shadowOffsetY",o.y*u)},r}(Ee);Xt.SceneContext=oa;var sa=function(a){Di(r,a);function r(){return a!==null&&a.apply(this,arguments)||this}return r.prototype._fill=function(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()},r.prototype.strokeShape=function(t){t.hasHitStroke()&&this._stroke(t)},r.prototype._stroke=function(t){if(t.hasHitStroke()){var e=t.getStrokeScaleEnabled();if(!e){this.save();var i=this.getCanvas().getPixelRatio();this.setTransform(i,0,0,i,0,0)}this._applyLineCap(t);var n=t.hitStrokeWidth(),o=n==="auto"?t.strokeWidth():n;this.setAttr("lineWidth",o),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),e||this.restore()}},r}(Ee);Xt.HitContext=sa;var Ui=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(xt,"__esModule",{value:!0});var or=J,$i=Xt,Bi=X,ha=Y,la=W,ge;function da(){if(ge)return ge;var a=or.Util.createCanvasElement(),r=a.getContext("2d");return ge=function(){var t=Bi.Konva._global.devicePixelRatio||1,e=r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1;return t/e}(),ge}var ke=function(){function a(r){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var t=r||{},e=t.pixelRatio||Bi.Konva.pixelRatio||da();this.pixelRatio=e,this._canvas=or.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}return a.prototype.getContext=function(){return this.context},a.prototype.getPixelRatio=function(){return this.pixelRatio},a.prototype.setPixelRatio=function(r){var t=this.pixelRatio;this.pixelRatio=r,this.setSize(this.getWidth()/t,this.getHeight()/t)},a.prototype.setWidth=function(r){this.width=this._canvas.width=r*this.pixelRatio,this._canvas.style.width=r+"px";var t=this.pixelRatio,e=this.getContext()._context;e.scale(t,t)},a.prototype.setHeight=function(r){this.height=this._canvas.height=r*this.pixelRatio,this._canvas.style.height=r+"px";var t=this.pixelRatio,e=this.getContext()._context;e.scale(t,t)},a.prototype.getWidth=function(){return this.width},a.prototype.getHeight=function(){return this.height},a.prototype.setSize=function(r,t){this.setWidth(r||0),this.setHeight(t||0)},a.prototype.toDataURL=function(r,t){try{return this._canvas.toDataURL(r,t)}catch{try{return this._canvas.toDataURL()}catch(i){return or.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}},a}();xt.Canvas=ke;ha.Factory.addGetterSetter(ke,"pixelRatio",void 0,la.getNumberValidator());var ca=function(a){Ui(r,a);function r(t){t===void 0&&(t={width:0,height:0});var e=a.call(this,t)||this;return e.context=new $i.SceneContext(e),e.setSize(t.width,t.height),e}return r}(ke);xt.SceneCanvas=ca;var ua=function(a){Ui(r,a);function r(t){t===void 0&&(t={width:0,height:0});var e=a.call(this,t)||this;return e.hitCanvas=!0,e.context=new $i.HitContext(e),e.setSize(t.width,t.height),e}return r}(ke);xt.HitCanvas=ua;var he={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var r=X,t=J;a.DD={get isDragging(){var e=!1;return a.DD._dragElements.forEach(function(i){i.dragStatus==="dragging"&&(e=!0)}),e},justDragged:!1,get node(){var e;return a.DD._dragElements.forEach(function(i){e=i.node}),e},_dragElements:new Map,_drag:function(e){a.DD._dragElements.forEach(function(i,n){var o=i.node,s=o.getStage();s.setPointersPositions(e),i.pointerId===void 0&&(i.pointerId=t.Util._getFirstPointerId(e));var h=s._changedPointerPositions.find(function(w){return w.id===i.pointerId});if(h){if(i.dragStatus!=="dragging"){var l=o.dragDistance(),u=Math.max(Math.abs(h.x-i.startPointerPos.x),Math.abs(h.y-i.startPointerPos.y));if(u<l||(o.startDrag({evt:e}),!o.isDragging()))return}o._setDragPosition(e,i),o.fire("dragmove",{type:"dragmove",target:o,evt:e},!0)}})},_endDragBefore:function(e){a.DD._dragElements.forEach(function(i,n){var o=i.node,s=o.getStage();e&&s.setPointersPositions(e);var h=s._changedPointerPositions.find(function(u){return u.id===i.pointerId});if(h){(i.dragStatus==="dragging"||i.dragStatus==="stopped")&&(a.DD.justDragged=!0,r.Konva.listenClickTap=!1,i.dragStatus="stopped");var l=i.node.getLayer()||i.node instanceof r.Konva.Stage&&i.node;l&&l.draw()}})},_endDragAfter:function(e){a.DD._dragElements.forEach(function(i,n){i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:e},!0),i.dragStatus!=="dragging"&&a.DD._dragElements.delete(n)})}},r.Konva.isBrowser&&(window.addEventListener("mouseup",a.DD._endDragBefore,!0),window.addEventListener("touchend",a.DD._endDragBefore,!0),window.addEventListener("mousemove",a.DD._drag),window.addEventListener("touchmove",a.DD._drag),window.addEventListener("mouseup",a.DD._endDragAfter,!1),window.addEventListener("touchend",a.DD._endDragAfter,!1))})(he);(function(a){Object.defineProperty(a,"__esModule",{value:!0});var r=J,t=Y,e=xt,i=X,n=he,o=W;a.ids={},a.names={};var s=function(S,c){c&&(a.ids[c]=S)};a._removeId=function(S,c){S&&a.ids[S]===c&&delete a.ids[S]},a._addName=function(S,c){c&&(a.names[c]||(a.names[c]=[]),a.names[c].push(S))},a._removeName=function(S,c){if(S){var p=a.names[S];if(p){for(var _=0;_<p.length;_++){var F=p[_];F._id===c&&p.splice(_,1)}p.length===0&&delete a.names[S]}}};var h="absoluteOpacity",l="absoluteTransform",u="absoluteScale",w="canvas",O="Change",f="children",y="konva",g="listening",P="mouseenter",b="mouseleave",G="name",d="set",v="Shape",m=" ",T="stage",E="transform",x="Stage",N="visible",k=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(m),A=new r.Collection,D=1,R=function(){function S(c){var p=this;this._id=D++,this.eventListeners={},this.attrs={},this.index=0,this.parent=null,this._cache=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this.children=A,this._dragEventId=null,this.setAttrs(c),this.on(k,function(){if(p._batchingTransformChange){p._needClearTransformCache=!0;return}p._clearCache(E),p._clearSelfAndDescendantCache(l)}),this.on("visibleChange.konva",function(){p._clearSelfAndDescendantCache(N)}),this.on("listeningChange.konva",function(){p._clearSelfAndDescendantCache(g)}),this.on("opacityChange.konva",function(){p._clearSelfAndDescendantCache(h)})}return S.prototype.hasChildren=function(){return!1},S.prototype.getChildren=function(){return A},S.prototype._clearCache=function(c){c?this._cache.delete(c):this._cache.clear()},S.prototype._getCache=function(c,p){var _=this._cache.get(c);return _===void 0&&(_=p.call(this),this._cache.set(c,_)),_},S.prototype._getCanvasCache=function(){return this._cache.get(w)},S.prototype._clearSelfAndDescendantCache=function(c,p){this._clearCache(c),p&&c===l&&this.fire("_clearTransformCache"),!this.isCached()&&this.children&&this.children.each(function(_){_._clearSelfAndDescendantCache(c,!0)})},S.prototype.clearCache=function(){return this._cache.delete(w),this._clearSelfAndDescendantCache(),this},S.prototype.cache=function(c){var p=c||{},_={};(p.x===void 0||p.y===void 0||p.width===void 0||p.height===void 0)&&(_=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()}));var F=Math.ceil(p.width||_.width),M=Math.ceil(p.height||_.height),L=p.pixelRatio,U=p.x===void 0?_.x:p.x,B=p.y===void 0?_.y:p.y,z=p.offset||0,K=p.drawBorder||!1;if(!F||!M){r.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}F+=z*2,M+=z*2,U-=z,B-=z;var ht=new e.SceneCanvas({pixelRatio:L,width:F,height:M}),gt=new e.SceneCanvas({pixelRatio:L,width:0,height:0}),lt=new e.HitCanvas({pixelRatio:1,width:F,height:M}),ct=ht.getContext(),Zt=lt.getContext();return lt.isCache=!0,this._cache.delete("canvas"),this._filterUpToDate=!1,p.imageSmoothingEnabled===!1&&(ht.getContext()._context.imageSmoothingEnabled=!1,gt.getContext()._context.imageSmoothingEnabled=!1),ct.save(),Zt.save(),ct.translate(-U,-B),Zt.translate(-U,-B),this._isUnderCache=!0,this._clearSelfAndDescendantCache(h),this._clearSelfAndDescendantCache(u),this.drawScene(ht,this,!0),this.drawHit(lt,this,!0),this._isUnderCache=!1,ct.restore(),Zt.restore(),K&&(ct.save(),ct.beginPath(),ct.rect(0,0,F,M),ct.closePath(),ct.setAttr("strokeStyle","red"),ct.setAttr("lineWidth",5),ct.stroke(),ct.restore()),this._cache.set(w,{scene:ht,filter:gt,hit:lt,x:U,y:B}),this},S.prototype.isCached=function(){return this._cache.has("canvas")},S.prototype.getClientRect=function(c){throw new Error('abstract "getClientRect" method call')},S.prototype._transformedRect=function(c,p){var _=[{x:c.x,y:c.y},{x:c.x+c.width,y:c.y},{x:c.x+c.width,y:c.y+c.height},{x:c.x,y:c.y+c.height}],F,M,L,U,B=this.getAbsoluteTransform(p);return _.forEach(function(z){var K=B.point(z);F===void 0&&(F=L=K.x,M=U=K.y),F=Math.min(F,K.x),M=Math.min(M,K.y),L=Math.max(L,K.x),U=Math.max(U,K.y)}),{x:F,y:M,width:L-F,height:U-M}},S.prototype._drawCachedSceneCanvas=function(c){c.save(),c._applyOpacity(this),c._applyGlobalCompositeOperation(this);var p=this._getCanvasCache();c.translate(p.x,p.y);var _=this._getCachedSceneCanvas(),F=_.pixelRatio;c.drawImage(_._canvas,0,0,_.width/F,_.height/F),c.restore()},S.prototype._drawCachedHitCanvas=function(c){var p=this._getCanvasCache(),_=p.hit;c.save(),c.translate(p.x,p.y),c.drawImage(_._canvas,0,0),c.restore()},S.prototype._getCachedSceneCanvas=function(){var c=this.filters(),p=this._getCanvasCache(),_=p.scene,F=p.filter,M=F.getContext(),L,U,B,z;if(c){if(!this._filterUpToDate){var K=_.pixelRatio;F.setSize(_.width/_.pixelRatio,_.height/_.pixelRatio);try{for(L=c.length,M.clear(),M.drawImage(_._canvas,0,0,_.getWidth()/K,_.getHeight()/K),U=M.getImageData(0,0,F.getWidth(),F.getHeight()),B=0;B<L;B++){if(z=c[B],typeof z!="function"){r.Util.error("Filter should be type of function, but got "+typeof z+" instead. Please check correct filters");continue}z.call(this,U),M.putImageData(U,0,0)}}catch(ht){r.Util.error("Unable to apply filter. "+ht.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return F}return _},S.prototype.on=function(c,p){if(arguments.length===3)return this._delegate.apply(this,arguments);var _=c.split(m),F=_.length,M,L,U,B,z;for(M=0;M<F;M++)L=_[M],U=L.split("."),B=U[0],z=U[1]||"",this.eventListeners[B]||(this.eventListeners[B]=[]),this.eventListeners[B].push({name:z,handler:p});return this},S.prototype.off=function(c,p){var _=(c||"").split(m),F=_.length,M,L,U,B,z,K;if(!c)for(L in this.eventListeners)this._off(L);for(M=0;M<F;M++)if(U=_[M],B=U.split("."),z=B[0],K=B[1],z)this.eventListeners[z]&&this._off(z,K,p);else for(L in this.eventListeners)this._off(L,K,p);return this},S.prototype.dispatchEvent=function(c){var p={target:this,type:c.type,evt:c};return this.fire(c.type,p),this},S.prototype.addEventListener=function(c,p){return this.on(c,function(_){p.call(this,_.evt)}),this},S.prototype.removeEventListener=function(c){return this.off(c),this},S.prototype._delegate=function(c,p,_){var F=this;this.on(c,function(M){for(var L=M.target.findAncestors(p,!0,F),U=0;U<L.length;U++)M=r.Util.cloneObject(M),M.currentTarget=L[U],_.call(L[U],M)})},S.prototype.remove=function(){return this.isDragging()&&this.stopDrag(),n.DD._dragElements.delete(this._id),this._remove(),this},S.prototype._clearCaches=function(){this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(h),this._clearSelfAndDescendantCache(u),this._clearSelfAndDescendantCache(T),this._clearSelfAndDescendantCache(N),this._clearSelfAndDescendantCache(g)},S.prototype._remove=function(){this._clearCaches();var c=this.getParent();c&&c.children&&(c.children.splice(this.index,1),c._setChildrenIndices(),this.parent=null)},S.prototype.destroy=function(){a._removeId(this.id(),this);for(var c=(this.name()||"").split(/\s/g),p=0;p<c.length;p++){var _=c[p];a._removeName(_,this._id)}return this.remove(),this},S.prototype.getAttr=function(c){var p="get"+r.Util._capitalize(c);return r.Util._isFunction(this[p])?this[p]():this.attrs[c]},S.prototype.getAncestors=function(){for(var c=this.getParent(),p=new r.Collection;c;)p.push(c),c=c.getParent();return p},S.prototype.getAttrs=function(){return this.attrs||{}},S.prototype.setAttrs=function(c){var p,_;if(!c)return this;for(p in c)p!==f&&(_=d+r.Util._capitalize(p),r.Util._isFunction(this[_])?this[_](c[p]):this._setAttr(p,c[p]));return this},S.prototype.isListening=function(){return this._getCache(g,this._isListening)},S.prototype._isListening=function(){var c=this.listening(),p=this.getParent();return c==="inherit"?p?p.isListening():!0:c},S.prototype.isVisible=function(){return this._getCache(N,this._isVisible)},S.prototype._isVisible=function(c){var p=this.visible(),_=this.getParent();return p==="inherit"?_&&_!==c?_._isVisible(c):!0:c&&c!==_?p&&_._isVisible(c):p},S.prototype.shouldDrawHit=function(){var c=this.getLayer();return!c&&this.isListening()&&this.isVisible()||c&&c.hitGraphEnabled()&&this.isListening()&&this.isVisible()},S.prototype.show=function(){return this.visible(!0),this},S.prototype.hide=function(){return this.visible(!1),this},S.prototype.getZIndex=function(){return this.index||0},S.prototype.getAbsoluteZIndex=function(){var c=this.getDepth(),p=this,_=0,F,M,L,U;function B(z){for(F=[],M=z.length,L=0;L<M;L++)U=z[L],_++,U.nodeType!==v&&(F=F.concat(U.getChildren().toArray())),U._id===p._id&&(L=M);F.length>0&&F[0].getDepth()<=c&&B(F)}return p.nodeType!==x&&B(p.getStage().getChildren()),_},S.prototype.getDepth=function(){for(var c=0,p=this.parent;p;)c++,p=p.parent;return c},S.prototype._batchTransformChanges=function(c){this._batchingTransformChange=!0,c(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(E),this._clearSelfAndDescendantCache(l,!0)),this._needClearTransformCache=!1},S.prototype.setPosition=function(c){var p=this;return this._batchTransformChanges(function(){p.x(c.x),p.y(c.y)}),this},S.prototype.getPosition=function(){return{x:this.x(),y:this.y()}},S.prototype.getAbsolutePosition=function(c){for(var p=!1,_=this.parent;_;){if(_.isCached()){p=!0;break}_=_.parent}p&&!c&&(c=!0);var F=this.getAbsoluteTransform(c).getMatrix(),M=new r.Transform,L=this.offset();return M.m=F.slice(),M.translate(L.x,L.y),M.getTranslation()},S.prototype.setAbsolutePosition=function(c){var p=this._clearTransform(),_;return this.attrs.x=p.x,this.attrs.y=p.y,delete p.x,delete p.y,this._clearCache(E),_=this._getAbsoluteTransform(),_.invert(),_.translate(c.x,c.y),c={x:this.attrs.x+_.getTranslation().x,y:this.attrs.y+_.getTranslation().y},this._setTransform(p),this.setPosition({x:c.x,y:c.y}),this},S.prototype._setTransform=function(c){var p;for(p in c)this.attrs[p]=c[p]},S.prototype._clearTransform=function(){var c={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,c},S.prototype.move=function(c){var p=c.x,_=c.y,F=this.x(),M=this.y();return p!==void 0&&(F+=p),_!==void 0&&(M+=_),this.setPosition({x:F,y:M}),this},S.prototype._eachAncestorReverse=function(c,p){var _=[],F=this.getParent(),M,L;if(p&&p._id===this._id){c(this);return}for(_.unshift(this);F&&(!p||F._id!==p._id);)_.unshift(F),F=F.parent;for(M=_.length,L=0;L<M;L++)c(_[L])},S.prototype.rotate=function(c){return this.rotation(this.rotation()+c),this},S.prototype.moveToTop=function(){if(!this.parent)return r.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var c=this.index;return this.parent.children.splice(c,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0},S.prototype.moveUp=function(){if(!this.parent)return r.Util.warn("Node has no parent. moveUp function is ignored."),!1;var c=this.index,p=this.parent.getChildren().length;return c<p-1?(this.parent.children.splice(c,1),this.parent.children.splice(c+1,0,this),this.parent._setChildrenIndices(),!0):!1},S.prototype.moveDown=function(){if(!this.parent)return r.Util.warn("Node has no parent. moveDown function is ignored."),!1;var c=this.index;return c>0?(this.parent.children.splice(c,1),this.parent.children.splice(c-1,0,this),this.parent._setChildrenIndices(),!0):!1},S.prototype.moveToBottom=function(){if(!this.parent)return r.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var c=this.index;return c>0?(this.parent.children.splice(c,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1},S.prototype.setZIndex=function(c){if(!this.parent)return r.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(c<0||c>=this.parent.children.length)&&r.Util.warn("Unexpected value "+c+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var p=this.index;return this.parent.children.splice(p,1),this.parent.children.splice(c,0,this),this.parent._setChildrenIndices(),this},S.prototype.getAbsoluteOpacity=function(){return this._getCache(h,this._getAbsoluteOpacity)},S.prototype._getAbsoluteOpacity=function(){var c=this.opacity(),p=this.getParent();return p&&!p._isUnderCache&&(c*=p.getAbsoluteOpacity()),c},S.prototype.moveTo=function(c){return this.getParent()!==c&&(this._remove(),c.add(this)),this},S.prototype.toObject=function(){var c={},p=this.getAttrs(),_,F,M,L,U;c.attrs={};for(_ in p)F=p[_],U=r.Util.isObject(F)&&!r.Util._isPlainObject(F)&&!r.Util._isArray(F),!U&&(M=typeof this[_]=="function"&&this[_],delete p[_],L=M?M.call(this):null,p[_]=F,L!==F&&(c.attrs[_]=F));return c.className=this.getClassName(),r.Util._prepareToStringify(c)},S.prototype.toJSON=function(){return JSON.stringify(this.toObject())},S.prototype.getParent=function(){return this.parent},S.prototype.findAncestors=function(c,p,_){var F=[];p&&this._isMatch(c)&&F.push(this);for(var M=this.parent;M;){if(M===_)return F;M._isMatch(c)&&F.push(M),M=M.parent}return F},S.prototype.isAncestorOf=function(c){return!1},S.prototype.findAncestor=function(c,p,_){return this.findAncestors(c,p,_)[0]},S.prototype._isMatch=function(c){if(!c)return!1;if(typeof c=="function")return c(this);var p=c.replace(/ /g,"").split(","),_=p.length,F,M;for(F=0;F<_;F++)if(M=p[F],r.Util.isValidSelector(M)||(r.Util.warn('Selector "'+M+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),r.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),r.Util.warn("Konva is awesome, right?")),M.charAt(0)==="#"){if(this.id()===M.slice(1))return!0}else if(M.charAt(0)==="."){if(this.hasName(M.slice(1)))return!0}else if(this.className===M||this.nodeType===M)return!0;return!1},S.prototype.getLayer=function(){var c=this.getParent();return c?c.getLayer():null},S.prototype.getStage=function(){return this._getCache(T,this._getStage)},S.prototype._getStage=function(){var c=this.getParent();if(c)return c.getStage()},S.prototype.fire=function(c,p,_){return p===void 0&&(p={}),p.target=p.target||this,_?this._fireAndBubble(c,p):this._fire(c,p),this},S.prototype.getAbsoluteTransform=function(c){return c?this._getAbsoluteTransform(c):this._getCache(l,this._getAbsoluteTransform)},S.prototype._getAbsoluteTransform=function(c){var p;if(c)return p=new r.Transform,this._eachAncestorReverse(function(F){var M=F.transformsEnabled();M==="all"?p.multiply(F.getTransform()):M==="position"&&p.translate(F.x()-F.offsetX(),F.y()-F.offsetY())},c),p;this.parent?p=this.parent.getAbsoluteTransform().copy():p=new r.Transform;var _=this.transformsEnabled();return _==="all"?p.multiply(this.getTransform()):_==="position"&&p.translate(this.x()-this.offsetX(),this.y()-this.offsetY()),p},S.prototype.getAbsoluteScale=function(c){for(var p=this;p;)p._isUnderCache&&(c=p),p=p.getParent();var _=this.getAbsoluteTransform(c),F=_.decompose();return{x:F.scaleX,y:F.scaleY}},S.prototype.getAbsoluteRotation=function(){return this.getAbsoluteTransform().decompose().rotation},S.prototype.getTransform=function(){return this._getCache(E,this._getTransform)},S.prototype._getTransform=function(){var c=new r.Transform,p=this.x(),_=this.y(),F=i.Konva.getAngle(this.rotation()),M=this.scaleX(),L=this.scaleY(),U=this.skewX(),B=this.skewY(),z=this.offsetX(),K=this.offsetY();return(p!==0||_!==0)&&c.translate(p,_),F!==0&&c.rotate(F),(U!==0||B!==0)&&c.skew(U,B),(M!==1||L!==1)&&c.scale(M,L),(z!==0||K!==0)&&c.translate(-1*z,-1*K),c},S.prototype.clone=function(c){var p=r.Util.cloneObject(this.attrs),_,F,M,L,U;for(_ in c)p[_]=c[_];var B=new this.constructor(p);for(_ in this.eventListeners)for(F=this.eventListeners[_],M=F.length,L=0;L<M;L++)U=F[L],U.name.indexOf(y)<0&&(B.eventListeners[_]||(B.eventListeners[_]=[]),B.eventListeners[_].push(U));return B},S.prototype._toKonvaCanvas=function(c){c=c||{};var p=this.getClientRect(),_=this.getStage(),F=c.x!==void 0?c.x:p.x,M=c.y!==void 0?c.y:p.y,L=c.pixelRatio||1,U=new e.SceneCanvas({width:c.width||p.width||(_?_.width():0),height:c.height||p.height||(_?_.height():0),pixelRatio:L}),B=U.getContext();return B.save(),(F||M)&&B.translate(-1*F,-1*M),this.drawScene(U),B.restore(),U},S.prototype.toCanvas=function(c){return this._toKonvaCanvas(c)._canvas},S.prototype.toDataURL=function(c){c=c||{};var p=c.mimeType||null,_=c.quality||null,F=this._toKonvaCanvas(c).toDataURL(p,_);return c.callback&&c.callback(F),F},S.prototype.toImage=function(c){if(!c||!c.callback)throw"callback required for toImage method config argument";var p=c.callback;delete c.callback,r.Util._urlToImage(this.toDataURL(c),function(_){p(_)})},S.prototype.setSize=function(c){return this.width(c.width),this.height(c.height),this},S.prototype.getSize=function(){return{width:this.width(),height:this.height()}},S.prototype.getClassName=function(){return this.className||this.nodeType},S.prototype.getType=function(){return this.nodeType},S.prototype.getDragDistance=function(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():i.Konva.dragDistance},S.prototype._off=function(c,p,_){var F=this.eventListeners[c],M,L,U;for(M=0;M<F.length;M++)if(L=F[M].name,U=F[M].handler,(L!=="konva"||p==="konva")&&(!p||L===p)&&(!_||_===U)){if(F.splice(M,1),F.length===0){delete this.eventListeners[c];break}M--}},S.prototype._fireChangeEvent=function(c,p,_){this._fire(c+O,{oldVal:p,newVal:_})},S.prototype.setId=function(c){var p=this.id();return a._removeId(p,this),s(this,c),this._setAttr("id",c),this},S.prototype.setName=function(c){var p=(this.name()||"").split(/\s/g),_=(c||"").split(/\s/g),F,M;for(M=0;M<p.length;M++)F=p[M],_.indexOf(F)===-1&&F&&a._removeName(F,this._id);for(M=0;M<_.length;M++)F=_[M],p.indexOf(F)===-1&&F&&a._addName(this,F);return this._setAttr(G,c),this},S.prototype.addName=function(c){if(!this.hasName(c)){var p=this.name(),_=p?p+" "+c:c;this.setName(_)}return this},S.prototype.hasName=function(c){if(!c)return!1;var p=this.name();if(!p)return!1;var _=(p||"").split(/\s/g);return _.indexOf(c)!==-1},S.prototype.removeName=function(c){var p=(this.name()||"").split(/\s/g),_=p.indexOf(c);return _!==-1&&(p.splice(_,1),this.setName(p.join(" "))),this},S.prototype.setAttr=function(c,p){var _=this[d+r.Util._capitalize(c)];return r.Util._isFunction(_)?_.call(this,p):this._setAttr(c,p),this},S.prototype._setAttr=function(c,p){var _=this.attrs[c];_===p&&!r.Util.isObject(p)||(p==null?delete this.attrs[c]:this.attrs[c]=p,this._fireChangeEvent(c,_,p))},S.prototype._setComponentAttr=function(c,p,_){var F;_!==void 0&&(F=this.attrs[c],F||(this.attrs[c]=this.getAttr(c)),this.attrs[c][p]=_,this._fireChangeEvent(c,F,_))},S.prototype._fireAndBubble=function(c,p,_){p&&this.nodeType===v&&(p.target=this);var F=(c===P||c===b)&&(_&&(this===_||this.isAncestorOf&&this.isAncestorOf(_))||this.nodeType==="Stage"&&!_);if(!F){this._fire(c,p);var M=(c===P||c===b)&&_&&_.isAncestorOf&&_.isAncestorOf(this)&&!_.isAncestorOf(this.parent);(p&&!p.cancelBubble||!p)&&this.parent&&this.parent.isListening()&&!M&&(_&&_.parent?this._fireAndBubble.call(this.parent,c,p,_):this._fireAndBubble.call(this.parent,c,p))}},S.prototype._fire=function(c,p){var _=this.eventListeners[c],F;if(_)for(p=p||{},p.currentTarget=this,p.type=c,F=0;F<_.length;F++)_[F].handler.call(this,p)},S.prototype.draw=function(){return this.drawScene(),this.drawHit(),this},S.prototype._createDragElement=function(c){var p=c?c.pointerId:void 0,_=this.getStage(),F=this.getAbsolutePosition(),M=_._getPointerById(p)||_._changedPointerPositions[0]||F;n.DD._dragElements.set(this._id,{node:this,startPointerPos:M,offset:{x:M.x-F.x,y:M.y-F.y},dragStatus:"ready",pointerId:p})},S.prototype.startDrag=function(c){n.DD._dragElements.has(this._id)||this._createDragElement(c);var p=n.DD._dragElements.get(this._id);p.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:c&&c.evt},!0)},S.prototype._setDragPosition=function(c,p){var _=this.getStage()._getPointerById(p.pointerId);if(_){var F={x:_.x-p.offset.x,y:_.y-p.offset.y},M=this.dragBoundFunc();if(M!==void 0){var L=M.call(this,F,c);L?F=L:r.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==F.x||this._lastPos.y!==F.y)&&(this.setAbsolutePosition(F),this.getLayer()?this.getLayer().batchDraw():this.getStage()&&this.getStage().batchDraw()),this._lastPos=F}},S.prototype.stopDrag=function(c){var p=n.DD._dragElements.get(this._id);p&&(p.dragStatus="stopped"),n.DD._endDragBefore(c),n.DD._endDragAfter(c)},S.prototype.setDraggable=function(c){this._setAttr("draggable",c),this._dragChange()},S.prototype.isDragging=function(){var c=n.DD._dragElements.get(this._id);return c?c.dragStatus==="dragging":!1},S.prototype._listenDrag=function(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(c){var p=this,_=c.evt.button!==void 0,F=!_||i.Konva.dragButtons.indexOf(c.evt.button)>=0;if(F&&!this.isDragging()){var M=!1;n.DD._dragElements.forEach(function(L){p.isAncestorOf(L.node)&&(M=!0)}),M||this._createDragElement(c)}})},S.prototype._dragChange=function(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var c=this.getStage();c&&n.DD._dragElements.has(this._id)&&this.stopDrag()}},S.prototype._dragCleanup=function(){this.off("mousedown.konva"),this.off("touchstart.konva")},S.create=function(c,p){return r.Util._isString(c)&&(c=JSON.parse(c)),this._createNode(c,p)},S._createNode=function(c,p){var _=S.prototype.getClassName.call(c),F=c.children,M,L,U;p&&(c.attrs.container=p),i._NODES_REGISTRY[_]||(r.Util.warn('Can not find a node with class name "'+_+'". Fallback to "Shape".'),_="Shape");var B=i._NODES_REGISTRY[_];if(M=new B(c.attrs),F)for(L=F.length,U=0;U<L;U++)M.add(S._createNode(F[U]));return M},S}();a.Node=R,R.prototype.nodeType="Node",R.prototype._attrsAffectingSize=[],t.Factory.addGetterSetter(R,"zIndex"),t.Factory.addGetterSetter(R,"absolutePosition"),t.Factory.addGetterSetter(R,"position"),t.Factory.addGetterSetter(R,"x",0,o.getNumberValidator()),t.Factory.addGetterSetter(R,"y",0,o.getNumberValidator()),t.Factory.addGetterSetter(R,"globalCompositeOperation","source-over",o.getStringValidator()),t.Factory.addGetterSetter(R,"opacity",1,o.getNumberValidator()),t.Factory.addGetterSetter(R,"name","",o.getStringValidator()),t.Factory.addGetterSetter(R,"id","",o.getStringValidator()),t.Factory.addGetterSetter(R,"rotation",0,o.getNumberValidator()),t.Factory.addComponentsGetterSetter(R,"scale",["x","y"]),t.Factory.addGetterSetter(R,"scaleX",1,o.getNumberValidator()),t.Factory.addGetterSetter(R,"scaleY",1,o.getNumberValidator()),t.Factory.addComponentsGetterSetter(R,"skew",["x","y"]),t.Factory.addGetterSetter(R,"skewX",0,o.getNumberValidator()),t.Factory.addGetterSetter(R,"skewY",0,o.getNumberValidator()),t.Factory.addComponentsGetterSetter(R,"offset",["x","y"]),t.Factory.addGetterSetter(R,"offsetX",0,o.getNumberValidator()),t.Factory.addGetterSetter(R,"offsetY",0,o.getNumberValidator()),t.Factory.addGetterSetter(R,"dragDistance",null,o.getNumberValidator()),t.Factory.addGetterSetter(R,"width",0,o.getNumberValidator()),t.Factory.addGetterSetter(R,"height",0,o.getNumberValidator()),t.Factory.addGetterSetter(R,"listening","inherit",function(S){var c=S===!0||S===!1||S==="inherit";return c||r.Util.warn(S+' is a not valid value for "listening" attribute. The value may be true, false or "inherit".'),S}),t.Factory.addGetterSetter(R,"preventDefault",!0,o.getBooleanValidator()),t.Factory.addGetterSetter(R,"filters",null,function(S){return this._filterUpToDate=!1,S}),t.Factory.addGetterSetter(R,"visible","inherit",function(S){var c=S===!0||S===!1||S==="inherit";return c||r.Util.warn(S+' is a not valid value for "visible" attribute. The value may be true, false or "inherit".'),S}),t.Factory.addGetterSetter(R,"transformsEnabled","all",o.getStringValidator()),t.Factory.addGetterSetter(R,"size"),t.Factory.addGetterSetter(R,"dragBoundFunc"),t.Factory.addGetterSetter(R,"draggable",!1,o.getBooleanValidator()),t.Factory.backCompat(R,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),r.Collection.mapMethods(R)})(rt);var Et={},fa=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(Et,"__esModule",{value:!0});var Lt=J,qt=Y,Je=rt,pa=he,Me=W,ga=X,kt=function(a){fa(r,a);function r(){var t=a!==null&&a.apply(this,arguments)||this;return t.children=new Lt.Collection,t}return r.prototype.getChildren=function(t){if(!t)return this.children;var e=new Lt.Collection;return this.children.each(function(i){t(i)&&e.push(i)}),e},r.prototype.hasChildren=function(){return this.getChildren().length>0},r.prototype.removeChildren=function(){for(var t,e=0;e<this.children.length;e++)t=this.children[e],t.parent=null,t.index=0,t.remove();return this.children=new Lt.Collection,this},r.prototype.destroyChildren=function(){for(var t,e=0;e<this.children.length;e++)t=this.children[e],t.parent=null,t.index=0,t.destroy();return this.children=new Lt.Collection,this},r.prototype.add=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}var n=t[0];if(n.getParent())return n.moveTo(this),this;var o=this.children;return this._validateAdd(n),n._clearCaches(),n.index=o.length,n.parent=this,o.push(n),this._fire("add",{child:n}),this},r.prototype.destroy=function(){return this.hasChildren()&&this.destroyChildren(),a.prototype.destroy.call(this),this},r.prototype.find=function(t){return this._generalFind(t,!1)},r.prototype.get=function(t){return Lt.Util.warn("collection.get() method is deprecated. Please use collection.find() instead."),this.find(t)},r.prototype.findOne=function(t){var e=this._generalFind(t,!0);return e.length>0?e[0]:void 0},r.prototype._generalFind=function(t,e){var i=[];return this._descendants(function(n){var o=n._isMatch(t);return o&&i.push(n),!!(o&&e)}),Lt.Collection.toCollection(i)},r.prototype._descendants=function(t){for(var e=!1,i=0;i<this.children.length;i++){var n=this.children[i];if(e=t(n),e)return!0;if(n.hasChildren()&&(e=n._descendants(t),e))return!0}return!1},r.prototype.toObject=function(){var t=Je.Node.prototype.toObject.call(this);t.children=[];for(var e=this.getChildren(),i=e.length,n=0;n<i;n++){var o=e[n];t.children.push(o.toObject())}return t},r.prototype.isAncestorOf=function(t){for(var e=t.getParent();e;){if(e._id===this._id)return!0;e=e.getParent()}return!1},r.prototype.clone=function(t){var e=Je.Node.prototype.clone.call(this,t);return this.getChildren().each(function(i){e.add(i.clone())}),e},r.prototype.getAllIntersections=function(t){var e=[];return this.find("Shape").each(function(i){i.isVisible()&&i.intersects(t)&&e.push(i)}),e},r.prototype._setChildrenIndices=function(){this.children.each(function(t,e){t.index=e})},r.prototype.drawScene=function(t,e,i){var n=this.getLayer(),o=t||n&&n.getCanvas(),s=o&&o.getContext(),h=this._getCanvasCache(),l=h&&h.scene;return(this.isVisible()||i)&&(!i&&l?(s.save(),n._applyTransform(this,s,e),this._drawCachedSceneCanvas(s),s.restore()):this._drawChildren(o,"drawScene",e,!1,i,i)),this},r.prototype.drawHit=function(t,e,i){var n=this.getLayer(),o=t||n&&n.hitCanvas,s=o&&o.getContext(),h=this._getCanvasCache(),l=h&&h.hit;return(this.shouldDrawHit(o)||i)&&(!i&&l?(s.save(),n._applyTransform(this,s,e),this._drawCachedHitCanvas(s),s.restore()):this._drawChildren(o,"drawHit",e,!1,i,i)),this},r.prototype._drawChildren=function(t,e,i,n,o,s){var h=this.getLayer(),l=t&&t.getContext(),u=this.clipWidth(),w=this.clipHeight(),O=this.clipFunc(),f=u&&w||O,y,g;if(f&&h){l.save();var P=this.getAbsoluteTransform(i),b=P.getMatrix();l.transform(b[0],b[1],b[2],b[3],b[4],b[5]),l.beginPath(),O?O.call(this,l,this):(y=this.clipX(),g=this.clipY(),l.rect(y,g,u,w)),l.clip(),b=P.copy().invert().getMatrix(),l.transform(b[0],b[1],b[2],b[3],b[4],b[5])}var G=this.globalCompositeOperation()!=="source-over"&&!s&&e==="drawScene";G&&h&&(l.save(),l._applyGlobalCompositeOperation(this)),this.children.each(function(d){d[e](t,i,n,o)}),G&&h&&l.restore(),f&&h&&l.restore()},r.prototype.shouldDrawHit=function(t){if(t&&t.isCache)return!0;var e=this.getLayer(),i=!1;pa.DD._dragElements.forEach(function(o){o.dragStatus==="dragging"&&o.node.getLayer()===e&&(i=!0)});var n=!ga.Konva.hitOnDragEnabled&&i;return e&&e.hitGraphEnabled()&&this.isVisible()&&!n},r.prototype.getClientRect=function(t){t=t||{};var e=t.skipTransform,i=t.relativeTo,n,o,s,h,l={x:1/0,y:1/0,width:0,height:0},u=this;this.children.each(function(g){if(g.visible()){var P=g.getClientRect({relativeTo:u,skipShadow:t.skipShadow,skipStroke:t.skipStroke});P.width===0&&P.height===0||(n===void 0?(n=P.x,o=P.y,s=P.x+P.width,h=P.y+P.height):(n=Math.min(n,P.x),o=Math.min(o,P.y),s=Math.max(s,P.x+P.width),h=Math.max(h,P.y+P.height)))}});for(var w=this.find("Shape"),O=!1,f=0;f<w.length;f++){var y=w[f];if(y._isVisible(this)){O=!0;break}}return O&&n!==void 0?l={x:n,y:o,width:s-n,height:h-o}:l={x:0,y:0,width:0,height:0},e?l:this._transformedRect(l,i)},r}(Je.Node);Et.Container=kt;qt.Factory.addComponentsGetterSetter(kt,"clip",["x","y","width","height"]);qt.Factory.addGetterSetter(kt,"clipX",void 0,Me.getNumberValidator());qt.Factory.addGetterSetter(kt,"clipY",void 0,Me.getNumberValidator());qt.Factory.addGetterSetter(kt,"clipWidth",void 0,Me.getNumberValidator());qt.Factory.addGetterSetter(kt,"clipHeight",void 0,Me.getNumberValidator());qt.Factory.addGetterSetter(kt,"clipFunc");Lt.Collection.mapMethods(kt);var Vi={},Mt={};Object.defineProperty(Mt,"__esModule",{value:!0});var va=X,oe=new Map,Hi=va.Konva._global.PointerEvent!==void 0;function ya(a){return oe.get(a)}Mt.getCapturedShape=ya;function pr(a){return{evt:a,pointerId:a.pointerId}}Mt.createEvent=pr;function _a(a,r){return oe.get(a)===r}Mt.hasPointerCapture=_a;function ma(a,r){zi(a);var t=r.getStage();t&&(oe.set(a,r),Hi&&r._fire("gotpointercapture",pr(new PointerEvent("gotpointercapture"))))}Mt.setPointerCapture=ma;function zi(a,r){var t=oe.get(a);if(t){var e=t.getStage();e&&e.content,oe.delete(a),Hi&&t._fire("lostpointercapture",pr(new PointerEvent("lostpointercapture")))}}Mt.releaseCapture=zi;(function(a){var r=V&&V.__extends||function(){var st=function(H,C){return st=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,$){I.__proto__=$}||function(I,$){for(var j in $)$.hasOwnProperty(j)&&(I[j]=$[j])},st(H,C)};return function(H,C){st(H,C);function I(){this.constructor=H}H.prototype=C===null?Object.create(C):(I.prototype=C.prototype,new I)}}();Object.defineProperty(a,"__esModule",{value:!0});var t=J,e=Y,i=Et,n=X,o=xt,s=he,h=X,l=Mt,u="Stage",w="string",O="px",f="mouseout",y="mouseleave",g="mouseover",P="mouseenter",b="mousemove",G="mousedown",d="mouseup",v="pointermove",m="pointerdown",T="pointerup",E="pointercancel",x="lostpointercapture",N="contextmenu",k="click",A="dblclick",D="touchstart",R="touchend",S="tap",c="dbltap",p="touchmove",_="wheel",F="contentMouseout",M="contentMouseover",L="contentMousemove",U="contentMousedown",B="contentMouseup",z="contentContextmenu",K="contentClick",ht="contentDblclick",gt="contentTouchstart",lt="contentTouchend",ct="contentDbltap",Zt="contentTap",wn="contentTouchmove",Pn="contentWheel",xn="relative",Tn="konvajs-content",On="_",An="container",Fn=5,En="",ni=[P,G,b,d,f,D,p,R,g,_,N,m,v,T,E,x],kn=ni.length;function Mn(st,H){st.content.addEventListener(H,function(C){st[On+H](C)},!1)}var Gn="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";a.stages=[];function ai(st){return st===void 0&&(st={}),(st.clipFunc||st.clipWidth||st.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),st}var pe=function(st){r(H,st);function H(C){var I=st.call(this,ai(C))||this;return I._pointerPositions=[],I._changedPointerPositions=[],I._buildDOM(),I._bindContentEvents(),a.stages.push(I),I.on("widthChange.konva heightChange.konva",I._resizeDOM),I.on("visibleChange.konva",I._checkVisibility),I.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",function(){ai(I.attrs)}),I._checkVisibility(),I}return H.prototype._validateAdd=function(C){var I=C.getType()==="Layer",$=C.getType()==="FastLayer",j=I||$;j||t.Util.throw("You may only add layers to the stage.")},H.prototype._checkVisibility=function(){if(this.content){var C=this.visible()?"":"none";this.content.style.display=C}},H.prototype.setContainer=function(C){if(typeof C===w){if(C.charAt(0)==="."){var I=C.slice(1);C=document.getElementsByClassName(I)[0]}else{var $;C.charAt(0)!=="#"?$=C:$=C.slice(1),C=document.getElementById($)}if(!C)throw"Can not find container in document with id "+$}return this._setAttr(An,C),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),C.appendChild(this.content)),this},H.prototype.shouldDrawHit=function(){return!0},H.prototype.clear=function(){var C=this.children,I=C.length,$;for($=0;$<I;$++)C[$].clear();return this},H.prototype.clone=function(C){return C||(C={}),C.container=document.createElement("div"),i.Container.prototype.clone.call(this,C)},H.prototype.destroy=function(){st.prototype.destroy.call(this);var C=this.content;C&&t.Util._isInDocument(C)&&this.container().removeChild(C);var I=a.stages.indexOf(this);return I>-1&&a.stages.splice(I,1),this},H.prototype.getPointerPosition=function(){var C=this._pointerPositions[0]||this._changedPointerPositions[0];return C?{x:C.x,y:C.y}:(t.Util.warn(Gn),null)},H.prototype._getPointerById=function(C){return this._pointerPositions.find(function(I){return I.id===C})},H.prototype.getPointersPositions=function(){return this._pointerPositions},H.prototype.getStage=function(){return this},H.prototype.getContent=function(){return this.content},H.prototype._toKonvaCanvas=function(C){C=C||{};var I=C.x||0,$=C.y||0,j=new o.SceneCanvas({width:C.width||this.width(),height:C.height||this.height(),pixelRatio:C.pixelRatio||1}),q=j.getContext()._context,Q=this.children;return(I||$)&&q.translate(-1*I,-1*$),Q.each(function(at){if(at.isVisible()){var mt=at._toKonvaCanvas(C);q.drawImage(mt._canvas,I,$,mt.getWidth()/mt.getPixelRatio(),mt.getHeight()/mt.getPixelRatio())}}),j},H.prototype.getIntersection=function(C,I){if(!C)return null;var $=this.children,j=$.length,q=j-1,Q,at;for(Q=q;Q>=0;Q--)if(at=$[Q].getIntersection(C,I),at)return at;return null},H.prototype._resizeDOM=function(){var C=this.width(),I=this.height();this.content&&(this.content.style.width=C+O,this.content.style.height=I+O),this.bufferCanvas.setSize(C,I),this.bufferHitCanvas.setSize(C,I),this.children.each(function($){$.setSize({width:C,height:I}),$.draw()})},H.prototype.add=function(C){if(arguments.length>1){for(var I=0;I<arguments.length;I++)this.add(arguments[I]);return this}st.prototype.add.call(this,C);var $=this.children.length;return $>Fn&&t.Util.warn("The stage has "+$+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),C.setSize({width:this.width(),height:this.height()}),C.draw(),n.Konva.isBrowser&&this.content.appendChild(C.canvas._canvas),this},H.prototype.getParent=function(){return null},H.prototype.getLayer=function(){return null},H.prototype.hasPointerCapture=function(C){return l.hasPointerCapture(C,this)},H.prototype.setPointerCapture=function(C){l.setPointerCapture(C,this)},H.prototype.releaseCapture=function(C){l.releaseCapture(C,this)},H.prototype.getLayers=function(){return this.getChildren()},H.prototype._bindContentEvents=function(){if(n.Konva.isBrowser)for(var C=0;C<kn;C++)Mn(this,ni[C])},H.prototype._mouseenter=function(C){this.setPointersPositions(C),this._fire(P,{evt:C,target:this,currentTarget:this})},H.prototype._mouseover=function(C){this.setPointersPositions(C),this._fire(M,{evt:C}),this._fire(g,{evt:C,target:this,currentTarget:this})},H.prototype._mouseout=function(C){var I;this.setPointersPositions(C);var $=!((I=this.targetShape)===null||I===void 0)&&I.getStage()?this.targetShape:null,j=!s.DD.isDragging||n.Konva.hitOnDragEnabled;$&&j?($._fireAndBubble(f,{evt:C}),$._fireAndBubble(y,{evt:C}),this._fire(y,{evt:C,target:this,currentTarget:this}),this.targetShape=null):j&&(this._fire(y,{evt:C,target:this,currentTarget:this}),this._fire(f,{evt:C,target:this,currentTarget:this})),this.pointerPos=void 0,this._pointerPositions=[],this._fire(F,{evt:C})},H.prototype._mousemove=function(C){var I;if(n.Konva.UA.ieMobile)return this._touchmove(C);this.setPointersPositions(C);var $=t.Util._getFirstPointerId(C),j,q=!((I=this.targetShape)===null||I===void 0)&&I.getStage()?this.targetShape:null,Q=!s.DD.isDragging||n.Konva.hitOnDragEnabled;if(Q){if(j=this.getIntersection(this.getPointerPosition()),j&&j.isListening()){var at=q!==j;Q&&at?(q&&(q._fireAndBubble(f,{evt:C,pointerId:$},j),q._fireAndBubble(y,{evt:C,pointerId:$},j)),j._fireAndBubble(g,{evt:C,pointerId:$},q),j._fireAndBubble(P,{evt:C,pointerId:$},q),j._fireAndBubble(b,{evt:C,pointerId:$}),this.targetShape=j):j._fireAndBubble(b,{evt:C,pointerId:$})}else q&&Q&&(q._fireAndBubble(f,{evt:C,pointerId:$}),q._fireAndBubble(y,{evt:C,pointerId:$}),this._fire(g,{evt:C,target:this,currentTarget:this,pointerId:$}),this.targetShape=null),this._fire(b,{evt:C,target:this,currentTarget:this,pointerId:$});this._fire(L,{evt:C})}C.cancelable&&C.preventDefault()},H.prototype._mousedown=function(C){if(n.Konva.UA.ieMobile)return this._touchstart(C);this.setPointersPositions(C);var I=t.Util._getFirstPointerId(C),$=this.getIntersection(this.getPointerPosition());s.DD.justDragged=!1,n.Konva.listenClickTap=!0,$&&$.isListening()?(this.clickStartShape=$,$._fireAndBubble(G,{evt:C,pointerId:I})):this._fire(G,{evt:C,target:this,currentTarget:this,pointerId:I}),this._fire(U,{evt:C})},H.prototype._mouseup=function(C){if(n.Konva.UA.ieMobile)return this._touchend(C);this.setPointersPositions(C);var I=t.Util._getFirstPointerId(C),$=this.getIntersection(this.getPointerPosition()),j=this.clickStartShape,q=this.clickEndShape,Q=!1;n.Konva.inDblClickWindow?(Q=!0,clearTimeout(this.dblTimeout)):s.DD.justDragged||(n.Konva.inDblClickWindow=!0,clearTimeout(this.dblTimeout)),this.dblTimeout=setTimeout(function(){n.Konva.inDblClickWindow=!1},n.Konva.dblClickWindow),$&&$.isListening()?(this.clickEndShape=$,$._fireAndBubble(d,{evt:C,pointerId:I}),n.Konva.listenClickTap&&j&&j._id===$._id&&($._fireAndBubble(k,{evt:C,pointerId:I}),Q&&q&&q===$&&$._fireAndBubble(A,{evt:C,pointerId:I}))):(this._fire(d,{evt:C,target:this,currentTarget:this,pointerId:I}),n.Konva.listenClickTap&&this._fire(k,{evt:C,target:this,currentTarget:this,pointerId:I}),Q&&this._fire(A,{evt:C,target:this,currentTarget:this,pointerId:I})),this._fire(B,{evt:C}),n.Konva.listenClickTap&&(this._fire(K,{evt:C}),Q&&this._fire(ht,{evt:C})),n.Konva.listenClickTap=!1,C.cancelable&&C.preventDefault()},H.prototype._contextmenu=function(C){this.setPointersPositions(C);var I=this.getIntersection(this.getPointerPosition());I&&I.isListening()?I._fireAndBubble(N,{evt:C}):this._fire(N,{evt:C,target:this,currentTarget:this}),this._fire(z,{evt:C})},H.prototype._touchstart=function(C){var I=this;this.setPointersPositions(C);var $=!1;this._changedPointerPositions.forEach(function(j){var q=I.getIntersection(j);n.Konva.listenClickTap=!0,s.DD.justDragged=!1;var Q=q&&q.isListening();Q&&(n.Konva.captureTouchEventsEnabled&&q.setPointerCapture(j.id),I.tapStartShape=q,q._fireAndBubble(D,{evt:C,pointerId:j.id},I),$=!0,q.isListening()&&q.preventDefault()&&C.cancelable&&C.preventDefault())}),$||this._fire(D,{evt:C,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),this._fire(gt,{evt:C})},H.prototype._touchmove=function(C){var I=this;this.setPointersPositions(C);var $=!s.DD.isDragging||n.Konva.hitOnDragEnabled;if($){var j=!1,q={};this._changedPointerPositions.forEach(function(Q){var at=l.getCapturedShape(Q.id)||I.getIntersection(Q),mt=at&&at.isListening();mt&&(q[at._id]||(q[at._id]=!0,at._fireAndBubble(p,{evt:C,pointerId:Q.id}),j=!0,at.isListening()&&at.preventDefault()&&C.cancelable&&C.preventDefault()))}),j||this._fire(p,{evt:C,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),this._fire(wn,{evt:C})}s.DD.isDragging&&s.DD.node.preventDefault()&&C.cancelable&&C.preventDefault()},H.prototype._touchend=function(C){var I=this;this.setPointersPositions(C);var $=this.clickEndShape,j=!1;n.Konva.inDblClickWindow?(j=!0,clearTimeout(this.dblTimeout)):s.DD.justDragged||(n.Konva.inDblClickWindow=!0,clearTimeout(this.dblTimeout)),this.dblTimeout=setTimeout(function(){n.Konva.inDblClickWindow=!1},n.Konva.dblClickWindow);var q=!1,Q={},at=!1,mt=!1;this._changedPointerPositions.forEach(function(zt){var pt=l.getCapturedShape(zt.id)||I.getIntersection(zt);pt&&pt.releaseCapture(zt.id);var Nn=pt&&pt.isListening();Nn&&(Q[pt._id]||(Q[pt._id]=!0,I.clickEndShape=pt,pt._fireAndBubble(R,{evt:C,pointerId:zt.id}),q=!0,n.Konva.listenClickTap&&pt===I.tapStartShape&&(at=!0,pt._fireAndBubble(S,{evt:C,pointerId:zt.id}),j&&$&&$===pt&&(mt=!0,pt._fireAndBubble(c,{evt:C,pointerId:zt.id}))),pt.isListening()&&pt.preventDefault()&&C.cancelable&&C.preventDefault()))}),q||this._fire(R,{evt:C,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),n.Konva.listenClickTap&&!at&&this._fire(S,{evt:C,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),j&&!mt&&this._fire(c,{evt:C,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),this._fire(lt,{evt:C}),n.Konva.listenClickTap&&(this._fire(Zt,{evt:C}),j&&this._fire(ct,{evt:C})),n.Konva.listenClickTap=!1},H.prototype._wheel=function(C){this.setPointersPositions(C);var I=this.getIntersection(this.getPointerPosition());I&&I.isListening()?I._fireAndBubble(_,{evt:C}):this._fire(_,{evt:C,target:this,currentTarget:this}),this._fire(Pn,{evt:C})},H.prototype._pointerdown=function(C){if(n.Konva._pointerEventsEnabled){this.setPointersPositions(C);var I=l.getCapturedShape(C.pointerId)||this.getIntersection(this.getPointerPosition());I&&I._fireAndBubble(m,l.createEvent(C))}},H.prototype._pointermove=function(C){if(n.Konva._pointerEventsEnabled){this.setPointersPositions(C);var I=l.getCapturedShape(C.pointerId)||this.getIntersection(this.getPointerPosition());I&&I._fireAndBubble(v,l.createEvent(C))}},H.prototype._pointerup=function(C){if(n.Konva._pointerEventsEnabled){this.setPointersPositions(C);var I=l.getCapturedShape(C.pointerId)||this.getIntersection(this.getPointerPosition());I&&I._fireAndBubble(T,l.createEvent(C)),l.releaseCapture(C.pointerId)}},H.prototype._pointercancel=function(C){if(n.Konva._pointerEventsEnabled){this.setPointersPositions(C);var I=l.getCapturedShape(C.pointerId)||this.getIntersection(this.getPointerPosition());I&&I._fireAndBubble(T,l.createEvent(C)),l.releaseCapture(C.pointerId)}},H.prototype._lostpointercapture=function(C){l.releaseCapture(C.pointerId)},H.prototype.setPointersPositions=function(C){var I=this,$=this._getContentPosition(),j=null,q=null;C=C||window.event,C.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],t.Collection.prototype.each.call(C.touches,function(Q){I._pointerPositions.push({id:Q.identifier,x:(Q.clientX-$.left)/$.scaleX,y:(Q.clientY-$.top)/$.scaleY})}),t.Collection.prototype.each.call(C.changedTouches||C.touches,function(Q){I._changedPointerPositions.push({id:Q.identifier,x:(Q.clientX-$.left)/$.scaleX,y:(Q.clientY-$.top)/$.scaleY})})):(j=(C.clientX-$.left)/$.scaleX,q=(C.clientY-$.top)/$.scaleY,this.pointerPos={x:j,y:q},this._pointerPositions=[{x:j,y:q,id:t.Util._getFirstPointerId(C)}],this._changedPointerPositions=[{x:j,y:q,id:t.Util._getFirstPointerId(C)}])},H.prototype._setPointerPosition=function(C){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(C)},H.prototype._getContentPosition=function(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var C=this.content.getBoundingClientRect();return{top:C.top,left:C.left,scaleX:C.width/this.content.clientWidth||1,scaleY:C.height/this.content.clientHeight||1}},H.prototype._buildDOM=function(){if(this.bufferCanvas=new o.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new o.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!!n.Konva.isBrowser){var C=this.container();if(!C)throw"Stage has no container. A container is required.";C.innerHTML=En,this.content=document.createElement("div"),this.content.style.position=xn,this.content.style.userSelect="none",this.content.className=Tn,this.content.setAttribute("role","presentation"),C.appendChild(this.content),this._resizeDOM()}},H.prototype.cache=function(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this},H.prototype.clearCache=function(){return this},H.prototype.batchDraw=function(){return this.children.each(function(C){C.batchDraw()}),this},H}(i.Container);a.Stage=pe,pe.prototype.nodeType=u,h._registerNode(pe),e.Factory.addGetterSetter(pe,"container")})(Vi);var gr={},Ge={},Sa=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(Ge,"__esModule",{value:!0});var ie=J,ba=Et,Wt=rt,Wi=Y,Ca=xt,le=function(a){Sa(r,a);function r(t){var e=a.call(this,t)||this;return e.canvas=new Ca.SceneCanvas,e._waitingForDraw=!1,e.on("visibleChange",e._checkVisibility),e._checkVisibility(),e.on("imageSmoothingEnabledChange",e._setSmoothEnabled),e._setSmoothEnabled(),e}return r.prototype.createPNGStream=function(){var t=this.canvas._canvas;return t.createPNGStream()},r.prototype.getCanvas=function(){return this.canvas},r.prototype.getHitCanvas=function(){return this.hitCanvas},r.prototype.getContext=function(){return this.getCanvas().getContext()},r.prototype.clear=function(t){return this.getContext().clear(t),this},r.prototype.setZIndex=function(t){a.prototype.setZIndex.call(this,t);var e=this.getStage();return e&&(e.content.removeChild(this.getCanvas()._canvas),t<e.children.length-1?e.content.insertBefore(this.getCanvas()._canvas,e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getCanvas()._canvas)),this},r.prototype.moveToTop=function(){Wt.Node.prototype.moveToTop.call(this);var t=this.getStage();return t&&(t.content.removeChild(this.getCanvas()._canvas),t.content.appendChild(this.getCanvas()._canvas)),!0},r.prototype.moveUp=function(){var t=Wt.Node.prototype.moveUp.call(this);if(!t)return!1;var e=this.getStage();return e?(e.content.removeChild(this.getCanvas()._canvas),this.index<e.children.length-1?e.content.insertBefore(this.getCanvas()._canvas,e.children[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getCanvas()._canvas),!0):!1},r.prototype.moveDown=function(){if(Wt.Node.prototype.moveDown.call(this)){var t=this.getStage();if(t){var e=t.children;t.content.removeChild(this.getCanvas()._canvas),t.content.insertBefore(this.getCanvas()._canvas,e[this.index+1].getCanvas()._canvas)}return!0}return!1},r.prototype.moveToBottom=function(){if(Wt.Node.prototype.moveToBottom.call(this)){var t=this.getStage();if(t){var e=t.children;t.content.removeChild(this.getCanvas()._canvas),t.content.insertBefore(this.getCanvas()._canvas,e[1].getCanvas()._canvas)}return!0}return!1},r.prototype.getLayer=function(){return this},r.prototype.hitGraphEnabled=function(){return!0},r.prototype.remove=function(){var t=this.getCanvas()._canvas;return Wt.Node.prototype.remove.call(this),t&&t.parentNode&&ie.Util._isInDocument(t)&&t.parentNode.removeChild(t),this},r.prototype.getStage=function(){return this.parent},r.prototype.setSize=function(t){var e=t.width,i=t.height;return this.canvas.setSize(e,i),this._setSmoothEnabled(),this},r.prototype._toKonvaCanvas=function(t){return t=t||{},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),Wt.Node.prototype._toKonvaCanvas.call(this,t)},r.prototype._checkVisibility=function(){var t=this.visible();t?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"},r.prototype._setSmoothEnabled=function(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()},r.prototype.getWidth=function(){if(this.parent)return this.parent.width()},r.prototype.setWidth=function(){ie.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')},r.prototype.getHeight=function(){if(this.parent)return this.parent.height()},r.prototype.setHeight=function(){ie.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')},r.prototype.getIntersection=function(t,e){return null},r.prototype.batchDraw=function(){var t=this;return this._waitingForDraw||(this._waitingForDraw=!0,ie.Util.requestAnimFrame(function(){t.draw(),t._waitingForDraw=!1})),this},r.prototype._applyTransform=function(t,e,i){var n=t.getAbsoluteTransform(i).getMatrix();e.transform(n[0],n[1],n[2],n[3],n[4],n[5])},r}(ba.Container);Ge.BaseLayer=le;le.prototype.nodeType="BaseLayer";Wi.Factory.addGetterSetter(le,"imageSmoothingEnabled",!0);Wi.Factory.addGetterSetter(le,"clearBeforeDraw",!0);ie.Collection.mapMethods(le);var ot={};(function(a){var r=V&&V.__extends||function(){var N=function(k,A){return N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(D,R){D.__proto__=R}||function(D,R){for(var S in R)R.hasOwnProperty(S)&&(D[S]=R[S])},N(k,A)};return function(k,A){N(k,A);function D(){this.constructor=k}k.prototype=A===null?Object.create(A):(D.prototype=A.prototype,new D)}}();Object.defineProperty(a,"__esModule",{value:!0});var t=J,e=Y,i=rt,n=W,o=X,s=Mt,h="hasShadow",l="shadowRGBA",u="patternImage",w="linearGradient",O="radialGradient",f;function y(){return f||(f=t.Util.createCanvasElement().getContext("2d"),f)}a.shapes={};function g(N){N.fill()}function P(N){N.stroke()}function b(N){N.fill()}function G(N){N.stroke()}function d(){this._clearCache(h)}function v(){this._clearCache(l)}function m(){this._clearCache(u)}function T(){this._clearCache(w)}function E(){this._clearCache(O)}var x=function(N){r(k,N);function k(A){for(var D=N.call(this,A)||this,R;R=t.Util.getRandomColor(),!(R&&!(R in a.shapes)););return D.colorKey=R,a.shapes[R]=D,D.on("shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",d),D.on("shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",v),D.on("fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva",m),D.on("fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",T),D.on("fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",E),D}return k.prototype.getContext=function(){return this.getLayer().getContext()},k.prototype.getCanvas=function(){return this.getLayer().getCanvas()},k.prototype.getSceneFunc=function(){return this.attrs.sceneFunc||this._sceneFunc},k.prototype.getHitFunc=function(){return this.attrs.hitFunc||this._hitFunc},k.prototype.hasShadow=function(){return this._getCache(h,this._hasShadow)},k.prototype._hasShadow=function(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())},k.prototype._getFillPattern=function(){return this._getCache(u,this.__getFillPattern)},k.prototype.__getFillPattern=function(){if(this.fillPatternImage()){var A=y(),D=A.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");return D}},k.prototype._getLinearGradient=function(){return this._getCache(w,this.__getLinearGradient)},k.prototype.__getLinearGradient=function(){var A=this.fillLinearGradientColorStops();if(A){for(var D=y(),R=this.fillLinearGradientStartPoint(),S=this.fillLinearGradientEndPoint(),c=D.createLinearGradient(R.x,R.y,S.x,S.y),p=0;p<A.length;p+=2)c.addColorStop(A[p],A[p+1]);return c}},k.prototype._getRadialGradient=function(){return this._getCache(O,this.__getRadialGradient)},k.prototype.__getRadialGradient=function(){var A=this.fillRadialGradientColorStops();if(A){for(var D=y(),R=this.fillRadialGradientStartPoint(),S=this.fillRadialGradientEndPoint(),c=D.createRadialGradient(R.x,R.y,this.fillRadialGradientStartRadius(),S.x,S.y,this.fillRadialGradientEndRadius()),p=0;p<A.length;p+=2)c.addColorStop(A[p],A[p+1]);return c}},k.prototype.getShadowRGBA=function(){return this._getCache(l,this._getShadowRGBA)},k.prototype._getShadowRGBA=function(){if(this.hasShadow()){var A=t.Util.colorToRGBA(this.shadowColor());return"rgba("+A.r+","+A.g+","+A.b+","+A.a*(this.shadowOpacity()||1)+")"}},k.prototype.hasFill=function(){return this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops())},k.prototype.hasStroke=function(){return this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops())},k.prototype.hasHitStroke=function(){var A=this.hitStrokeWidth();return A==="auto"?this.hasStroke():this.strokeEnabled()&&!!A},k.prototype.intersects=function(A){var D=this.getStage(),R=D.bufferHitCanvas,S;return R.getContext().clear(),this.drawHit(R),S=R.context.getImageData(Math.round(A.x),Math.round(A.y),1,1).data,S[3]>0},k.prototype.destroy=function(){return i.Node.prototype.destroy.call(this),delete a.shapes[this.colorKey],delete this.colorKey,this},k.prototype._useBufferCanvas=function(A){return!!((!A||this.hasShadow())&&this.perfectDrawEnabled()&&this.getAbsoluteOpacity()!==1&&this.hasFill()&&this.hasStroke()&&this.getStage())},k.prototype.setStrokeHitEnabled=function(A){t.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),A?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)},k.prototype.getStrokeHitEnabled=function(){return this.hitStrokeWidth()!==0},k.prototype.getSelfRect=function(){var A=this.size();return{x:this._centroid?-A.width/2:0,y:this._centroid?-A.height/2:0,width:A.width,height:A.height}},k.prototype.getClientRect=function(A){A=A||{};var D=A.skipTransform,R=A.relativeTo,S=this.getSelfRect(),c=!A.skipStroke&&this.hasStroke(),p=c&&this.strokeWidth()||0,_=S.width+p,F=S.height+p,M=!A.skipShadow&&this.hasShadow(),L=M?this.shadowOffsetX():0,U=M?this.shadowOffsetY():0,B=_+Math.abs(L),z=F+Math.abs(U),K=M&&this.shadowBlur()||0,ht=B+K*2,gt=z+K*2,lt=0;Math.round(p/2)!==p/2&&(lt=1);var ct={width:ht+lt,height:gt+lt,x:-Math.round(p/2+K)+Math.min(L,0)+S.x,y:-Math.round(p/2+K)+Math.min(U,0)+S.y};return D?ct:this._transformedRect(ct,R)},k.prototype.drawScene=function(A,D,R,S){var c=this.getLayer(),p=A||c.getCanvas(),_=p.getContext(),F=this._getCanvasCache(),M=this.sceneFunc(),L=this.hasShadow(),U=this.hasStroke(),B,z,K;if(!this.isVisible()&&!R)return this;if(F)return _.save(),c._applyTransform(this,_,D),this._drawCachedSceneCanvas(_),_.restore(),this;if(!M)return this;if(_.save(),this._useBufferCanvas(R)&&!S){if(B=this.getStage(),z=B.bufferCanvas,K=z.getContext(),K.clear(),K.save(),K._applyLineJoin(this),!R)if(c)c._applyTransform(this,K,D);else{var ht=this.getAbsoluteTransform(D).getMatrix();_.transform(ht[0],ht[1],ht[2],ht[3],ht[4],ht[5])}M.call(this,K,this),K.restore();var gt=z.pixelRatio;L&&!p.hitCanvas?(_.save(),_._applyShadow(this),_._applyOpacity(this),_._applyGlobalCompositeOperation(this),_.drawImage(z._canvas,0,0,z.width/gt,z.height/gt),_.restore()):(_._applyOpacity(this),_._applyGlobalCompositeOperation(this),_.drawImage(z._canvas,0,0,z.width/gt,z.height/gt))}else{if(_._applyLineJoin(this),!R)if(c)c._applyTransform(this,_,D);else{var lt=this.getAbsoluteTransform(D).getMatrix();_.transform(lt[0],lt[1],lt[2],lt[3],lt[4],lt[5])}L&&U&&!p.hitCanvas?(_.save(),R||(_._applyOpacity(this),_._applyGlobalCompositeOperation(this)),_._applyShadow(this),M.call(this,_,this),_.restore(),this.hasFill()&&this.shadowForStrokeEnabled()&&M.call(this,_,this)):L&&!p.hitCanvas?(_.save(),R||(_._applyOpacity(this),_._applyGlobalCompositeOperation(this)),_._applyShadow(this),M.call(this,_,this),_.restore()):(R||(_._applyOpacity(this),_._applyGlobalCompositeOperation(this)),M.call(this,_,this))}return _.restore(),this},k.prototype.drawHit=function(A,D,R){var S=this.getLayer(),c=A||S.hitCanvas,p=c&&c.getContext(),_=this.hitFunc()||this.sceneFunc(),F=this._getCanvasCache(),M=F&&F.hit;if(this.colorKey||(console.log(this),t.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. See the shape in logs above. If you want to reuse shape you should call remove() instead of destroy()")),!this.shouldDrawHit()&&!R)return this;if(M)return p.save(),S._applyTransform(this,p,D),this._drawCachedHitCanvas(p),p.restore(),this;if(!_)return this;if(p.save(),p._applyLineJoin(this),!R)if(S)S._applyTransform(this,p,D);else{var L=this.getAbsoluteTransform(D).getMatrix();p.transform(L[0],L[1],L[2],L[3],L[4],L[5])}return _.call(this,p,this),p.restore(),this},k.prototype.drawHitFromCache=function(A){A===void 0&&(A=0);var D=this._getCanvasCache(),R=this._getCachedSceneCanvas(),S=D.hit,c=S.getContext(),p=S.getWidth(),_=S.getHeight(),F,M,L,U,B,z;c.clear(),c.drawImage(R._canvas,0,0,p,_);try{for(F=c.getImageData(0,0,p,_),M=F.data,L=M.length,U=t.Util._hexToRgb(this.colorKey),B=0;B<L;B+=4)z=M[B+3],z>A?(M[B]=U.r,M[B+1]=U.g,M[B+2]=U.b,M[B+3]=255):M[B+3]=0;c.putImageData(F,0,0)}catch(K){t.Util.error("Unable to draw hit graph from cached scene canvas. "+K.message)}return this},k.prototype.hasPointerCapture=function(A){return s.hasPointerCapture(A,this)},k.prototype.setPointerCapture=function(A){s.setPointerCapture(A,this)},k.prototype.releaseCapture=function(A){s.releaseCapture(A,this)},k}(i.Node);a.Shape=x,x.prototype._fillFunc=g,x.prototype._strokeFunc=P,x.prototype._fillFuncHit=b,x.prototype._strokeFuncHit=G,x.prototype._centroid=!1,x.prototype.nodeType="Shape",o._registerNode(x),e.Factory.addGetterSetter(x,"stroke",void 0,n.getStringValidator()),e.Factory.addGetterSetter(x,"strokeWidth",2,n.getNumberValidator()),e.Factory.addGetterSetter(x,"hitStrokeWidth","auto",n.getNumberOrAutoValidator()),e.Factory.addGetterSetter(x,"strokeHitEnabled",!0,n.getBooleanValidator()),e.Factory.addGetterSetter(x,"perfectDrawEnabled",!0,n.getBooleanValidator()),e.Factory.addGetterSetter(x,"shadowForStrokeEnabled",!0,n.getBooleanValidator()),e.Factory.addGetterSetter(x,"lineJoin"),e.Factory.addGetterSetter(x,"lineCap"),e.Factory.addGetterSetter(x,"sceneFunc"),e.Factory.addGetterSetter(x,"hitFunc"),e.Factory.addGetterSetter(x,"dash"),e.Factory.addGetterSetter(x,"dashOffset",0,n.getNumberValidator()),e.Factory.addGetterSetter(x,"shadowColor",void 0,n.getStringValidator()),e.Factory.addGetterSetter(x,"shadowBlur",0,n.getNumberValidator()),e.Factory.addGetterSetter(x,"shadowOpacity",1,n.getNumberValidator()),e.Factory.addComponentsGetterSetter(x,"shadowOffset",["x","y"]),e.Factory.addGetterSetter(x,"shadowOffsetX",0,n.getNumberValidator()),e.Factory.addGetterSetter(x,"shadowOffsetY",0,n.getNumberValidator()),e.Factory.addGetterSetter(x,"fillPatternImage"),e.Factory.addGetterSetter(x,"fill",void 0,n.getStringValidator()),e.Factory.addGetterSetter(x,"fillPatternX",0,n.getNumberValidator()),e.Factory.addGetterSetter(x,"fillPatternY",0,n.getNumberValidator()),e.Factory.addGetterSetter(x,"fillLinearGradientColorStops"),e.Factory.addGetterSetter(x,"strokeLinearGradientColorStops"),e.Factory.addGetterSetter(x,"fillRadialGradientStartRadius",0),e.Factory.addGetterSetter(x,"fillRadialGradientEndRadius",0),e.Factory.addGetterSetter(x,"fillRadialGradientColorStops"),e.Factory.addGetterSetter(x,"fillPatternRepeat","repeat"),e.Factory.addGetterSetter(x,"fillEnabled",!0),e.Factory.addGetterSetter(x,"strokeEnabled",!0),e.Factory.addGetterSetter(x,"shadowEnabled",!0),e.Factory.addGetterSetter(x,"dashEnabled",!0),e.Factory.addGetterSetter(x,"strokeScaleEnabled",!0),e.Factory.addGetterSetter(x,"fillPriority","color"),e.Factory.addComponentsGetterSetter(x,"fillPatternOffset",["x","y"]),e.Factory.addGetterSetter(x,"fillPatternOffsetX",0,n.getNumberValidator()),e.Factory.addGetterSetter(x,"fillPatternOffsetY",0,n.getNumberValidator()),e.Factory.addComponentsGetterSetter(x,"fillPatternScale",["x","y"]),e.Factory.addGetterSetter(x,"fillPatternScaleX",1,n.getNumberValidator()),e.Factory.addGetterSetter(x,"fillPatternScaleY",1,n.getNumberValidator()),e.Factory.addComponentsGetterSetter(x,"fillLinearGradientStartPoint",["x","y"]),e.Factory.addComponentsGetterSetter(x,"strokeLinearGradientStartPoint",["x","y"]),e.Factory.addGetterSetter(x,"fillLinearGradientStartPointX",0),e.Factory.addGetterSetter(x,"strokeLinearGradientStartPointX",0),e.Factory.addGetterSetter(x,"fillLinearGradientStartPointY",0),e.Factory.addGetterSetter(x,"strokeLinearGradientStartPointY",0),e.Factory.addComponentsGetterSetter(x,"fillLinearGradientEndPoint",["x","y"]),e.Factory.addComponentsGetterSetter(x,"strokeLinearGradientEndPoint",["x","y"]),e.Factory.addGetterSetter(x,"fillLinearGradientEndPointX",0),e.Factory.addGetterSetter(x,"strokeLinearGradientEndPointX",0),e.Factory.addGetterSetter(x,"fillLinearGradientEndPointY",0),e.Factory.addGetterSetter(x,"strokeLinearGradientEndPointY",0),e.Factory.addComponentsGetterSetter(x,"fillRadialGradientStartPoint",["x","y"]),e.Factory.addGetterSetter(x,"fillRadialGradientStartPointX",0),e.Factory.addGetterSetter(x,"fillRadialGradientStartPointY",0),e.Factory.addComponentsGetterSetter(x,"fillRadialGradientEndPoint",["x","y"]),e.Factory.addGetterSetter(x,"fillRadialGradientEndPointX",0),e.Factory.addGetterSetter(x,"fillRadialGradientEndPointY",0),e.Factory.addGetterSetter(x,"fillPatternRotation",0),e.Factory.backCompat(x,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"}),t.Collection.mapMethods(x)})(ot);var wa=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(gr,"__esModule",{value:!0});var sr=J,hi=Et,Pa=Y,li=Ge,xa=xt,Ta=ot,Oa=W,Aa=X,Fa="#",Ea="beforeDraw",ka="draw",ji=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],Ma=ji.length,de=function(a){wa(r,a);function r(){var t=a!==null&&a.apply(this,arguments)||this;return t.hitCanvas=new xa.HitCanvas({pixelRatio:1}),t}return r.prototype.setSize=function(t){var e=t.width,i=t.height;return a.prototype.setSize.call(this,{width:e,height:i}),this.hitCanvas.setSize(e,i),this},r.prototype._validateAdd=function(t){var e=t.getType();e!=="Group"&&e!=="Shape"&&sr.Util.throw("You may only add groups and shapes to a layer.")},r.prototype.getIntersection=function(t,e){var i,n,o,s;if(!this.hitGraphEnabled()||!this.isVisible())return null;for(var h=1,l=!1;;){for(n=0;n<Ma;n++){if(o=ji[n],i=this._getIntersection({x:t.x+o.x*h,y:t.y+o.y*h}),s=i.shape,s&&e)return s.findAncestor(e,!0);if(s)return s;if(l=!!i.antialiased,!i.antialiased)break}if(l)h+=1;else return null}},r.prototype._getIntersection=function(t){var e=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,n=i[3],o,s;return n===255?(o=sr.Util._rgbToHex(i[0],i[1],i[2]),s=Ta.shapes[Fa+o],s?{shape:s}:{antialiased:!0}):n>0?{antialiased:!0}:{}},r.prototype.drawScene=function(t,e){var i=this.getLayer(),n=t||i&&i.getCanvas();return this._fire(Ea,{node:this}),this.clearBeforeDraw()&&n.getContext().clear(),hi.Container.prototype.drawScene.call(this,n,e),this._fire(ka,{node:this}),this},r.prototype.drawHit=function(t,e){var i=this.getLayer(),n=t||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),hi.Container.prototype.drawHit.call(this,n,e),this},r.prototype.clear=function(t){return li.BaseLayer.prototype.clear.call(this,t),this.getHitCanvas().getContext().clear(t),this},r.prototype.enableHitGraph=function(){return this.hitGraphEnabled(!0),this},r.prototype.disableHitGraph=function(){return this.hitGraphEnabled(!1),this},r.prototype.toggleHitCanvas=function(){if(this.parent){var t=this.parent,e=!!this.hitCanvas._canvas.parentNode;e?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}},r}(li.BaseLayer);gr.Layer=de;de.prototype.nodeType="Layer";Aa._registerNode(de);Pa.Factory.addGetterSetter(de,"hitGraphEnabled",!0,Oa.getBooleanValidator());sr.Collection.mapMethods(de);var vr={},Ga=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(vr,"__esModule",{value:!0});var Ki=J,Na=Et,Ra=Ge,La=X,Ne=function(a){Ga(r,a);function r(){return a!==null&&a.apply(this,arguments)||this}return r.prototype._validateAdd=function(t){var e=t.getType();e!=="Shape"&&Ki.Util.throw("You may only add shapes to a fast layer.")},r.prototype.hitGraphEnabled=function(){return!1},r.prototype.drawScene=function(t){var e=this.getLayer(),i=t||e&&e.getCanvas();return this.clearBeforeDraw()&&i.getContext().clear(),Na.Container.prototype.drawScene.call(this,i),this},r.prototype.draw=function(){return this.drawScene(),this},r}(Ra.BaseLayer);vr.FastLayer=Ne;Ne.prototype.nodeType="FastLayer";La._registerNode(Ne);Ki.Collection.mapMethods(Ne);var ce={},Da=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(ce,"__esModule",{value:!0});var Yi=J,Ia=Et,Ua=X,Re=function(a){Da(r,a);function r(){return a!==null&&a.apply(this,arguments)||this}return r.prototype._validateAdd=function(t){var e=t.getType();e!=="Group"&&e!=="Shape"&&Yi.Util.throw("You may only add groups and shapes to groups.")},r}(Ia.Container);ce.Group=Re;Re.prototype.nodeType="Group";Ua._registerNode(Re);Yi.Collection.mapMethods(Re);var ue={};Object.defineProperty(ue,"__esModule",{value:!0});var Qe=X,Ze=function(){return Qe.glob.performance&&Qe.glob.performance.now?function(){return Qe.glob.performance.now()}:function(){return new Date().getTime()}}(),$a=function(){function a(r,t){this.id=a.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Ze(),frameRate:0},this.func=r,this.setLayers(t)}return a.prototype.setLayers=function(r){var t=[];return r?r.length>0?t=r:t=[r]:t=[],this.layers=t,this},a.prototype.getLayers=function(){return this.layers},a.prototype.addLayer=function(r){var t=this.layers,e=t.length,i;for(i=0;i<e;i++)if(t[i]._id===r._id)return!1;return this.layers.push(r),!0},a.prototype.isRunning=function(){var r=a,t=r.animations,e=t.length,i;for(i=0;i<e;i++)if(t[i].id===this.id)return!0;return!1},a.prototype.start=function(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Ze(),a._addAnimation(this),this},a.prototype.stop=function(){return a._removeAnimation(this),this},a.prototype._updateFrameObject=function(r){this.frame.timeDiff=r-this.frame.lastTime,this.frame.lastTime=r,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff},a._addAnimation=function(r){this.animations.push(r),this._handleAnimation()},a._removeAnimation=function(r){var t=r.id,e=this.animations,i=e.length,n;for(n=0;n<i;n++)if(e[n].id===t){this.animations.splice(n,1);break}},a._runFrames=function(){var r={},t=this.animations,e,i,n,o,s,h,l,u,w;for(o=0;o<t.length;o++)if(e=t[o],i=e.layers,n=e.func,e._updateFrameObject(Ze()),h=i.length,n?w=n.call(e,e.frame)!==!1:w=!0,!!w)for(s=0;s<h;s++)l=i[s],l._id!==void 0&&(r[l._id]=l);for(u in r)r.hasOwnProperty(u)&&r[u].draw()},a._animationLoop=function(){var r=a;r.animations.length?(r._runFrames(),requestAnimationFrame(r._animationLoop)):r.animRunning=!1},a._handleAnimation=function(){this.animRunning||(this.animRunning=!0,requestAnimationFrame(this._animationLoop))},a.animations=[],a.animIdCounter=0,a.animRunning=!1,a}();ue.Animation=$a;var Xi={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var r=J,t=ue,e=rt,i=X,n={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,s=2,h=3,l=0,u=["fill","stroke","shadowColor"],w=function(){function f(y,g,P,b,G,d,v){this.prop=y,this.propFunc=g,this.begin=b,this._pos=b,this.duration=d,this._change=0,this.prevPos=0,this.yoyo=v,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=P,this._change=G-this.begin,this.pause()}return f.prototype.fire=function(y){var g=this[y];g&&g()},f.prototype.setTime=function(y){y>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():y<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=y,this.update())},f.prototype.getTime=function(){return this._time},f.prototype.setPosition=function(y){this.prevPos=this._pos,this.propFunc(y),this._pos=y},f.prototype.getPosition=function(y){return y===void 0&&(y=this._time),this.func(y,this.begin,this._change,this.duration)},f.prototype.play=function(){this.state=s,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")},f.prototype.reverse=function(){this.state=h,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")},f.prototype.seek=function(y){this.pause(),this._time=y,this.update(),this.fire("onSeek")},f.prototype.reset=function(){this.pause(),this._time=0,this.update(),this.fire("onReset")},f.prototype.finish=function(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")},f.prototype.update=function(){this.setPosition(this.getPosition(this._time))},f.prototype.onEnterFrame=function(){var y=this.getTimer()-this._startTime;this.state===s?this.setTime(y):this.state===h&&this.setTime(this.duration-y)},f.prototype.pause=function(){this.state=o,this.fire("onPause")},f.prototype.getTimer=function(){return new Date().getTime()},f}(),O=function(){function f(y){var g=this,P=y.node,b=P._id,G,d=y.easing||a.Easings.Linear,v=!!y.yoyo,m;typeof y.duration>"u"?G=.3:y.duration===0?G=.001:G=y.duration,this.node=P,this._id=l++;var T=P.getLayer()||(P instanceof i.Konva.Stage?P.getLayers():null);T||r.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new t.Animation(function(){g.tween.onEnterFrame()},T),this.tween=new w(m,function(E){g._tweenFunc(E)},d,0,1,G*1e3,v),this._addListeners(),f.attrs[b]||(f.attrs[b]={}),f.attrs[b][this._id]||(f.attrs[b][this._id]={}),f.tweens[b]||(f.tweens[b]={});for(m in y)n[m]===void 0&&this._addAttr(m,y[m]);this.reset(),this.onFinish=y.onFinish,this.onReset=y.onReset}return f.prototype._addAttr=function(y,g){var P=this.node,b=P._id,G,d,v,m,T,E,x,N;if(v=f.tweens[b][y],v&&delete f.attrs[b][v][y],G=P.getAttr(y),r.Util._isArray(g))if(d=[],T=Math.max(g.length,G.length),y==="points"&&g.length!==G.length&&(g.length>G.length?(x=G,G=r.Util._prepareArrayForTween(G,g,P.closed())):(E=g,g=r.Util._prepareArrayForTween(g,G,P.closed()))),y.indexOf("fill")===0)for(m=0;m<T;m++)if(m%2===0)d.push(g[m]-G[m]);else{var k=r.Util.colorToRGBA(G[m]);N=r.Util.colorToRGBA(g[m]),G[m]=k,d.push({r:N.r-k.r,g:N.g-k.g,b:N.b-k.b,a:N.a-k.a})}else for(m=0;m<T;m++)d.push(g[m]-G[m]);else u.indexOf(y)!==-1?(G=r.Util.colorToRGBA(G),N=r.Util.colorToRGBA(g),d={r:N.r-G.r,g:N.g-G.g,b:N.b-G.b,a:N.a-G.a}):d=g-G;f.attrs[b][this._id][y]={start:G,diff:d,end:g,trueEnd:E,trueStart:x},f.tweens[b][y]=this._id},f.prototype._tweenFunc=function(y){var g=this.node,P=f.attrs[g._id][this._id],b,G,d,v,m,T,E,x;for(b in P){if(G=P[b],d=G.start,v=G.diff,x=G.end,r.Util._isArray(d))if(m=[],E=Math.max(d.length,x.length),b.indexOf("fill")===0)for(T=0;T<E;T++)T%2===0?m.push((d[T]||0)+v[T]*y):m.push("rgba("+Math.round(d[T].r+v[T].r*y)+","+Math.round(d[T].g+v[T].g*y)+","+Math.round(d[T].b+v[T].b*y)+","+(d[T].a+v[T].a*y)+")");else for(T=0;T<E;T++)m.push((d[T]||0)+v[T]*y);else u.indexOf(b)!==-1?m="rgba("+Math.round(d.r+v.r*y)+","+Math.round(d.g+v.g*y)+","+Math.round(d.b+v.b*y)+","+(d.a+v.a*y)+")":m=d+v*y;g.setAttr(b,m)}},f.prototype._addListeners=function(){var y=this;this.tween.onPlay=function(){y.anim.start()},this.tween.onReverse=function(){y.anim.start()},this.tween.onPause=function(){y.anim.stop()},this.tween.onFinish=function(){var g=y.node,P=f.attrs[g._id][y._id];P.points&&P.points.trueEnd&&g.setAttr("points",P.points.trueEnd),y.onFinish&&y.onFinish.call(y)},this.tween.onReset=function(){var g=y.node,P=f.attrs[g._id][y._id];P.points&&P.points.trueStart&&g.points(P.points.trueStart),y.onReset&&y.onReset()}},f.prototype.play=function(){return this.tween.play(),this},f.prototype.reverse=function(){return this.tween.reverse(),this},f.prototype.reset=function(){return this.tween.reset(),this},f.prototype.seek=function(y){return this.tween.seek(y*1e3),this},f.prototype.pause=function(){return this.tween.pause(),this},f.prototype.finish=function(){return this.tween.finish(),this},f.prototype.destroy=function(){var y=this.node._id,g=this._id,P=f.tweens[y],b;this.pause();for(b in P)delete f.tweens[y][b];delete f.attrs[y][g]},f.attrs={},f.tweens={},f}();a.Tween=O,e.Node.prototype.to=function(f){var y=f.onFinish;f.node=this,f.onFinish=function(){this.destroy(),y&&y()};var g=new O(f);g.play()},a.Easings={BackEaseIn:function(f,y,g,P){var b=1.70158;return g*(f/=P)*f*((b+1)*f-b)+y},BackEaseOut:function(f,y,g,P){var b=1.70158;return g*((f=f/P-1)*f*((b+1)*f+b)+1)+y},BackEaseInOut:function(f,y,g,P){var b=1.70158;return(f/=P/2)<1?g/2*(f*f*(((b*=1.525)+1)*f-b))+y:g/2*((f-=2)*f*(((b*=1.525)+1)*f+b)+2)+y},ElasticEaseIn:function(f,y,g,P,b,G){var d=0;return f===0?y:(f/=P)===1?y+g:(G||(G=P*.3),!b||b<Math.abs(g)?(b=g,d=G/4):d=G/(2*Math.PI)*Math.asin(g/b),-(b*Math.pow(2,10*(f-=1))*Math.sin((f*P-d)*(2*Math.PI)/G))+y)},ElasticEaseOut:function(f,y,g,P,b,G){var d=0;return f===0?y:(f/=P)===1?y+g:(G||(G=P*.3),!b||b<Math.abs(g)?(b=g,d=G/4):d=G/(2*Math.PI)*Math.asin(g/b),b*Math.pow(2,-10*f)*Math.sin((f*P-d)*(2*Math.PI)/G)+g+y)},ElasticEaseInOut:function(f,y,g,P,b,G){var d=0;return f===0?y:(f/=P/2)===2?y+g:(G||(G=P*(.3*1.5)),!b||b<Math.abs(g)?(b=g,d=G/4):d=G/(2*Math.PI)*Math.asin(g/b),f<1?-.5*(b*Math.pow(2,10*(f-=1))*Math.sin((f*P-d)*(2*Math.PI)/G))+y:b*Math.pow(2,-10*(f-=1))*Math.sin((f*P-d)*(2*Math.PI)/G)*.5+g+y)},BounceEaseOut:function(f,y,g,P){return(f/=P)<1/2.75?g*(7.5625*f*f)+y:f<2/2.75?g*(7.5625*(f-=1.5/2.75)*f+.75)+y:f<2.5/2.75?g*(7.5625*(f-=2.25/2.75)*f+.9375)+y:g*(7.5625*(f-=2.625/2.75)*f+.984375)+y},BounceEaseIn:function(f,y,g,P){return g-a.Easings.BounceEaseOut(P-f,0,g,P)+y},BounceEaseInOut:function(f,y,g,P){return f<P/2?a.Easings.BounceEaseIn(f*2,0,g,P)*.5+y:a.Easings.BounceEaseOut(f*2-P,0,g,P)*.5+g*.5+y},EaseIn:function(f,y,g,P){return g*(f/=P)*f+y},EaseOut:function(f,y,g,P){return-g*(f/=P)*(f-2)+y},EaseInOut:function(f,y,g,P){return(f/=P/2)<1?g/2*f*f+y:-g/2*(--f*(f-2)-1)+y},StrongEaseIn:function(f,y,g,P){return g*(f/=P)*f*f*f*f+y},StrongEaseOut:function(f,y,g,P){return g*((f=f/P-1)*f*f*f*f+1)+y},StrongEaseInOut:function(f,y,g,P){return(f/=P/2)<1?g/2*f*f*f*f*f+y:g/2*((f-=2)*f*f*f*f+2)+y},Linear:function(f,y,g,P){return g*f/P+y}}})(Xi);Object.defineProperty(fr,"__esModule",{value:!0});var Ba=X,ve=J,tr=rt,Va=Et,di=Vi,Ha=gr,za=vr,Wa=ce,ja=he,ci=ot,Ka=ue,ui=Xi,Ya=Xt,Xa=xt;fr.Konva=ve.Util._assign(Ba.Konva,{Collection:ve.Collection,Util:ve.Util,Transform:ve.Transform,Node:tr.Node,ids:tr.ids,names:tr.names,Container:Va.Container,Stage:di.Stage,stages:di.stages,Layer:Ha.Layer,FastLayer:za.FastLayer,Group:Wa.Group,DD:ja.DD,Shape:ci.Shape,shapes:ci.shapes,Animation:Ka.Animation,Tween:ui.Tween,Easings:ui.Easings,Context:Ya.Context,Canvas:Xa.Canvas});var yr={},qa=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(yr,"__esModule",{value:!0});var Ja=J,Le=Y,Qa=ot,Za=X,De=W,to=X,bt=function(a){qa(r,a);function r(){return a!==null&&a.apply(this,arguments)||this}return r.prototype._sceneFunc=function(t){var e=Za.Konva.getAngle(this.angle()),i=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,i),t.arc(0,0,this.innerRadius(),e,0,!i),t.closePath(),t.fillStrokeShape(this)},r.prototype.getWidth=function(){return this.outerRadius()*2},r.prototype.getHeight=function(){return this.outerRadius()*2},r.prototype.setWidth=function(t){this.outerRadius(t/2)},r.prototype.setHeight=function(t){this.outerRadius(t/2)},r}(Qa.Shape);yr.Arc=bt;bt.prototype._centroid=!0;bt.prototype.className="Arc";bt.prototype._attrsAffectingSize=["innerRadius","outerRadius"];to._registerNode(bt);Le.Factory.addGetterSetter(bt,"innerRadius",0,De.getNumberValidator());Le.Factory.addGetterSetter(bt,"outerRadius",0,De.getNumberValidator());Le.Factory.addGetterSetter(bt,"angle",0,De.getNumberValidator());Le.Factory.addGetterSetter(bt,"clockwise",!1,De.getBooleanValidator());Ja.Collection.mapMethods(bt);var _r={},Ie={},eo=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),ro=V&&V.__spreadArrays||function(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var e=Array(a),i=0,r=0;r<t;r++)for(var n=arguments[r],o=0,s=n.length;o<s;o++,i++)e[i]=n[o];return e};Object.defineProperty(Ie,"__esModule",{value:!0});var ne=J,Ue=Y,io=ot,qi=W,no=X,Tt=function(a){eo(r,a);function r(t){var e=a.call(this,t)||this;return e.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")}),e}return r.prototype._sceneFunc=function(t){var e=this.points(),i=e.length,n=this.tension(),o=this.closed(),s=this.bezier(),h,l,u;if(i){if(t.beginPath(),t.moveTo(e[0],e[1]),n!==0&&i>4){for(h=this.getTensionPoints(),l=h.length,u=o?0:4,o||t.quadraticCurveTo(h[0],h[1],h[2],h[3]);u<l-2;)t.bezierCurveTo(h[u++],h[u++],h[u++],h[u++],h[u++],h[u++]);o||t.quadraticCurveTo(h[l-2],h[l-1],e[i-2],e[i-1])}else if(s)for(u=2;u<i;)t.bezierCurveTo(e[u++],e[u++],e[u++],e[u++],e[u++],e[u++]);else for(u=2;u<i;u+=2)t.lineTo(e[u],e[u+1]);o?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}},r.prototype.getTensionPoints=function(){return this._getCache("tensionPoints",this._getTensionPoints)},r.prototype._getTensionPoints=function(){return this.closed()?this._getTensionPointsClosed():ne.Util._expandPoints(this.points(),this.tension())},r.prototype._getTensionPointsClosed=function(){var t=this.points(),e=t.length,i=this.tension(),n=ne.Util._getControlPoints(t[e-2],t[e-1],t[0],t[1],t[2],t[3],i),o=ne.Util._getControlPoints(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],i),s=ne.Util._expandPoints(t,i),h=[n[2],n[3]].concat(s).concat([o[0],o[1],t[e-2],t[e-1],o[2],o[3],n[0],n[1],t[0],t[1]]);return h},r.prototype.getWidth=function(){return this.getSelfRect().width},r.prototype.getHeight=function(){return this.getSelfRect().height},r.prototype.getSelfRect=function(){var t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=ro([t[0],t[1]],this._getTensionPoints(),[t[t.length-2],t[t.length-1]]):t=this.points();for(var e=t[0],i=t[0],n=t[1],o=t[1],s,h,l=0;l<t.length/2;l++)s=t[l*2],h=t[l*2+1],e=Math.min(e,s),i=Math.max(i,s),n=Math.min(n,h),o=Math.max(o,h);return{x:e,y:n,width:i-e,height:o-n}},r}(io.Shape);Ie.Line=Tt;Tt.prototype.className="Line";Tt.prototype._attrsAffectingSize=["points","bezier","tension"];no._registerNode(Tt);Ue.Factory.addGetterSetter(Tt,"closed",!1);Ue.Factory.addGetterSetter(Tt,"bezier",!1);Ue.Factory.addGetterSetter(Tt,"tension",0,qi.getNumberValidator());Ue.Factory.addGetterSetter(Tt,"points",[],qi.getNumberArrayValidator());ne.Collection.mapMethods(Tt);var ao=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(_r,"__esModule",{value:!0});var oo=J,mr=Y,so=Ie,Ji=W,ho=X,Ut=function(a){ao(r,a);function r(){return a!==null&&a.apply(this,arguments)||this}return r.prototype._sceneFunc=function(t){a.prototype._sceneFunc.call(this,t);var e=Math.PI*2,i=this.points(),n=i,o=this.tension()!==0&&i.length>4;o&&(n=this.getTensionPoints());var s=i.length,h,l;o?(h=i[s-2]-(n[n.length-2]+n[n.length-4])/2,l=i[s-1]-(n[n.length-1]+n[n.length-3])/2):(h=i[s-2]-i[s-4],l=i[s-1]-i[s-3]);var u=(Math.atan2(l,h)+e)%e,w=this.pointerLength(),O=this.pointerWidth();t.save(),t.beginPath(),t.translate(i[s-2],i[s-1]),t.rotate(u),t.moveTo(0,0),t.lineTo(-w,O/2),t.lineTo(-w,-O/2),t.closePath(),t.restore(),this.pointerAtBeginning()&&(t.save(),t.translate(i[0],i[1]),o?(h=(n[0]+n[2])/2-i[0],l=(n[1]+n[3])/2-i[1]):(h=i[2]-i[0],l=i[3]-i[1]),t.rotate((Math.atan2(-l,-h)+e)%e),t.moveTo(0,0),t.lineTo(-w,O/2),t.lineTo(-w,-O/2),t.closePath(),t.restore());var f=this.dashEnabled();f&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),f&&(this.attrs.dashEnabled=!0)},r.prototype.getSelfRect=function(){var t=a.prototype.getSelfRect.call(this),e=this.pointerWidth()/2;return{x:t.x-e,y:t.y-e,width:t.width+e*2,height:t.height+e*2}},r}(so.Line);_r.Arrow=Ut;Ut.prototype.className="Arrow";ho._registerNode(Ut);mr.Factory.addGetterSetter(Ut,"pointerLength",10,Ji.getNumberValidator());mr.Factory.addGetterSetter(Ut,"pointerWidth",10,Ji.getNumberValidator());mr.Factory.addGetterSetter(Ut,"pointerAtBeginning",!1);oo.Collection.mapMethods(Ut);var Sr={},lo=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(Sr,"__esModule",{value:!0});var co=J,uo=Y,fo=ot,po=W,go=X,$t=function(a){lo(r,a);function r(){return a!==null&&a.apply(this,arguments)||this}return r.prototype._sceneFunc=function(t){t.beginPath(),t.arc(0,0,this.radius(),0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)},r.prototype.getWidth=function(){return this.radius()*2},r.prototype.getHeight=function(){return this.radius()*2},r.prototype.setWidth=function(t){this.radius()!==t/2&&this.radius(t/2)},r.prototype.setHeight=function(t){this.radius()!==t/2&&this.radius(t/2)},r}(fo.Shape);Sr.Circle=$t;$t.prototype._centroid=!0;$t.prototype.className="Circle";$t.prototype._attrsAffectingSize=["radius"];go._registerNode($t);uo.Factory.addGetterSetter($t,"radius",0,po.getNumberValidator());co.Collection.mapMethods($t);var br={},vo=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(br,"__esModule",{value:!0});var yo=J,Cr=Y,_o=ot,Qi=W,mo=X,Ot=function(a){vo(r,a);function r(){return a!==null&&a.apply(this,arguments)||this}return r.prototype._sceneFunc=function(t){var e=this.radiusX(),i=this.radiusY();t.beginPath(),t.save(),e!==i&&t.scale(1,i/e),t.arc(0,0,e,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)},r.prototype.getWidth=function(){return this.radiusX()*2},r.prototype.getHeight=function(){return this.radiusY()*2},r.prototype.setWidth=function(t){this.radiusX(t/2)},r.prototype.setHeight=function(t){this.radiusY(t/2)},r}(_o.Shape);br.Ellipse=Ot;Ot.prototype.className="Ellipse";Ot.prototype._centroid=!0;Ot.prototype._attrsAffectingSize=["radiusX","radiusY"];mo._registerNode(Ot);Cr.Factory.addComponentsGetterSetter(Ot,"radius",["x","y"]);Cr.Factory.addGetterSetter(Ot,"radiusX",0,Qi.getNumberValidator());Cr.Factory.addGetterSetter(Ot,"radiusY",0,Qi.getNumberValidator());yo.Collection.mapMethods(Ot);var wr={},So=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(wr,"__esModule",{value:!0});var Zi=J,Jt=Y,bo=ot,$e=W,Co=X,Ct=function(a){So(r,a);function r(){return a!==null&&a.apply(this,arguments)||this}return r.prototype._useBufferCanvas=function(){return!!((this.hasShadow()||this.getAbsoluteOpacity()!==1)&&this.hasStroke()&&this.getStage())},r.prototype._sceneFunc=function(t){var e=this.width(),i=this.height(),n=this.image(),o,s,h;n&&(o=this.cropWidth(),s=this.cropHeight(),o&&s?h=[n,this.cropX(),this.cropY(),o,s,0,0,e,i]:h=[n,0,0,e,i]),(this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)),n&&t.drawImage.apply(t,h)},r.prototype._hitFunc=function(t){var e=this.width(),i=this.height();t.beginPath(),t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)},r.prototype.getWidth=function(){var t,e=this.image();return(t=this.attrs.width)!==null&&t!==void 0?t:e?e.width:0},r.prototype.getHeight=function(){var t,e=this.image();return(t=this.attrs.height)!==null&&t!==void 0?t:e?e.height:0},r.fromURL=function(t,e){var i=Zi.Util.createImageElement();i.onload=function(){var n=new r({image:i});e(n)},i.crossOrigin="Anonymous",i.src=t},r}(bo.Shape);wr.Image=Ct;Ct.prototype.className="Image";Co._registerNode(Ct);Jt.Factory.addGetterSetter(Ct,"image");Jt.Factory.addComponentsGetterSetter(Ct,"crop",["x","y","width","height"]);Jt.Factory.addGetterSetter(Ct,"cropX",0,$e.getNumberValidator());Jt.Factory.addGetterSetter(Ct,"cropY",0,$e.getNumberValidator());Jt.Factory.addGetterSetter(Ct,"cropWidth",0,$e.getNumberValidator());Jt.Factory.addGetterSetter(Ct,"cropHeight",0,$e.getNumberValidator());Zi.Collection.mapMethods(Ct);var Be={},tn=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(Be,"__esModule",{value:!0});var en=J,Ve=Y,wo=ot,Po=ce,Pr=W,rn=X,nn=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width"],xo="Change.konva",To="none",hr="up",lr="right",dr="down",cr="left",Oo=nn.length,He=function(a){tn(r,a);function r(t){var e=a.call(this,t)||this;return e.on("add.konva",function(i){this._addListeners(i.child),this._sync()}),e}return r.prototype.getText=function(){return this.find("Text")[0]},r.prototype.getTag=function(){return this.find("Tag")[0]},r.prototype._addListeners=function(t){var e=this,i,n=function(){e._sync()};for(i=0;i<Oo;i++)t.on(nn[i]+xo,n)},r.prototype.getWidth=function(){return this.getText().width()},r.prototype.getHeight=function(){return this.getText().height()},r.prototype._sync=function(){var t=this.getText(),e=this.getTag(),i,n,o,s,h,l,u;if(t&&e){switch(i=t.width(),n=t.height(),o=e.pointerDirection(),s=e.pointerWidth(),u=e.pointerHeight(),h=0,l=0,o){case hr:h=i/2,l=-1*u;break;case lr:h=i+s,l=n/2;break;case dr:h=i/2,l=n+u;break;case cr:h=-1*s,l=n/2;break}e.setAttrs({x:-1*h,y:-1*l,width:i,height:n}),t.setAttrs({x:-1*h,y:-1*l})}},r}(Po.Group);Be.Label=He;He.prototype.className="Label";rn._registerNode(He);en.Collection.mapMethods(He);var Gt=function(a){tn(r,a);function r(){return a!==null&&a.apply(this,arguments)||this}return r.prototype._sceneFunc=function(t){var e=this.width(),i=this.height(),n=this.pointerDirection(),o=this.pointerWidth(),s=this.pointerHeight(),h=Math.min(this.cornerRadius(),e/2,i/2);t.beginPath(),h?t.moveTo(h,0):t.moveTo(0,0),n===hr&&(t.lineTo((e-o)/2,0),t.lineTo(e/2,-1*s),t.lineTo((e+o)/2,0)),h?(t.lineTo(e-h,0),t.arc(e-h,h,h,Math.PI*3/2,0,!1)):t.lineTo(e,0),n===lr&&(t.lineTo(e,(i-s)/2),t.lineTo(e+o,i/2),t.lineTo(e,(i+s)/2)),h?(t.lineTo(e,i-h),t.arc(e-h,i-h,h,0,Math.PI/2,!1)):t.lineTo(e,i),n===dr&&(t.lineTo((e+o)/2,i),t.lineTo(e/2,i+s),t.lineTo((e-o)/2,i)),h?(t.lineTo(h,i),t.arc(h,i-h,h,Math.PI/2,Math.PI,!1)):t.lineTo(0,i),n===cr&&(t.lineTo(0,(i+s)/2),t.lineTo(-1*o,i/2),t.lineTo(0,(i-s)/2)),h&&(t.lineTo(0,h),t.arc(h,h,h,Math.PI,Math.PI*3/2,!1)),t.closePath(),t.fillStrokeShape(this)},r.prototype.getSelfRect=function(){var t=0,e=0,i=this.pointerWidth(),n=this.pointerHeight(),o=this.pointerDirection(),s=this.width(),h=this.height();return o===hr?(e-=n,h+=n):o===dr?h+=n:o===cr?(t-=i*1.5,s+=i):o===lr&&(s+=i*1.5),{x:t,y:e,width:s,height:h}},r}(wo.Shape);Be.Tag=Gt;Gt.prototype.className="Tag";rn._registerNode(Gt);Ve.Factory.addGetterSetter(Gt,"pointerDirection",To);Ve.Factory.addGetterSetter(Gt,"pointerWidth",0,Pr.getNumberValidator());Ve.Factory.addGetterSetter(Gt,"pointerHeight",0,Pr.getNumberValidator());Ve.Factory.addGetterSetter(Gt,"cornerRadius",0,Pr.getNumberValidator());en.Collection.mapMethods(Gt);var ze={},Ao=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(ze,"__esModule",{value:!0});var Fo=J,Eo=Y,ko=ot,Mo=X,Qt=function(a){Ao(r,a);function r(t){var e=a.call(this,t)||this;e.dataArray=[],e.pathLength=0,e.dataArray=r.parsePathData(e.data()),e.pathLength=0;for(var i=0;i<e.dataArray.length;++i)e.pathLength+=e.dataArray[i].pathLength;return e.on("dataChange.konva",function(){this.dataArray=r.parsePathData(this.data()),this.pathLength=0;for(var n=0;n<this.dataArray.length;++n)this.pathLength+=this.dataArray[n].pathLength}),e}return r.prototype._sceneFunc=function(t){var e=this.dataArray;t.beginPath();for(var i=!1,n=0;n<e.length;n++){var o=e[n].command,s=e[n].points;switch(o){case"L":t.lineTo(s[0],s[1]);break;case"M":t.moveTo(s[0],s[1]);break;case"C":t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":var h=s[0],l=s[1],u=s[2],w=s[3],O=s[4],f=s[5],y=s[6],g=s[7],P=u>w?u:w,b=u>w?1:u/w,G=u>w?w/u:1;t.translate(h,l),t.rotate(y),t.scale(b,G),t.arc(0,0,P,O,O+f,1-g),t.scale(1/b,1/G),t.rotate(-y),t.translate(-h,-l);break;case"z":i=!0,t.closePath();break}}!i&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)},r.prototype.getSelfRect=function(){var t=[];this.dataArray.forEach(function(u){if(u.command==="A"){var w=u.points[4],O=u.points[5],f=u.points[4]+O,y=Math.PI/180;if(Math.abs(w-f)<y&&(y=Math.abs(w-f)),O<0)for(var g=w-y;g>f;g-=y){var P=r.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],g,0);t.push(P.x,P.y)}else for(var g=w+y;g<f;g+=y){var P=r.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],g,0);t.push(P.x,P.y)}}else if(u.command==="C")for(var g=0;g<=1;g+=.01){var P=r.getPointOnCubicBezier(g,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);t.push(P.x,P.y)}else t=t.concat(u.points)});for(var e=t[0],i=t[0],n=t[1],o=t[1],s,h,l=0;l<t.length/2;l++)s=t[l*2],h=t[l*2+1],isNaN(s)||(e=Math.min(e,s),i=Math.max(i,s)),isNaN(h)||(n=Math.min(n,h),o=Math.max(o,h));return{x:Math.round(e),y:Math.round(n),width:Math.round(i-e),height:Math.round(o-n)}},r.prototype.getLength=function(){return this.pathLength},r.prototype.getPointAtLength=function(t){var e,i=0,n=this.dataArray.length;if(!n)return null;for(;i<n&&t>this.dataArray[i].pathLength;)t-=this.dataArray[i].pathLength,++i;if(i===n)return e=this.dataArray[i-1].points.slice(-2),{x:e[0],y:e[1]};if(t<.01)return e=this.dataArray[i].points.slice(0,2),{x:e[0],y:e[1]};var o=this.dataArray[i],s=o.points;switch(o.command){case"L":return r.getPointOnLine(t,o.start.x,o.start.y,s[0],s[1]);case"C":return r.getPointOnCubicBezier(t/o.pathLength,o.start.x,o.start.y,s[0],s[1],s[2],s[3],s[4],s[5]);case"Q":return r.getPointOnQuadraticBezier(t/o.pathLength,o.start.x,o.start.y,s[0],s[1],s[2],s[3]);case"A":var h=s[0],l=s[1],u=s[2],w=s[3],O=s[4],f=s[5],y=s[6];return O+=f*t/o.pathLength,r.getPointOnEllipticalArc(h,l,u,w,O,y)}return null},r.getLineLength=function(t,e,i,n){return Math.sqrt((i-t)*(i-t)+(n-e)*(n-e))},r.getPointOnLine=function(t,e,i,n,o,s,h){s===void 0&&(s=e),h===void 0&&(h=i);var l=(o-i)/(n-e+1e-8),u=Math.sqrt(t*t/(1+l*l));n<e&&(u*=-1);var w=l*u,O;if(n===e)O={x:s,y:h+w};else if((h-i)/(s-e+1e-8)===l)O={x:s+u,y:h+w};else{var f,y,g=this.getLineLength(e,i,n,o);if(g<1e-8)return;var P=(s-e)*(n-e)+(h-i)*(o-i);P=P/(g*g),f=e+P*(n-e),y=i+P*(o-i);var b=this.getLineLength(s,h,f,y),G=Math.sqrt(t*t-b*b);u=Math.sqrt(G*G/(1+l*l)),n<e&&(u*=-1),w=l*u,O={x:f+u,y:y+w}}return O},r.getPointOnCubicBezier=function(t,e,i,n,o,s,h,l,u){function w(b){return b*b*b}function O(b){return 3*b*b*(1-b)}function f(b){return 3*b*(1-b)*(1-b)}function y(b){return(1-b)*(1-b)*(1-b)}var g=l*w(t)+s*O(t)+n*f(t)+e*y(t),P=u*w(t)+h*O(t)+o*f(t)+i*y(t);return{x:g,y:P}},r.getPointOnQuadraticBezier=function(t,e,i,n,o,s,h){function l(y){return y*y}function u(y){return 2*y*(1-y)}function w(y){return(1-y)*(1-y)}var O=s*l(t)+n*u(t)+e*w(t),f=h*l(t)+o*u(t)+i*w(t);return{x:O,y:f}},r.getPointOnEllipticalArc=function(t,e,i,n,o,s){var h=Math.cos(s),l=Math.sin(s),u={x:i*Math.cos(o),y:n*Math.sin(o)};return{x:t+(u.x*h-u.y*l),y:e+(u.x*l+u.y*h)}},r.parsePathData=function(t){if(!t)return[];var e=t,i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(var n=0;n<i.length;n++)e=e.replace(new RegExp(i[n],"g"),"|"+i[n]);var o=e.split("|"),s=[],h=[],l=0,u=0,w=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,O;for(n=1;n<o.length;n++){var f=o[n],y=f.charAt(0);for(f=f.slice(1),h.length=0;O=w.exec(f);)h.push(O[0]);for(var g=[],P=0,b=h.length;P<b;P++){var G=parseFloat(h[P]);isNaN(G)?g.push(0):g.push(G)}for(;g.length>0&&!isNaN(g[0]);){var d=null,v=[],m=l,T=u,E,x,N,k,A,D,R,S,c,p;switch(y){case"l":l+=g.shift(),u+=g.shift(),d="L",v.push(l,u);break;case"L":l=g.shift(),u=g.shift(),v.push(l,u);break;case"m":var _=g.shift(),F=g.shift();if(l+=_,u+=F,d="M",s.length>2&&s[s.length-1].command==="z"){for(var M=s.length-2;M>=0;M--)if(s[M].command==="M"){l=s[M].points[0]+_,u=s[M].points[1]+F;break}}v.push(l,u),y="l";break;case"M":l=g.shift(),u=g.shift(),d="M",v.push(l,u),y="L";break;case"h":l+=g.shift(),d="L",v.push(l,u);break;case"H":l=g.shift(),d="L",v.push(l,u);break;case"v":u+=g.shift(),d="L",v.push(l,u);break;case"V":u=g.shift(),d="L",v.push(l,u);break;case"C":v.push(g.shift(),g.shift(),g.shift(),g.shift()),l=g.shift(),u=g.shift(),v.push(l,u);break;case"c":v.push(l+g.shift(),u+g.shift(),l+g.shift(),u+g.shift()),l+=g.shift(),u+=g.shift(),d="C",v.push(l,u);break;case"S":x=l,N=u,E=s[s.length-1],E.command==="C"&&(x=l+(l-E.points[2]),N=u+(u-E.points[3])),v.push(x,N,g.shift(),g.shift()),l=g.shift(),u=g.shift(),d="C",v.push(l,u);break;case"s":x=l,N=u,E=s[s.length-1],E.command==="C"&&(x=l+(l-E.points[2]),N=u+(u-E.points[3])),v.push(x,N,l+g.shift(),u+g.shift()),l+=g.shift(),u+=g.shift(),d="C",v.push(l,u);break;case"Q":v.push(g.shift(),g.shift()),l=g.shift(),u=g.shift(),v.push(l,u);break;case"q":v.push(l+g.shift(),u+g.shift()),l+=g.shift(),u+=g.shift(),d="Q",v.push(l,u);break;case"T":x=l,N=u,E=s[s.length-1],E.command==="Q"&&(x=l+(l-E.points[0]),N=u+(u-E.points[1])),l=g.shift(),u=g.shift(),d="Q",v.push(x,N,l,u);break;case"t":x=l,N=u,E=s[s.length-1],E.command==="Q"&&(x=l+(l-E.points[0]),N=u+(u-E.points[1])),l+=g.shift(),u+=g.shift(),d="Q",v.push(x,N,l,u);break;case"A":k=g.shift(),A=g.shift(),D=g.shift(),R=g.shift(),S=g.shift(),c=l,p=u,l=g.shift(),u=g.shift(),d="A",v=this.convertEndpointToCenterParameterization(c,p,l,u,R,S,k,A,D);break;case"a":k=g.shift(),A=g.shift(),D=g.shift(),R=g.shift(),S=g.shift(),c=l,p=u,l+=g.shift(),u+=g.shift(),d="A",v=this.convertEndpointToCenterParameterization(c,p,l,u,R,S,k,A,D);break}s.push({command:d||y,points:v,start:{x:m,y:T},pathLength:this.calcLength(m,T,d||y,v)})}(y==="z"||y==="Z")&&s.push({command:"z",points:[],start:void 0,pathLength:0})}return s},r.calcLength=function(t,e,i,n){var o,s,h,l,u=r;switch(i){case"L":return u.getLineLength(t,e,n[0],n[1]);case"C":for(o=0,s=u.getPointOnCubicBezier(0,t,e,n[0],n[1],n[2],n[3],n[4],n[5]),l=.01;l<=1;l+=.01)h=u.getPointOnCubicBezier(l,t,e,n[0],n[1],n[2],n[3],n[4],n[5]),o+=u.getLineLength(s.x,s.y,h.x,h.y),s=h;return o;case"Q":for(o=0,s=u.getPointOnQuadraticBezier(0,t,e,n[0],n[1],n[2],n[3]),l=.01;l<=1;l+=.01)h=u.getPointOnQuadraticBezier(l,t,e,n[0],n[1],n[2],n[3]),o+=u.getLineLength(s.x,s.y,h.x,h.y),s=h;return o;case"A":o=0;var w=n[4],O=n[5],f=n[4]+O,y=Math.PI/180;if(Math.abs(w-f)<y&&(y=Math.abs(w-f)),s=u.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],w,0),O<0)for(l=w-y;l>f;l-=y)h=u.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],l,0),o+=u.getLineLength(s.x,s.y,h.x,h.y),s=h;else for(l=w+y;l<f;l+=y)h=u.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],l,0),o+=u.getLineLength(s.x,s.y,h.x,h.y),s=h;return h=u.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],f,0),o+=u.getLineLength(s.x,s.y,h.x,h.y),o}return 0},r.convertEndpointToCenterParameterization=function(t,e,i,n,o,s,h,l,u){var w=u*(Math.PI/180),O=Math.cos(w)*(t-i)/2+Math.sin(w)*(e-n)/2,f=-1*Math.sin(w)*(t-i)/2+Math.cos(w)*(e-n)/2,y=O*O/(h*h)+f*f/(l*l);y>1&&(h*=Math.sqrt(y),l*=Math.sqrt(y));var g=Math.sqrt((h*h*(l*l)-h*h*(f*f)-l*l*(O*O))/(h*h*(f*f)+l*l*(O*O)));o===s&&(g*=-1),isNaN(g)&&(g=0);var P=g*h*f/l,b=g*-l*O/h,G=(t+i)/2+Math.cos(w)*P-Math.sin(w)*b,d=(e+n)/2+Math.sin(w)*P+Math.cos(w)*b,v=function(A){return Math.sqrt(A[0]*A[0]+A[1]*A[1])},m=function(A,D){return(A[0]*D[0]+A[1]*D[1])/(v(A)*v(D))},T=function(A,D){return(A[0]*D[1]<A[1]*D[0]?-1:1)*Math.acos(m(A,D))},E=T([1,0],[(O-P)/h,(f-b)/l]),x=[(O-P)/h,(f-b)/l],N=[(-1*O-P)/h,(-1*f-b)/l],k=T(x,N);return m(x,N)<=-1&&(k=Math.PI),m(x,N)>=1&&(k=0),s===0&&k>0&&(k=k-2*Math.PI),s===1&&k<0&&(k=k+2*Math.PI),[G,d,h,l,E,k,w,s]},r}(ko.Shape);ze.Path=Qt;Qt.prototype.className="Path";Qt.prototype._attrsAffectingSize=["data"];Mo._registerNode(Qt);Eo.Factory.addGetterSetter(Qt,"data");Fo.Collection.mapMethods(Qt);var We={},Go=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(We,"__esModule",{value:!0});var No=J,Ro=Y,Lo=ot,Do=X,fe=function(a){Go(r,a);function r(){return a!==null&&a.apply(this,arguments)||this}return r.prototype._sceneFunc=function(t){var e=this.cornerRadius(),i=this.width(),n=this.height();if(t.beginPath(),!e)t.rect(0,0,i,n);else{var o=0,s=0,h=0,l=0;typeof e=="number"?o=s=h=l=Math.min(e,i/2,n/2):(o=Math.min(e[0],i/2,n/2),s=Math.min(e[1],i/2,n/2),l=Math.min(e[2],i/2,n/2),h=Math.min(e[3],i/2,n/2)),t.moveTo(o,0),t.lineTo(i-s,0),t.arc(i-s,s,s,Math.PI*3/2,0,!1),t.lineTo(i,n-l),t.arc(i-l,n-l,l,0,Math.PI/2,!1),t.lineTo(h,n),t.arc(h,n-h,h,Math.PI/2,Math.PI,!1),t.lineTo(0,o),t.arc(o,o,o,Math.PI,Math.PI*3/2,!1)}t.closePath(),t.fillStrokeShape(this)},r}(Lo.Shape);We.Rect=fe;fe.prototype.className="Rect";Do._registerNode(fe);Ro.Factory.addGetterSetter(fe,"cornerRadius",0);No.Collection.mapMethods(fe);var xr={},Io=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(xr,"__esModule",{value:!0});var Uo=J,an=Y,$o=ot,on=W,Bo=X,Nt=function(a){Io(r,a);function r(){return a!==null&&a.apply(this,arguments)||this}return r.prototype._sceneFunc=function(t){var e=this.sides(),i=this.radius(),n,o,s;for(t.beginPath(),t.moveTo(0,0-i),n=1;n<e;n++)o=i*Math.sin(n*2*Math.PI/e),s=-1*i*Math.cos(n*2*Math.PI/e),t.lineTo(o,s);t.closePath(),t.fillStrokeShape(this)},r.prototype.getWidth=function(){return this.radius()*2},r.prototype.getHeight=function(){return this.radius()*2},r.prototype.setWidth=function(t){this.radius(t/2)},r.prototype.setHeight=function(t){this.radius(t/2)},r}($o.Shape);xr.RegularPolygon=Nt;Nt.prototype.className="RegularPolygon";Nt.prototype._centroid=!0;Nt.prototype._attrsAffectingSize=["radius"];Bo._registerNode(Nt);an.Factory.addGetterSetter(Nt,"radius",0,on.getNumberValidator());an.Factory.addGetterSetter(Nt,"sides",0,on.getNumberValidator());Uo.Collection.mapMethods(Nt);var Tr={},Vo=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(Tr,"__esModule",{value:!0});var Ho=J,sn=Y,zo=ot,hn=W,Wo=X,fi=Math.PI*2,Rt=function(a){Vo(r,a);function r(){return a!==null&&a.apply(this,arguments)||this}return r.prototype._sceneFunc=function(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,fi,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),fi,0,!0),t.closePath(),t.fillStrokeShape(this)},r.prototype.getWidth=function(){return this.outerRadius()*2},r.prototype.getHeight=function(){return this.outerRadius()*2},r.prototype.setWidth=function(t){this.outerRadius(t/2)},r.prototype.setHeight=function(t){this.outerRadius(t/2)},r}(zo.Shape);Tr.Ring=Rt;Rt.prototype.className="Ring";Rt.prototype._centroid=!0;Rt.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Wo._registerNode(Rt);sn.Factory.addGetterSetter(Rt,"innerRadius",0,hn.getNumberValidator());sn.Factory.addGetterSetter(Rt,"outerRadius",0,hn.getNumberValidator());Ho.Collection.mapMethods(Rt);var Or={},jo=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(Or,"__esModule",{value:!0});var Ko=J,Bt=Y,Yo=ot,Xo=ue,ln=W,qo=X,yt=function(a){jo(r,a);function r(t){var e=a.call(this,t)||this;return e._updated=!0,e.anim=new Xo.Animation(function(){var i=e._updated;return e._updated=!1,i}),e.on("animationChange.konva",function(){this.frameIndex(0)}),e.on("frameIndexChange.konva",function(){this._updated=!0}),e.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())}),e}return r.prototype._sceneFunc=function(t){var e=this.animation(),i=this.frameIndex(),n=i*4,o=this.animations()[e],s=this.frameOffsets(),h=o[n+0],l=o[n+1],u=o[n+2],w=o[n+3],O=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,u,w),t.closePath(),t.fillStrokeShape(this)),O)if(s){var f=s[e],y=i*2;t.drawImage(O,h,l,u,w,f[y+0],f[y+1],u,w)}else t.drawImage(O,h,l,u,w,0,0,u,w)},r.prototype._hitFunc=function(t){var e=this.animation(),i=this.frameIndex(),n=i*4,o=this.animations()[e],s=this.frameOffsets(),h=o[n+2],l=o[n+3];if(t.beginPath(),s){var u=s[e],w=i*2;t.rect(u[w+0],u[w+1],h,l)}else t.rect(0,0,h,l);t.closePath(),t.fillShape(this)},r.prototype._useBufferCanvas=function(){return(this.hasShadow()||this.getAbsoluteOpacity()!==1)&&this.hasStroke()},r.prototype._setInterval=function(){var t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())},r.prototype.start=function(){if(!this.isRunning()){var t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}},r.prototype.stop=function(){this.anim.stop(),clearInterval(this.interval)},r.prototype.isRunning=function(){return this.anim.isRunning()},r.prototype._updateIndex=function(){var t=this.frameIndex(),e=this.animation(),i=this.animations(),n=i[e],o=n.length/4;t<o-1?this.frameIndex(t+1):this.frameIndex(0)},r}(Yo.Shape);Or.Sprite=yt;yt.prototype.className="Sprite";qo._registerNode(yt);Bt.Factory.addGetterSetter(yt,"animation");Bt.Factory.addGetterSetter(yt,"animations");Bt.Factory.addGetterSetter(yt,"frameOffsets");Bt.Factory.addGetterSetter(yt,"image");Bt.Factory.addGetterSetter(yt,"frameIndex",0,ln.getNumberValidator());Bt.Factory.addGetterSetter(yt,"frameRate",17,ln.getNumberValidator());Bt.Factory.backCompat(yt,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});Ko.Collection.mapMethods(yt);var Ar={},Jo=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(Ar,"__esModule",{value:!0});var Qo=J,Fr=Y,Zo=ot,Er=W,ts=X,At=function(a){Jo(r,a);function r(){return a!==null&&a.apply(this,arguments)||this}return r.prototype._sceneFunc=function(t){var e=this.innerRadius(),i=this.outerRadius(),n=this.numPoints();t.beginPath(),t.moveTo(0,0-i);for(var o=1;o<n*2;o++){var s=o%2===0?i:e,h=s*Math.sin(o*Math.PI/n),l=-1*s*Math.cos(o*Math.PI/n);t.lineTo(h,l)}t.closePath(),t.fillStrokeShape(this)},r.prototype.getWidth=function(){return this.outerRadius()*2},r.prototype.getHeight=function(){return this.outerRadius()*2},r.prototype.setWidth=function(t){this.outerRadius(t/2)},r.prototype.setHeight=function(t){this.outerRadius(t/2)},r}(Zo.Shape);Ar.Star=At;At.prototype.className="Star";At.prototype._centroid=!0;At.prototype._attrsAffectingSize=["innerRadius","outerRadius"];ts._registerNode(At);Fr.Factory.addGetterSetter(At,"numPoints",5,Er.getNumberValidator());Fr.Factory.addGetterSetter(At,"innerRadius",0,Er.getNumberValidator());Fr.Factory.addGetterSetter(At,"outerRadius",0,Er.getNumberValidator());Qo.Collection.mapMethods(At);var je={},es=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(je,"__esModule",{value:!0});var Pe=J,ft=Y,rs=ot,is=X,Vt=W,ns=X,ye="auto",as="center",te="justify",os="Change.konva",ss="2d",pi="-",dn="left",hs="text",ls="Text",ds="top",cs="bottom",gi="middle",cn="normal",vi="px ",ee=" ",us="right",fs="word",ps="char",gs="none",yi="",un=["fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],vs=un.length,_e;function er(){return _e||(_e=Pe.Util.createCanvasElement().getContext(ss),_e)}function ys(a){a.fillText(this._partialText,this._partialTextX,this._partialTextY)}function _s(a){a.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function ms(a){return a=a||{},!a.fillLinearGradientColorStops&&!a.fillRadialGradientColorStops&&!a.fillPatternImage&&(a.fill=a.fill||"black"),a}var it=function(a){es(r,a);function r(t){var e=a.call(this,ms(t))||this;e._partialTextX=0,e._partialTextY=0;for(var i=0;i<vs;i++)e.on(un[i]+os,e._setTextData);return e._setTextData(),e}return r.prototype._sceneFunc=function(t){var e=this.padding(),i=this.fontSize(),n=this.lineHeight()*i,o=this.textArr,s=o.length,h=this.verticalAlign(),l=0,u=this.align(),w=this.getWidth(),O=this.letterSpacing(),f=this.fill(),y=this.textDecoration(),g=y.indexOf("underline")!==-1,P=y.indexOf("line-through")!==-1,b,G=0,G=n/2,d=0,v=0;for(t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",gi),t.setAttr("textAlign",dn),h===gi?l=(this.getHeight()-s*n-e*2)/2:h===cs&&(l=this.getHeight()-s*n-e*2),t.translate(e,l+e),b=0;b<s;b++){var d=0,v=0,m=o[b],T=m.text,E=m.width,x=b!==s-1,N,k,A;if(t.save(),u===us?d+=w-E-e*2:u===as&&(d+=(w-E-e*2)/2),g&&(t.save(),t.beginPath(),t.moveTo(d,G+v+Math.round(i/2)),N=T.split(" ").length-1,k=N===0,A=u===te&&x&&!k?w-e*2:E,t.lineTo(d+Math.round(A),G+v+Math.round(i/2)),t.lineWidth=i/15,t.strokeStyle=f,t.stroke(),t.restore()),P&&(t.save(),t.beginPath(),t.moveTo(d,G+v),N=T.split(" ").length-1,k=N===0,A=u===te&&x&&!k?w-e*2:E,t.lineTo(d+Math.round(A),G+v),t.lineWidth=i/15,t.strokeStyle=f,t.stroke(),t.restore()),O!==0||u===te){N=T.split(" ").length-1;for(var D=0;D<T.length;D++){var R=T[D];R===" "&&b!==s-1&&u===te&&(d+=Math.floor((w-e*2-E)/N)),this._partialTextX=d,this._partialTextY=G+v,this._partialText=R,t.fillStrokeShape(this),d+=Math.round(this.measureSize(R).width)+O}}else this._partialTextX=d,this._partialTextY=G+v,this._partialText=T,t.fillStrokeShape(this);t.restore(),s>1&&(G+=n)}},r.prototype._hitFunc=function(t){var e=this.getWidth(),i=this.getHeight();t.beginPath(),t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)},r.prototype.setText=function(t){var e=Pe.Util._isString(t)?t:t==null?"":t+"";return this._setAttr(hs,e),this},r.prototype.getWidth=function(){var t=this.attrs.width===ye||this.attrs.width===void 0;return t?this.getTextWidth()+this.padding()*2:this.attrs.width},r.prototype.getHeight=function(){var t=this.attrs.height===ye||this.attrs.height===void 0;return t?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height},r.prototype.getTextWidth=function(){return this.textWidth},r.prototype.getTextHeight=function(){return Pe.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight},r.prototype.measureSize=function(t){var e=er(),i=this.fontSize(),n;return e.save(),e.font=this._getContextFont(),n=e.measureText(t),e.restore(),{width:n.width,height:i}},r.prototype._getContextFont=function(){return is.Konva.UA.isIE?this.fontStyle()+ee+this.fontSize()+vi+this.fontFamily():this.fontStyle()+ee+this.fontVariant()+ee+this.fontSize()+vi+this.fontFamily()},r.prototype._addTextLine=function(t){this.align()===te&&(t=t.trim());var e=this._getTextWidth(t);return this.textArr.push({text:t,width:e})},r.prototype._getTextWidth=function(t){var e=this.letterSpacing(),i=t.length;return er().measureText(t).width+(i?e*(i-1):0)},r.prototype._setTextData=function(){var t=this.text().split(`
`),e=+this.fontSize(),i=0,n=this.lineHeight()*e,o=this.attrs.width,s=this.attrs.height,h=o!==ye&&o!==void 0,l=s!==ye&&s!==void 0,u=this.padding(),w=o-u*2,O=s-u*2,f=0,y=this.wrap(),g=y!==gs,P=y!==ps&&g,b=this.ellipsis()&&!g;this.textArr=[],er().font=this._getContextFont();for(var G=b?this._getTextWidth(yi):0,d=0,v=t.length;d<v;++d){var m=t[d],T=this._getTextWidth(m);if(h&&T>w)for(;m.length>0;){for(var E=0,x=m.length,N="",k=0;E<x;){var A=E+x>>>1,D=m.slice(0,A+1),R=this._getTextWidth(D)+G;R<=w?(E=A+1,N=D+(b?yi:""),k=R):x=A}if(N){if(P){var S,c=m[N.length],p=c===ee||c===pi;p&&k<=w?S=N.length:S=Math.max(N.lastIndexOf(ee),N.lastIndexOf(pi))+1,S>0&&(E=S,N=N.slice(0,E),k=this._getTextWidth(N))}if(N=N.trimRight(),this._addTextLine(N),i=Math.max(i,k),f+=n,!g||l&&f+n>O)break;if(m=m.slice(E),m=m.trimLeft(),m.length>0&&(T=this._getTextWidth(m),T<=w)){this._addTextLine(m),f+=n,i=Math.max(i,T);break}}else break}else this._addTextLine(m),f+=n,i=Math.max(i,T);if(l&&f+n>O)break}this.textHeight=e,this.textWidth=i},r.prototype.getStrokeScaleEnabled=function(){return!0},r}(rs.Shape);je.Text=it;it.prototype._fillFunc=ys;it.prototype._strokeFunc=_s;it.prototype.className=ls;it.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight"];ns._registerNode(it);ft.Factory.overWriteSetter(it,"width",Vt.getNumberOrAutoValidator());ft.Factory.overWriteSetter(it,"height",Vt.getNumberOrAutoValidator());ft.Factory.addGetterSetter(it,"fontFamily","Arial");ft.Factory.addGetterSetter(it,"fontSize",12,Vt.getNumberValidator());ft.Factory.addGetterSetter(it,"fontStyle",cn);ft.Factory.addGetterSetter(it,"fontVariant",cn);ft.Factory.addGetterSetter(it,"padding",0,Vt.getNumberValidator());ft.Factory.addGetterSetter(it,"align",dn);ft.Factory.addGetterSetter(it,"verticalAlign",ds);ft.Factory.addGetterSetter(it,"lineHeight",1,Vt.getNumberValidator());ft.Factory.addGetterSetter(it,"wrap",fs);ft.Factory.addGetterSetter(it,"ellipsis",!1);ft.Factory.addGetterSetter(it,"letterSpacing",0,Vt.getNumberValidator());ft.Factory.addGetterSetter(it,"text","",Vt.getStringValidator());ft.Factory.addGetterSetter(it,"textDecoration","");Pe.Collection.mapMethods(it);var kr={},Ss=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(kr,"__esModule",{value:!0});var be=J,_t=Y,bs=ot,St=ze,_i=je,fn=W,Cs=X,ws="",pn="normal";function gn(a){a.fillText(this.partialText,0,0)}function vn(a){a.strokeText(this.partialText,0,0)}var nt=function(a){Ss(r,a);function r(t){var e=a.call(this,t)||this;return e.dummyCanvas=be.Util.createCanvasElement(),e.dataArray=[],e.dataArray=St.Path.parsePathData(e.attrs.data),e.on("dataChange.konva",function(){this.dataArray=St.Path.parsePathData(this.attrs.data),this._setTextData()}),e.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva",e._setTextData),t&&t.getKerning&&(be.Util.warn('getKerning TextPath API is deprecated. Please use "kerningFunc" instead.'),e.kerningFunc(t.getKerning)),e._setTextData(),e}return r.prototype._sceneFunc=function(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();var e=this.textDecoration(),i=this.fill(),n=this.fontSize(),o=this.glyphInfo;e==="underline"&&t.beginPath();for(var s=0;s<o.length;s++){t.save();var h=o[s].p0;t.translate(h.x,h.y),t.rotate(o[s].rotation),this.partialText=o[s].text,t.fillStrokeShape(this),e==="underline"&&(s===0&&t.moveTo(0,n/2+1),t.lineTo(n,n/2+1)),t.restore()}e==="underline"&&(t.strokeStyle=i,t.lineWidth=n/20,t.stroke()),t.restore()},r.prototype._hitFunc=function(t){t.beginPath();var e=this.glyphInfo;if(e.length>=1){var i=e[0].p0;t.moveTo(i.x,i.y)}for(var n=0;n<e.length;n++){var o=e[n].p1;t.lineTo(o.x,o.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()},r.prototype.getTextWidth=function(){return this.textWidth},r.prototype.getTextHeight=function(){return be.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight},r.prototype.setText=function(t){return _i.Text.prototype.setText.call(this,t)},r.prototype._getContextFont=function(){return _i.Text.prototype._getContextFont.call(this)},r.prototype._getTextSize=function(t){var e=this.dummyCanvas,i=e.getContext("2d");i.save(),i.font=this._getContextFont();var n=i.measureText(t);return i.restore(),{width:n.width,height:parseInt(this.attrs.fontSize,10)}},r.prototype._setTextData=function(){var t=this,e=this._getTextSize(this.attrs.text),i=this.letterSpacing(),n=this.align(),o=this.kerningFunc();this.textWidth=e.width,this.textHeight=e.height;var s=Math.max(this.textWidth+((this.attrs.text||"").length-1)*i,0);this.glyphInfo=[];for(var h=0,l=0;l<t.dataArray.length;l++)t.dataArray[l].pathLength>0&&(h+=t.dataArray[l].pathLength);var u=0;n==="center"&&(u=Math.max(0,h/2-s/2)),n==="right"&&(u=Math.max(0,h-s));for(var w=this.text().split(""),O=this.text().split(" ").length-1,f,y,g,P=-1,b=0,G=function(){b=0;for(var R=t.dataArray,S=P+1;S<R.length;S++){if(R[S].pathLength>0)return P=S,R[S];R[S].command==="M"&&(f={x:R[S].points[0],y:R[S].points[1]})}return{}},d=function(R){var S=t._getTextSize(R).width+i;R===" "&&n==="justify"&&(S+=(h-s)/O);var c=0,p=0;for(y=void 0;Math.abs(S-c)/S>.01&&p<25;){p++;for(var _=c;g===void 0;)g=G(),g&&_+g.pathLength<S&&(_+=g.pathLength,g=void 0);if(g==={}||f===void 0)return;var F=!1;switch(g.command){case"L":St.Path.getLineLength(f.x,f.y,g.points[0],g.points[1])>S?y=St.Path.getPointOnLine(S,f.x,f.y,g.points[0],g.points[1],f.x,f.y):g=void 0;break;case"A":var M=g.points[4],L=g.points[5],U=g.points[4]+L;b===0?b=M+1e-8:S>c?b+=Math.PI/180*L/Math.abs(L):b-=Math.PI/360*L/Math.abs(L),(L<0&&b<U||L>=0&&b>U)&&(b=U,F=!0),y=St.Path.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],b,g.points[6]);break;case"C":b===0?S>g.pathLength?b=1e-8:b=S/g.pathLength:S>c?b+=(S-c)/g.pathLength:b-=(c-S)/g.pathLength,b>1&&(b=1,F=!0),y=St.Path.getPointOnCubicBezier(b,g.start.x,g.start.y,g.points[0],g.points[1],g.points[2],g.points[3],g.points[4],g.points[5]);break;case"Q":b===0?b=S/g.pathLength:S>c?b+=(S-c)/g.pathLength:b-=(c-S)/g.pathLength,b>1&&(b=1,F=!0),y=St.Path.getPointOnQuadraticBezier(b,g.start.x,g.start.y,g.points[0],g.points[1],g.points[2],g.points[3]);break}y!==void 0&&(c=St.Path.getLineLength(f.x,f.y,y.x,y.y)),F&&(F=!1,g=void 0)}},v="C",m=t._getTextSize(v).width+i,T=u/m-1,E=0;E<T&&(d(v),!(f===void 0||y===void 0));E++)f=y;for(var x=0;x<w.length&&(d(w[x]),!(f===void 0||y===void 0));x++){var N=St.Path.getLineLength(f.x,f.y,y.x,y.y),k=0;if(o)try{k=o(w[x-1],w[x])*this.fontSize()}catch{k=0}f.x+=k,y.x+=k,this.textWidth+=k;var A=St.Path.getPointOnLine(k+N/2,f.x,f.y,y.x,y.y),D=Math.atan2(y.y-f.y,y.x-f.x);this.glyphInfo.push({transposeX:A.x,transposeY:A.y,text:w[x],rotation:D,p0:f,p1:y}),f=y}},r.prototype.getSelfRect=function(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var t=[];this.glyphInfo.forEach(function(w){t.push(w.p0.x),t.push(w.p0.y),t.push(w.p1.x),t.push(w.p1.y)});for(var e=t[0]||0,i=t[0]||0,n=t[1]||0,o=t[1]||0,s,h,l=0;l<t.length/2;l++)s=t[l*2],h=t[l*2+1],e=Math.min(e,s),i=Math.max(i,s),n=Math.min(n,h),o=Math.max(o,h);var u=this.fontSize();return{x:e-u/2,y:n-u/2,width:i-e+u,height:o-n+u}},r}(bs.Shape);kr.TextPath=nt;nt.prototype._fillFunc=gn;nt.prototype._strokeFunc=vn;nt.prototype._fillFuncHit=gn;nt.prototype._strokeFuncHit=vn;nt.prototype.className="TextPath";nt.prototype._attrsAffectingSize=["text","fontSize","data"];Cs._registerNode(nt);_t.Factory.addGetterSetter(nt,"data");_t.Factory.addGetterSetter(nt,"fontFamily","Arial");_t.Factory.addGetterSetter(nt,"fontSize",12,fn.getNumberValidator());_t.Factory.addGetterSetter(nt,"fontStyle",pn);_t.Factory.addGetterSetter(nt,"align","left");_t.Factory.addGetterSetter(nt,"letterSpacing",0,fn.getNumberValidator());_t.Factory.addGetterSetter(nt,"textBaseline","middle");_t.Factory.addGetterSetter(nt,"fontVariant",pn);_t.Factory.addGetterSetter(nt,"text",ws);_t.Factory.addGetterSetter(nt,"textDecoration",null);_t.Factory.addGetterSetter(nt,"kerningFunc",null);be.Collection.mapMethods(nt);var Mr={},Ps=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),xe=V&&V.__assign||function(){return xe=Object.assign||function(a){for(var r,t=1,e=arguments.length;t<e;t++){r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(a[i]=r[i])}return a},xe.apply(this,arguments)};Object.defineProperty(Mr,"__esModule",{value:!0});var Z=J,et=Y,xs=rt,Ts=ot,Os=We,mi=ce,vt=X,Ht=W,As=X,Pt="tr-konva",Fs=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange"].map(function(a){return a+("."+Pt)}).join(" "),Si="nodesRect",Es=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"].map(function(a){return a+("."+Pt)}).join(" "),ks={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},Ms="ontouchstart"in vt.Konva._global;function Gs(a,r){if(a==="rotater")return"crosshair";r+=Z.Util._degToRad(ks[a]||0);var t=(Z.Util._radToDeg(r)%360+360)%360;return Z.Util._inRange(t,315+22.5,360)||Z.Util._inRange(t,0,22.5)?"ns-resize":Z.Util._inRange(t,45-22.5,45+22.5)?"nesw-resize":Z.Util._inRange(t,90-22.5,90+22.5)?"ew-resize":Z.Util._inRange(t,135-22.5,135+22.5)?"nwse-resize":Z.Util._inRange(t,180-22.5,180+22.5)?"ns-resize":Z.Util._inRange(t,225-22.5,225+22.5)?"nesw-resize":Z.Util._inRange(t,270-22.5,270+22.5)?"ew-resize":Z.Util._inRange(t,315-22.5,315+22.5)?"nwse-resize":(Z.Util.error("Transformer has unknown angle for cursor detection: "+t),"pointer")}var Te=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function Ns(a){return{x:a.x+a.width/2*Math.cos(a.rotation)+a.height/2*Math.sin(-a.rotation),y:a.y+a.height/2*Math.cos(a.rotation)+a.width/2*Math.sin(a.rotation)}}function yn(a,r,t){var e=t.x+(a.x-t.x)*Math.cos(r)-(a.y-t.y)*Math.sin(r),i=t.y+(a.x-t.x)*Math.sin(r)+(a.y-t.y)*Math.cos(r);return xe(xe({},a),{rotation:a.rotation+r,x:e,y:i})}function Rs(a,r){var t=Ns(a);return yn(a,r,t)}function Ls(a,r,t){for(var e=r,i=0;i<a.length;i++){var n=vt.Konva.getAngle(a[i]),o=Math.abs(n-r)%(Math.PI*2),s=Math.min(o,Math.PI*2-o);s<t&&(e=n)}return e}var tt=function(a){Ps(r,a);function r(t){var e=a.call(this,t)||this;return e._transforming=!1,e._createElements(),e._handleMouseMove=e._handleMouseMove.bind(e),e._handleMouseUp=e._handleMouseUp.bind(e),e.update=e.update.bind(e),e.on(Fs,e.update),e.getNode()&&e.update(),e}return r.prototype.attachTo=function(t){return this.setNode(t),this},r.prototype.setNode=function(t){return Z.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])},r.prototype.getNode=function(){return this._nodes&&this._nodes[0]},r.prototype.setNodes=function(t){var e=this;t===void 0&&(t=[]),this._nodes&&this._nodes.length&&this.detach(),this._nodes=t,t.length===1?this.rotation(t[0].rotation()):this.rotation(0),this._nodes.forEach(function(n){var o=n._attrsAffectingSize.map(function(h){return h+"Change."+Pt}).join(" "),s=function(){e._resetTransformCache(),e._transforming||e.update()};n.on(o,s),n.on(Es,s),n.on("_clearTransformCache."+Pt,s),n.on("xChange."+Pt+" yChange."+Pt,s),e._proxyDrag(n)}),this._resetTransformCache();var i=!!this.findOne(".top-left");return i&&this.update(),this},r.prototype._proxyDrag=function(t){var e=this,i;t.on("dragstart."+Pt,function(){i=t.getAbsolutePosition()}),t.on("dragmove."+Pt,function(){if(i){var n=t.getAbsolutePosition(),o=n.x-i.x,s=n.y-i.y;e.nodes().forEach(function(h){if(h!==t&&!h.isDragging()){var l=h.getAbsolutePosition();h.setAbsolutePosition({x:l.x+o,y:l.y+s}),h.startDrag()}}),i=null}})},r.prototype.getNodes=function(){return this._nodes},r.prototype.getActiveAnchor=function(){return this._movingAnchorName},r.prototype.detach=function(){this._nodes&&this._nodes.forEach(function(t){t.off("."+Pt)}),this._nodes=[],this._resetTransformCache()},r.prototype._resetTransformCache=function(){this._clearCache(Si),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")},r.prototype._getNodeRect=function(){return this._getCache(Si,this.__getNodeRect)},r.prototype.__getNodeShape=function(t,e,i){e===void 0&&(e=this.rotation());var n=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),o=t.getAbsoluteScale(i),s=t.getAbsolutePosition(i),h=n.x*o.x-t.offsetX()*o.x,l=n.y*o.y-t.offsetY()*o.y,u=(vt.Konva.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),w={x:s.x+h*Math.cos(u)+l*Math.sin(-u),y:s.y+l*Math.cos(u)+h*Math.sin(u),width:n.width*o.x,height:n.height*o.y,rotation:u};return yn(w,-vt.Konva.getAngle(e),{x:0,y:0})},r.prototype.__getNodeRect=function(){var t=this,e=this.getNode();if(!e)return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};var i=[];this.nodes().map(function(w){var O=w.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:t.ignoreStroke()}),f=[{x:O.x,y:O.y},{x:O.x+O.width,y:O.y},{x:O.x+O.width,y:O.y+O.height},{x:O.x,y:O.y+O.height}],y=w.getAbsoluteTransform();f.forEach(function(g){var P=y.point(g);i.push(P)})});var n=new Z.Transform;n.rotate(-vt.Konva.getAngle(this.rotation()));var o,s,h,l;i.forEach(function(w){var O=n.point(w);o===void 0&&(o=h=O.x,s=l=O.y),o=Math.min(o,O.x),s=Math.min(s,O.y),h=Math.max(h,O.x),l=Math.max(l,O.y)}),n.invert();var u=n.point({x:o,y:s});return{x:u.x,y:u.y,width:h-o,height:l-s,rotation:vt.Konva.getAngle(this.rotation())}},r.prototype.getX=function(){return this._getNodeRect().x},r.prototype.getY=function(){return this._getNodeRect().y},r.prototype.getWidth=function(){return this._getNodeRect().width},r.prototype.getHeight=function(){return this._getNodeRect().height},r.prototype._createElements=function(){this._createBack(),Te.forEach((function(t){this._createAnchor(t)}).bind(this)),this._createAnchor("rotater")},r.prototype._createAnchor=function(t){var e=this,i=new Os.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:Ms?10:"auto"}),n=this;i.on("mousedown touchstart",function(o){n._handleMouseDown(o)}),i.on("dragstart",function(o){i.stopDrag(),o.cancelBubble=!0}),i.on("dragend",function(o){o.cancelBubble=!0}),i.on("mouseenter",function(){var o=vt.Konva.getAngle(e.rotation()),s=Gs(t,o);i.getStage().content.style.cursor=s,e._cursorChange=!0}),i.on("mouseout",function(){i.getStage().content.style.cursor="",e._cursorChange=!1}),this.add(i)},r.prototype._createBack=function(){var t=this,e=new Ts.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc:function(i){var n=this.getParent(),o=n.padding();i.beginPath(),i.rect(-o,-o,this.width()+o*2,this.height()+o*2),i.moveTo(this.width()/2,-o),n.rotateEnabled()&&i.lineTo(this.width()/2,-n.rotateAnchorOffset()*Z.Util._sign(this.height())-o),i.fillStrokeShape(this)},hitFunc:function(i,n){if(t.shouldOverdrawWholeArea()){var o=t.padding();i.beginPath(),i.rect(-o,-o,n.width()+o*2,n.height()+o*2),i.fillStrokeShape(n)}}});this.add(e),this._proxyDrag(e)},r.prototype._handleMouseDown=function(t){this._movingAnchorName=t.target.name().split(" ")[0];var e=this._getNodeRect(),i=e.width,n=e.height,o=Math.sqrt(Math.pow(i,2)+Math.pow(n,2));this.sin=Math.abs(n/o),this.cos=Math.abs(i/o),window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0),this._transforming=!0;var s=t.target.getAbsolutePosition(),h=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:h.x-s.x,y:h.y-s.y},this._fire("transformstart",{evt:t,target:this.getNode()}),this.getNode()._fire("transformstart",{evt:t,target:this.getNode()})},r.prototype._handleMouseMove=function(t){var e,i,n,o=this.findOne("."+this._movingAnchorName),s=o.getStage();s.setPointersPositions(t);var h=s.getPointerPosition(),l={x:h.x-this._anchorDragOffset.x,y:h.y-this._anchorDragOffset.y},u=o.getAbsolutePosition();o.setAbsolutePosition(l);var w=o.getAbsolutePosition();if(!(u.x===w.x&&u.y===w.y)){if(this._movingAnchorName==="rotater"){var O=this._getNodeRect();e=o.x()-O.width/2,i=-o.y()+O.height/2;var f=Math.atan2(-i,e)+Math.PI/2;O.height<0&&(f-=Math.PI);var y=vt.Konva.getAngle(this.rotation()),g=y+f,P=vt.Konva.getAngle(this.rotationSnapTolerance()),b=Ls(this.rotationSnaps(),g,P),G=b-O.rotation,d=Rs(O,G);this._fitNodesInto(d,t);return}var v=this.keepRatio()||t.shiftKey,N=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(v){var m=N?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};n=Math.sqrt(Math.pow(m.x-o.x(),2)+Math.pow(m.y-o.y(),2));var T=this.findOne(".top-left").x()>m.x?-1:1,E=this.findOne(".top-left").y()>m.y?-1:1;e=n*this.cos*T,i=n*this.sin*E,this.findOne(".top-left").x(m.x-e),this.findOne(".top-left").y(m.y-i)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(o.y());else if(this._movingAnchorName==="top-right"){if(v){var m=N?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};n=Math.sqrt(Math.pow(o.x()-m.x,2)+Math.pow(m.y-o.y(),2));var T=this.findOne(".top-right").x()<m.x?-1:1,E=this.findOne(".top-right").y()>m.y?-1:1;e=n*this.cos*T,i=n*this.sin*E,this.findOne(".top-right").x(m.x+e),this.findOne(".top-right").y(m.y-i)}var x=o.position();this.findOne(".top-left").y(x.y),this.findOne(".bottom-right").x(x.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(o.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(o.x());else if(this._movingAnchorName==="bottom-left"){if(v){var m=N?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};n=Math.sqrt(Math.pow(m.x-o.x(),2)+Math.pow(o.y()-m.y,2));var T=m.x<o.x()?-1:1,E=o.y()<m.y?-1:1;e=n*this.cos*T,i=n*this.sin*E,o.x(m.x-e),o.y(m.y+i)}x=o.position(),this.findOne(".top-left").x(x.x),this.findOne(".bottom-right").y(x.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(o.y());else if(this._movingAnchorName==="bottom-right"){if(v){var m=N?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};n=Math.sqrt(Math.pow(o.x()-m.x,2)+Math.pow(o.y()-m.y,2));var T=this.findOne(".bottom-right").x()<m.x?-1:1,E=this.findOne(".bottom-right").y()<m.y?-1:1;e=n*this.cos*T,i=n*this.sin*E,this.findOne(".bottom-right").x(m.x+e),this.findOne(".bottom-right").y(m.y+i)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var N=this.centeredScaling()||t.altKey;if(N){var k=this.findOne(".top-left"),A=this.findOne(".bottom-right"),D=k.x(),R=k.y(),S=this.getWidth()-A.x(),c=this.getHeight()-A.y();A.move({x:-D,y:-R}),k.move({x:S,y:c})}var p=this.findOne(".top-left").getAbsolutePosition();e=p.x,i=p.y;var _=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),F=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:i,width:_,height:F,rotation:vt.Konva.getAngle(this.rotation())},t)}},r.prototype._handleMouseUp=function(t){this._removeEvents(t)},r.prototype.getAbsoluteTransform=function(){return this.getTransform()},r.prototype._removeEvents=function(t){if(this._transforming){this._transforming=!1,window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0);var e=this.getNode();this._fire("transformend",{evt:t,target:e}),e&&e.fire("transformend",{evt:t,target:e}),this._movingAnchorName=null}},r.prototype._fitNodesInto=function(t,e){var i=this,n=this._getNodeRect(),o=1;if(Z.Util._inRange(t.width,-this.padding()*2-o,o)){this.update();return}if(Z.Util._inRange(t.height,-this.padding()*2-o,o)){this.update();return}var s=new Z.Transform;if(s.rotate(vt.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){var h=s.point({x:-this.padding()*2,y:0});t.x+=h.x,t.y+=h.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){var h=s.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){var h=s.point({x:0,y:-this.padding()*2});t.x+=h.x,t.y+=h.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){var h=s.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){var l=this.boundBoxFunc()(n,t);l?t=l:Z.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}var u=1e7,w=new Z.Transform;w.translate(n.x,n.y),w.rotate(n.rotation),w.scale(n.width/u,n.height/u);var O=new Z.Transform;O.translate(t.x,t.y),O.rotate(t.rotation),O.scale(t.width/u,t.height/u);var f=O.multiply(w.invert());this._nodes.forEach(function(y){var g=y.getParent().getAbsoluteTransform(),P=y.getTransform().copy();P.translate(y.offsetX(),y.offsetY());var b=new Z.Transform;b.multiply(g.copy().invert()).multiply(f).multiply(g).multiply(P);var G=b.decompose();y._batchTransformChanges(function(){y.setAttrs(G)}),i._fire("transform",{evt:e,target:y}),y._fire("transform",{evt:e,target:y})}),this.rotation(Z.Util._getRotation(t.rotation)),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()},r.prototype.forceUpdate=function(){this._resetTransformCache(),this.update()},r.prototype._batchChangeChild=function(t,e){var i=this.findOne(t);i._batchTransformChanges(function(){i.setAttrs(e)})},r.prototype.update=function(){var t=this,e=this._getNodeRect();this.rotation(Z.Util._getRotation(e.rotation));var i=e.width,n=e.height,o=this.enabledAnchors(),s=this.resizeEnabled(),h=this.padding(),l=this.anchorSize();this.find("._anchor").each(function(u){u._batchTransformChanges(function(){u.setAttrs({width:l,height:l,offsetX:l/2,offsetY:l/2,stroke:t.anchorStroke(),strokeWidth:t.anchorStrokeWidth(),fill:t.anchorFill(),cornerRadius:t.anchorCornerRadius()})})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:l/2+h,offsetY:l/2+h,visible:s&&o.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:i/2,y:0,offsetY:l/2+h,visible:s&&o.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:i,y:0,offsetX:l/2-h,offsetY:l/2+h,visible:s&&o.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:n/2,offsetX:l/2+h,visible:s&&o.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:i,y:n/2,offsetX:l/2-h,visible:s&&o.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:n,offsetX:l/2+h,offsetY:l/2-h,visible:s&&o.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:i/2,y:n,offsetY:l/2-h,visible:s&&o.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:i,y:n,offsetX:l/2-h,offsetY:l/2-h,visible:s&&o.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:i/2,y:-this.rotateAnchorOffset()*Z.Util._sign(n)-h,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:i,height:n,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0})},r.prototype.isTransforming=function(){return this._transforming},r.prototype.stopTransform=function(){if(this._transforming){this._removeEvents();var t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}},r.prototype.destroy=function(){return this.getStage()&&this._cursorChange&&(this.getStage().content.style.cursor=""),mi.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this},r.prototype.toObject=function(){return xs.Node.prototype.toObject.call(this)},r}(mi.Group);Mr.Transformer=tt;function Ds(a){return a instanceof Array||Z.Util.warn("enabledAnchors value should be an array"),a instanceof Array&&a.forEach(function(r){Te.indexOf(r)===-1&&Z.Util.warn("Unknown anchor name: "+r+". Available names are: "+Te.join(", "))}),a||[]}tt.prototype.className="Transformer";As._registerNode(tt);et.Factory.addGetterSetter(tt,"enabledAnchors",Te,Ds);et.Factory.addGetterSetter(tt,"resizeEnabled",!0);et.Factory.addGetterSetter(tt,"anchorSize",10,Ht.getNumberValidator());et.Factory.addGetterSetter(tt,"rotateEnabled",!0);et.Factory.addGetterSetter(tt,"rotationSnaps",[]);et.Factory.addGetterSetter(tt,"rotateAnchorOffset",50,Ht.getNumberValidator());et.Factory.addGetterSetter(tt,"rotationSnapTolerance",5,Ht.getNumberValidator());et.Factory.addGetterSetter(tt,"borderEnabled",!0);et.Factory.addGetterSetter(tt,"anchorStroke","rgb(0, 161, 255)");et.Factory.addGetterSetter(tt,"anchorStrokeWidth",1,Ht.getNumberValidator());et.Factory.addGetterSetter(tt,"anchorFill","white");et.Factory.addGetterSetter(tt,"anchorCornerRadius",0,Ht.getNumberValidator());et.Factory.addGetterSetter(tt,"borderStroke","rgb(0, 161, 255)");et.Factory.addGetterSetter(tt,"borderStrokeWidth",1,Ht.getNumberValidator());et.Factory.addGetterSetter(tt,"borderDash");et.Factory.addGetterSetter(tt,"keepRatio",!0);et.Factory.addGetterSetter(tt,"centeredScaling",!1);et.Factory.addGetterSetter(tt,"ignoreStroke",!1);et.Factory.addGetterSetter(tt,"padding",0,Ht.getNumberValidator());et.Factory.addGetterSetter(tt,"node");et.Factory.addGetterSetter(tt,"nodes");et.Factory.addGetterSetter(tt,"boundBoxFunc");et.Factory.addGetterSetter(tt,"shouldOverdrawWholeArea",!1);et.Factory.backCompat(tt,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});Z.Collection.mapMethods(tt);var Gr={},Is=V&&V.__extends||function(){var a=function(r,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},a(r,t)};return function(r,t){a(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(Gr,"__esModule",{value:!0});var Us=J,Ke=Y,$s=ot,Bs=X,_n=W,Vs=X,wt=function(a){Is(r,a);function r(){return a!==null&&a.apply(this,arguments)||this}return r.prototype._sceneFunc=function(t){t.beginPath(),t.arc(0,0,this.radius(),0,Bs.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)},r.prototype.getWidth=function(){return this.radius()*2},r.prototype.getHeight=function(){return this.radius()*2},r.prototype.setWidth=function(t){this.radius(t/2)},r.prototype.setHeight=function(t){this.radius(t/2)},r}($s.Shape);Gr.Wedge=wt;wt.prototype.className="Wedge";wt.prototype._centroid=!0;wt.prototype._attrsAffectingSize=["radius"];Vs._registerNode(wt);Ke.Factory.addGetterSetter(wt,"radius",0,_n.getNumberValidator());Ke.Factory.addGetterSetter(wt,"angle",0,_n.getNumberValidator());Ke.Factory.addGetterSetter(wt,"clockwise",!1);Ke.Factory.backCompat(wt,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});Us.Collection.mapMethods(wt);var Nr={};Object.defineProperty(Nr,"__esModule",{value:!0});var bi=Y,Hs=rt,zs=W;function Ci(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var Ws=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],js=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function Ks(a,r){var t=a.data,e=a.width,i=a.height,n,o,s,h,l,u,w,O,f,y,g,P,b,G,d,v,m,T,E,x,N,k,A,D,R=r+r+1,S=e-1,c=i-1,p=r+1,_=p*(p+1)/2,F=new Ci,M=null,L=F,U=null,B=null,z=Ws[r],K=js[r];for(s=1;s<R;s++)L=L.next=new Ci,s===p&&(M=L);for(L.next=F,w=u=0,o=0;o<i;o++){for(v=m=T=E=O=f=y=g=0,P=p*(x=t[u]),b=p*(N=t[u+1]),G=p*(k=t[u+2]),d=p*(A=t[u+3]),O+=_*x,f+=_*N,y+=_*k,g+=_*A,L=F,s=0;s<p;s++)L.r=x,L.g=N,L.b=k,L.a=A,L=L.next;for(s=1;s<p;s++)h=u+((S<s?S:s)<<2),O+=(L.r=x=t[h])*(D=p-s),f+=(L.g=N=t[h+1])*D,y+=(L.b=k=t[h+2])*D,g+=(L.a=A=t[h+3])*D,v+=x,m+=N,T+=k,E+=A,L=L.next;for(U=F,B=M,n=0;n<e;n++)t[u+3]=A=g*z>>K,A!==0?(A=255/A,t[u]=(O*z>>K)*A,t[u+1]=(f*z>>K)*A,t[u+2]=(y*z>>K)*A):t[u]=t[u+1]=t[u+2]=0,O-=P,f-=b,y-=G,g-=d,P-=U.r,b-=U.g,G-=U.b,d-=U.a,h=w+((h=n+r+1)<S?h:S)<<2,v+=U.r=t[h],m+=U.g=t[h+1],T+=U.b=t[h+2],E+=U.a=t[h+3],O+=v,f+=m,y+=T,g+=E,U=U.next,P+=x=B.r,b+=N=B.g,G+=k=B.b,d+=A=B.a,v-=x,m-=N,T-=k,E-=A,B=B.next,u+=4;w+=e}for(n=0;n<e;n++){for(m=T=E=v=f=y=g=O=0,u=n<<2,P=p*(x=t[u]),b=p*(N=t[u+1]),G=p*(k=t[u+2]),d=p*(A=t[u+3]),O+=_*x,f+=_*N,y+=_*k,g+=_*A,L=F,s=0;s<p;s++)L.r=x,L.g=N,L.b=k,L.a=A,L=L.next;for(l=e,s=1;s<=r;s++)u=l+n<<2,O+=(L.r=x=t[u])*(D=p-s),f+=(L.g=N=t[u+1])*D,y+=(L.b=k=t[u+2])*D,g+=(L.a=A=t[u+3])*D,v+=x,m+=N,T+=k,E+=A,L=L.next,s<c&&(l+=e);for(u=n,U=F,B=M,o=0;o<i;o++)h=u<<2,t[h+3]=A=g*z>>K,A>0?(A=255/A,t[h]=(O*z>>K)*A,t[h+1]=(f*z>>K)*A,t[h+2]=(y*z>>K)*A):t[h]=t[h+1]=t[h+2]=0,O-=P,f-=b,y-=G,g-=d,P-=U.r,b-=U.g,G-=U.b,d-=U.a,h=n+((h=o+p)<c?h:c)*e<<2,O+=v+=U.r=t[h],f+=m+=U.g=t[h+1],y+=T+=U.b=t[h+2],g+=E+=U.a=t[h+3],U=U.next,P+=x=B.r,b+=N=B.g,G+=k=B.b,d+=A=B.a,v-=x,m-=N,T-=k,E-=A,B=B.next,u+=e}}Nr.Blur=function(r){var t=Math.round(this.blurRadius());t>0&&Ks(r,t)};bi.Factory.addGetterSetter(Hs.Node,"blurRadius",0,zs.getNumberValidator(),bi.Factory.afterSetFilter);var Rr={};Object.defineProperty(Rr,"__esModule",{value:!0});var wi=Y,Ys=rt,Xs=W;Rr.Brighten=function(a){var r=this.brightness()*255,t=a.data,e=t.length,i;for(i=0;i<e;i+=4)t[i]+=r,t[i+1]+=r,t[i+2]+=r};wi.Factory.addGetterSetter(Ys.Node,"brightness",0,Xs.getNumberValidator(),wi.Factory.afterSetFilter);var Lr={};Object.defineProperty(Lr,"__esModule",{value:!0});var Pi=Y,qs=rt,Js=W;Lr.Contrast=function(a){var r=Math.pow((this.contrast()+100)/100,2),t=a.data,e=t.length,i=150,n=150,o=150,s;for(s=0;s<e;s+=4)i=t[s],n=t[s+1],o=t[s+2],i/=255,i-=.5,i*=r,i+=.5,i*=255,n/=255,n-=.5,n*=r,n+=.5,n*=255,o/=255,o-=.5,o*=r,o+=.5,o*=255,i=i<0?0:i>255?255:i,n=n<0?0:n>255?255:n,o=o<0?0:o>255?255:o,t[s]=i,t[s+1]=n,t[s+2]=o};Pi.Factory.addGetterSetter(qs.Node,"contrast",0,Js.getNumberValidator(),Pi.Factory.afterSetFilter);var Dr={};Object.defineProperty(Dr,"__esModule",{value:!0});var Ft=Y,Ye=rt,Qs=J,mn=W;Dr.Emboss=function(a){var r=this.embossStrength()*10,t=this.embossWhiteLevel()*255,e=this.embossDirection(),i=this.embossBlend(),n=0,o=0,s=a.data,h=a.width,l=a.height,u=h*4,w=l;switch(e){case"top-left":n=-1,o=-1;break;case"top":n=-1,o=0;break;case"top-right":n=-1,o=1;break;case"right":n=0,o=1;break;case"bottom-right":n=1,o=1;break;case"bottom":n=1,o=0;break;case"bottom-left":n=1,o=-1;break;case"left":n=0,o=-1;break;default:Qs.Util.error("Unknown emboss direction: "+e)}do{var O=(w-1)*u,f=n;w+f<1&&(f=0),w+f>l&&(f=0);var y=(w-1+f)*h*4,g=h;do{var P=O+(g-1)*4,b=o;g+b<1&&(b=0),g+b>h&&(b=0);var G=y+(g-1+b)*4,d=s[P]-s[G],v=s[P+1]-s[G+1],m=s[P+2]-s[G+2],T=d,E=T>0?T:-T,x=v>0?v:-v,N=m>0?m:-m;if(x>E&&(T=v),N>E&&(T=m),T*=r,i){var k=s[P]+T,A=s[P+1]+T,D=s[P+2]+T;s[P]=k>255?255:k<0?0:k,s[P+1]=A>255?255:A<0?0:A,s[P+2]=D>255?255:D<0?0:D}else{var R=t-T;R<0?R=0:R>255&&(R=255),s[P]=s[P+1]=s[P+2]=R}}while(--g)}while(--w)};Ft.Factory.addGetterSetter(Ye.Node,"embossStrength",.5,mn.getNumberValidator(),Ft.Factory.afterSetFilter);Ft.Factory.addGetterSetter(Ye.Node,"embossWhiteLevel",.5,mn.getNumberValidator(),Ft.Factory.afterSetFilter);Ft.Factory.addGetterSetter(Ye.Node,"embossDirection","top-left",null,Ft.Factory.afterSetFilter);Ft.Factory.addGetterSetter(Ye.Node,"embossBlend",!1,null,Ft.Factory.afterSetFilter);var Ir={};Object.defineProperty(Ir,"__esModule",{value:!0});var xi=Y,Zs=rt,th=W;function rr(a,r,t,e,i){var n=t-r,o=i-e,s;return n===0?e+o/2:o===0?e:(s=(a-r)/n,s=o*s+e,s)}Ir.Enhance=function(a){var r=a.data,t=r.length,e=r[0],i=e,n,o=r[1],s=o,h,l=r[2],u=l,w,O,f=this.enhance();if(f!==0){for(O=0;O<t;O+=4)n=r[O+0],n<e?e=n:n>i&&(i=n),h=r[O+1],h<o?o=h:h>s&&(s=h),w=r[O+2],w<l?l=w:w>u&&(u=w);i===e&&(i=255,e=0),s===o&&(s=255,o=0),u===l&&(u=255,l=0);var y,g,P,b,G,d,v,m,T;for(f>0?(g=i+f*(255-i),P=e-f*(e-0),G=s+f*(255-s),d=o-f*(o-0),m=u+f*(255-u),T=l-f*(l-0)):(y=(i+e)*.5,g=i+f*(i-y),P=e+f*(e-y),b=(s+o)*.5,G=s+f*(s-b),d=o+f*(o-b),v=(u+l)*.5,m=u+f*(u-v),T=l+f*(l-v)),O=0;O<t;O+=4)r[O+0]=rr(r[O+0],e,i,P,g),r[O+1]=rr(r[O+1],o,s,d,G),r[O+2]=rr(r[O+2],l,u,T,m)}};xi.Factory.addGetterSetter(Zs.Node,"enhance",0,th.getNumberValidator(),xi.Factory.afterSetFilter);var Ur={};Object.defineProperty(Ur,"__esModule",{value:!0});Ur.Grayscale=function(a){var r=a.data,t=r.length,e,i;for(e=0;e<t;e+=4)i=.34*r[e]+.5*r[e+1]+.16*r[e+2],r[e]=i,r[e+1]=i,r[e+2]=i};var $r={};Object.defineProperty($r,"__esModule",{value:!0});var Kt=Y,Br=rt,Vr=W;Kt.Factory.addGetterSetter(Br.Node,"hue",0,Vr.getNumberValidator(),Kt.Factory.afterSetFilter);Kt.Factory.addGetterSetter(Br.Node,"saturation",0,Vr.getNumberValidator(),Kt.Factory.afterSetFilter);Kt.Factory.addGetterSetter(Br.Node,"luminance",0,Vr.getNumberValidator(),Kt.Factory.afterSetFilter);$r.HSL=function(a){var r=a.data,t=r.length,e=1,i=Math.pow(2,this.saturation()),n=Math.abs(this.hue()+360)%360,o=this.luminance()*127,s,h=e*i*Math.cos(n*Math.PI/180),l=e*i*Math.sin(n*Math.PI/180),u=.299*e+.701*h+.167*l,w=.587*e-.587*h+.33*l,O=.114*e-.114*h-.497*l,f=.299*e-.299*h-.328*l,y=.587*e+.413*h+.035*l,g=.114*e-.114*h+.293*l,P=.299*e-.3*h+1.25*l,b=.587*e-.586*h-1.05*l,G=.114*e+.886*h-.2*l,d,v,m,T;for(s=0;s<t;s+=4)d=r[s+0],v=r[s+1],m=r[s+2],T=r[s+3],r[s+0]=u*d+w*v+O*m+o,r[s+1]=f*d+y*v+g*m+o,r[s+2]=P*d+b*v+G*m+o,r[s+3]=T};var Hr={};Object.defineProperty(Hr,"__esModule",{value:!0});var Yt=Y,zr=rt,Wr=W;Hr.HSV=function(a){var r=a.data,t=r.length,e=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),n=Math.abs(this.hue()+360)%360,o,s=e*i*Math.cos(n*Math.PI/180),h=e*i*Math.sin(n*Math.PI/180),l=.299*e+.701*s+.167*h,u=.587*e-.587*s+.33*h,w=.114*e-.114*s-.497*h,O=.299*e-.299*s-.328*h,f=.587*e+.413*s+.035*h,y=.114*e-.114*s+.293*h,g=.299*e-.3*s+1.25*h,P=.587*e-.586*s-1.05*h,b=.114*e+.886*s-.2*h,G,d,v,m;for(o=0;o<t;o+=4)G=r[o+0],d=r[o+1],v=r[o+2],m=r[o+3],r[o+0]=l*G+u*d+w*v,r[o+1]=O*G+f*d+y*v,r[o+2]=g*G+P*d+b*v,r[o+3]=m};Yt.Factory.addGetterSetter(zr.Node,"hue",0,Wr.getNumberValidator(),Yt.Factory.afterSetFilter);Yt.Factory.addGetterSetter(zr.Node,"saturation",0,Wr.getNumberValidator(),Yt.Factory.afterSetFilter);Yt.Factory.addGetterSetter(zr.Node,"value",0,Wr.getNumberValidator(),Yt.Factory.afterSetFilter);var jr={};Object.defineProperty(jr,"__esModule",{value:!0});jr.Invert=function(a){var r=a.data,t=r.length,e;for(e=0;e<t;e+=4)r[e]=255-r[e],r[e+1]=255-r[e+1],r[e+2]=255-r[e+2]};var Kr={};Object.defineProperty(Kr,"__esModule",{value:!0});var Oe=Y,Sn=rt,eh=J,bn=W,rh=function(a,r,t){var e=a.data,i=r.data,n=a.width,o=a.height,s=t.polarCenterX||n/2,h=t.polarCenterY||o/2,l,u,w,O=0,f=0,y=0,g=0,P,b=Math.sqrt(s*s+h*h);u=n-s,w=o-h,P=Math.sqrt(u*u+w*w),b=P>b?P:b;var G=o,d=n,v,m,T=360/d*Math.PI/180,E,x;for(m=0;m<d;m+=1)for(E=Math.sin(m*T),x=Math.cos(m*T),v=0;v<G;v+=1)u=Math.floor(s+b*v/G*x),w=Math.floor(h+b*v/G*E),l=(w*n+u)*4,O=e[l+0],f=e[l+1],y=e[l+2],g=e[l+3],l=(m+v*n)*4,i[l+0]=O,i[l+1]=f,i[l+2]=y,i[l+3]=g},ih=function(a,r,t){var e=a.data,i=r.data,n=a.width,o=a.height,s=t.polarCenterX||n/2,h=t.polarCenterY||o/2,l,u,w,O,f,y=0,g=0,P=0,b=0,G,d=Math.sqrt(s*s+h*h);u=n-s,w=o-h,G=Math.sqrt(u*u+w*w),d=G>d?G:d;var v=o,m=n,T,E,x=0,N,k;for(u=0;u<n;u+=1)for(w=0;w<o;w+=1)O=u-s,f=w-h,T=Math.sqrt(O*O+f*f)*v/d,E=(Math.atan2(f,O)*180/Math.PI+360+x)%360,E=E*m/360,N=Math.floor(E),k=Math.floor(T),l=(k*n+N)*4,y=e[l+0],g=e[l+1],P=e[l+2],b=e[l+3],l=(w*n+u)*4,i[l+0]=y,i[l+1]=g,i[l+2]=P,i[l+3]=b};Kr.Kaleidoscope=function(a){var r=a.width,t=a.height,e,i,n,o,s,h,l,u,w,O,f=Math.round(this.kaleidoscopePower()),y=Math.round(this.kaleidoscopeAngle()),g=Math.floor(r*(y%360)/360);if(!(f<1)){var P=eh.Util.createCanvasElement();P.width=r,P.height=t;var b=P.getContext("2d").getImageData(0,0,r,t);rh(a,b,{polarCenterX:r/2,polarCenterY:t/2});for(var G=r/Math.pow(2,f);G<=8;)G=G*2,f-=1;G=Math.ceil(G);var d=G,v=0,m=d,T=1;for(g+G>r&&(v=d,m=0,T=-1),i=0;i<t;i+=1)for(e=v;e!==m;e+=T)n=Math.round(e+g)%r,w=(r*i+n)*4,s=b.data[w+0],h=b.data[w+1],l=b.data[w+2],u=b.data[w+3],O=(r*i+e)*4,b.data[O+0]=s,b.data[O+1]=h,b.data[O+2]=l,b.data[O+3]=u;for(i=0;i<t;i+=1)for(d=Math.floor(G),o=0;o<f;o+=1){for(e=0;e<d+1;e+=1)w=(r*i+e)*4,s=b.data[w+0],h=b.data[w+1],l=b.data[w+2],u=b.data[w+3],O=(r*i+d*2-e-1)*4,b.data[O+0]=s,b.data[O+1]=h,b.data[O+2]=l,b.data[O+3]=u;d*=2}ih(b,a,{})}};Oe.Factory.addGetterSetter(Sn.Node,"kaleidoscopePower",2,bn.getNumberValidator(),Oe.Factory.afterSetFilter);Oe.Factory.addGetterSetter(Sn.Node,"kaleidoscopeAngle",0,bn.getNumberValidator(),Oe.Factory.afterSetFilter);var Yr={};Object.defineProperty(Yr,"__esModule",{value:!0});var Ti=Y,nh=rt,ah=W;function me(a,r,t){var e=(t*a.width+r)*4,i=[];return i.push(a.data[e++],a.data[e++],a.data[e++],a.data[e++]),i}function re(a,r){return Math.sqrt(Math.pow(a[0]-r[0],2)+Math.pow(a[1]-r[1],2)+Math.pow(a[2]-r[2],2))}function oh(a){for(var r=[0,0,0],t=0;t<a.length;t++)r[0]+=a[t][0],r[1]+=a[t][1],r[2]+=a[t][2];return r[0]/=a.length,r[1]/=a.length,r[2]/=a.length,r}function sh(a,r){var t=me(a,0,0),e=me(a,a.width-1,0),i=me(a,0,a.height-1),n=me(a,a.width-1,a.height-1),o=r||10;if(re(t,e)<o&&re(e,n)<o&&re(n,i)<o&&re(i,t)<o){for(var s=oh([e,t,n,i]),h=[],l=0;l<a.width*a.height;l++){var u=re(s,[a.data[l*4],a.data[l*4+1],a.data[l*4+2]]);h[l]=u<o?0:255}return h}}function hh(a,r){for(var t=0;t<a.width*a.height;t++)a.data[4*t+3]=r[t]}function lh(a,r,t){for(var e=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(e.length)),n=Math.floor(i/2),o=[],s=0;s<t;s++)for(var h=0;h<r;h++){for(var l=s*r+h,u=0,w=0;w<i;w++)for(var O=0;O<i;O++){var f=s+w-n,y=h+O-n;if(f>=0&&f<t&&y>=0&&y<r){var g=f*r+y,P=e[w*i+O];u+=a[g]*P}}o[l]=u===255*8?255:0}return o}function dh(a,r,t){for(var e=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(e.length)),n=Math.floor(i/2),o=[],s=0;s<t;s++)for(var h=0;h<r;h++){for(var l=s*r+h,u=0,w=0;w<i;w++)for(var O=0;O<i;O++){var f=s+w-n,y=h+O-n;if(f>=0&&f<t&&y>=0&&y<r){var g=f*r+y,P=e[w*i+O];u+=a[g]*P}}o[l]=u>=255*4?255:0}return o}function ch(a,r,t){for(var e=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(e.length)),n=Math.floor(i/2),o=[],s=0;s<t;s++)for(var h=0;h<r;h++){for(var l=s*r+h,u=0,w=0;w<i;w++)for(var O=0;O<i;O++){var f=s+w-n,y=h+O-n;if(f>=0&&f<t&&y>=0&&y<r){var g=f*r+y,P=e[w*i+O];u+=a[g]*P}}o[l]=u}return o}Yr.Mask=function(a){var r=this.threshold(),t=sh(a,r);return t&&(t=lh(t,a.width,a.height),t=dh(t,a.width,a.height),t=ch(t,a.width,a.height),hh(a,t)),a};Ti.Factory.addGetterSetter(nh.Node,"threshold",0,ah.getNumberValidator(),Ti.Factory.afterSetFilter);var Xr={};Object.defineProperty(Xr,"__esModule",{value:!0});var Oi=Y,uh=rt,fh=W;Xr.Noise=function(a){var r=this.noise()*255,t=a.data,e=t.length,i=r/2,n;for(n=0;n<e;n+=4)t[n+0]+=i-2*i*Math.random(),t[n+1]+=i-2*i*Math.random(),t[n+2]+=i-2*i*Math.random()};Oi.Factory.addGetterSetter(uh.Node,"noise",.2,fh.getNumberValidator(),Oi.Factory.afterSetFilter);var qr={};Object.defineProperty(qr,"__esModule",{value:!0});var Ai=Y,ph=J,gh=rt,vh=W;qr.Pixelate=function(a){var r=Math.ceil(this.pixelSize()),t=a.width,e=a.height,i,n,o,s,h,l,u,w=Math.ceil(t/r),O=Math.ceil(e/r),f,y,g,P,b,G,d,v=a.data;if(r<=0){ph.Util.error("pixelSize value can not be <= 0");return}for(b=0;b<w;b+=1)for(G=0;G<O;G+=1){for(s=0,h=0,l=0,u=0,f=b*r,y=f+r,g=G*r,P=g+r,d=0,i=f;i<y;i+=1)if(!(i>=t))for(n=g;n<P;n+=1)n>=e||(o=(t*n+i)*4,s+=v[o+0],h+=v[o+1],l+=v[o+2],u+=v[o+3],d+=1);for(s=s/d,h=h/d,l=l/d,u=u/d,i=f;i<y;i+=1)if(!(i>=t))for(n=g;n<P;n+=1)n>=e||(o=(t*n+i)*4,v[o+0]=s,v[o+1]=h,v[o+2]=l,v[o+3]=u)}};Ai.Factory.addGetterSetter(gh.Node,"pixelSize",8,vh.getNumberValidator(),Ai.Factory.afterSetFilter);var Jr={};Object.defineProperty(Jr,"__esModule",{value:!0});var Fi=Y,yh=rt,_h=W;Jr.Posterize=function(a){var r=Math.round(this.levels()*254)+1,t=a.data,e=t.length,i=255/r,n;for(n=0;n<e;n+=1)t[n]=Math.floor(t[n]/i)*i};Fi.Factory.addGetterSetter(yh.Node,"levels",.5,_h.getNumberValidator(),Fi.Factory.afterSetFilter);var Qr={};Object.defineProperty(Qr,"__esModule",{value:!0});var Ae=Y,Zr=rt,mh=W;Qr.RGB=function(a){var r=a.data,t=r.length,e=this.red(),i=this.green(),n=this.blue(),o,s;for(o=0;o<t;o+=4)s=(.34*r[o]+.5*r[o+1]+.16*r[o+2])/255,r[o]=s*e,r[o+1]=s*i,r[o+2]=s*n,r[o+3]=r[o+3]};Ae.Factory.addGetterSetter(Zr.Node,"red",0,function(a){return this._filterUpToDate=!1,a>255?255:a<0?0:Math.round(a)});Ae.Factory.addGetterSetter(Zr.Node,"green",0,function(a){return this._filterUpToDate=!1,a>255?255:a<0?0:Math.round(a)});Ae.Factory.addGetterSetter(Zr.Node,"blue",0,mh.RGBComponent,Ae.Factory.afterSetFilter);var ti={};Object.defineProperty(ti,"__esModule",{value:!0});var se=Y,Xe=rt,Sh=W;ti.RGBA=function(a){var r=a.data,t=r.length,e=this.red(),i=this.green(),n=this.blue(),o=this.alpha(),s,h;for(s=0;s<t;s+=4)h=1-o,r[s]=e*o+r[s]*h,r[s+1]=i*o+r[s+1]*h,r[s+2]=n*o+r[s+2]*h};se.Factory.addGetterSetter(Xe.Node,"red",0,function(a){return this._filterUpToDate=!1,a>255?255:a<0?0:Math.round(a)});se.Factory.addGetterSetter(Xe.Node,"green",0,function(a){return this._filterUpToDate=!1,a>255?255:a<0?0:Math.round(a)});se.Factory.addGetterSetter(Xe.Node,"blue",0,Sh.RGBComponent,se.Factory.afterSetFilter);se.Factory.addGetterSetter(Xe.Node,"alpha",1,function(a){return this._filterUpToDate=!1,a>1?1:a<0?0:a});var ei={};Object.defineProperty(ei,"__esModule",{value:!0});ei.Sepia=function(a){var r=a.data,t=r.length,e,i,n,o;for(e=0;e<t;e+=4)i=r[e+0],n=r[e+1],o=r[e+2],r[e+0]=Math.min(255,i*.393+n*.769+o*.189),r[e+1]=Math.min(255,i*.349+n*.686+o*.168),r[e+2]=Math.min(255,i*.272+n*.534+o*.131)};var ri={};Object.defineProperty(ri,"__esModule",{value:!0});ri.Solarize=function(a){var r=a.data,t=a.width,e=a.height,i=t*4,n=e;do{var o=(n-1)*i,s=t;do{var h=o+(s-1)*4,l=r[h],u=r[h+1],w=r[h+2];l>127&&(l=255-l),u>127&&(u=255-u),w>127&&(w=255-w),r[h]=l,r[h+1]=u,r[h+2]=w}while(--s)}while(--n)};var ii={};Object.defineProperty(ii,"__esModule",{value:!0});var Ei=Y,bh=rt,Ch=W;ii.Threshold=function(a){var r=this.threshold()*255,t=a.data,e=t.length,i;for(i=0;i<e;i+=1)t[i]=t[i]<r?0:255};Ei.Factory.addGetterSetter(bh.Node,"threshold",.5,Ch.getNumberValidator(),Ei.Factory.afterSetFilter);Object.defineProperty(ur,"__esModule",{value:!0});var ki=fr,wh=yr,Ph=_r,xh=Sr,Th=br,Oh=wr,Mi=Be,Ah=Ie,Fh=ze,Eh=We,kh=xr,Mh=Tr,Gh=Or,Nh=Ar,Rh=je,Lh=kr,Dh=Mr,Ih=Gr,Uh=Nr,$h=Rr,Bh=Lr,Vh=Dr,Hh=Ir,zh=Ur,Wh=$r,jh=Hr,Kh=jr,Yh=Kr,Xh=Yr,qh=Xr,Jh=qr,Qh=Jr,Zh=Qr,tl=ti,el=ei,rl=ri,il=ii;ur.Konva=ki.Konva.Util._assign(ki.Konva,{Arc:wh.Arc,Arrow:Ph.Arrow,Circle:xh.Circle,Ellipse:Th.Ellipse,Image:Oh.Image,Label:Mi.Label,Tag:Mi.Tag,Line:Ah.Line,Path:Fh.Path,Rect:Eh.Rect,RegularPolygon:kh.RegularPolygon,Ring:Mh.Ring,Sprite:Gh.Sprite,Star:Nh.Star,Text:Rh.Text,TextPath:Lh.TextPath,Transformer:Dh.Transformer,Wedge:Ih.Wedge,Filters:{Blur:Uh.Blur,Brighten:$h.Brighten,Contrast:Bh.Contrast,Emboss:Vh.Emboss,Enhance:Hh.Enhance,Grayscale:zh.Grayscale,HSL:Wh.HSL,HSV:jh.HSV,Invert:Kh.Invert,Kaleidoscope:Yh.Kaleidoscope,Mask:Xh.Mask,Noise:qh.Noise,Pixelate:Jh.Pixelate,Posterize:Qh.Posterize,RGB:Zh.RGB,RGBA:tl.RGBA,Sepia:el.Sepia,Solarize:rl.Solarize,Threshold:il.Threshold}});(function(a,r){var t=ur.Konva;t._injectGlobal(t),r.default=t,a.exports=r.default})(nr,nr.exports);var nl=nr.exports;const ut=Bn(nl),al="/splitfair-app/assets/ShareCanvas-B8MwIIrl.css",Cn="#D9E4EA",ol="#333333",Ce=3,ir=414,Gi=788,Fe=84,jt=126,ae=24,qe={stroke:Cn,strokeWidth:2,cornerRadius:9},Se={fontSize:ae,fontFamily:"Helvetica",fill:Cn,align:"center"},we={...qe,width:85,height:jt},Ni={...qe,width:173,height:Fe},Ri={...qe,width:230,height:Fe},Li={...qe,width:228,height:jt,x:we.width+8,y:Ce};class sl extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.firstPerson={name:"",salary:""},this.secondPerson={name:"person 1",salary:""},this.expenses="0",this.currency="$",this.stage=null,this.layer=null}static get observedAttributes(){return["first-person","second-person","expenses","currency"]}attributeChangedCallback(r,t,e){r==="first-person"?this.firstPerson=JSON.parse(e):r==="second-person"?this.secondPerson=JSON.parse(e):r==="expenses"?this.expenses=e:r==="currency"&&(this.currency=e),this.stage&&this.draw()}connectedCallback(){this.render(),this.initCanvas()}render(){this.shadowRoot.innerHTML=`
      <link rel="stylesheet" href="${al}">
      <div class="ShareCanvas"></div>
    `}initCanvas(){const r=this.shadowRoot.querySelector(".ShareCanvas");this.stage=new ut.Stage({container:r,width:ir,height:Gi}),this.layer=new ut.Layer,this.stage.add(this.layer);const t=new ut.Rect({x:0,y:0,width:ir,height:Gi,fill:ol});this.layer.add(t),this.drawHeader(),this.drawRow1(),this.drawRow2(),this.layer.draw()}drawHeader(){const r=new ut.Rect({...we,x:Ce,y:Ce}),t=new ut.Rect(Li),e=new ut.Rect({...we,x:we.width+Li.width+13,y:Ce});ut.Image.fromURL("/splitfair-app/img/logo.ea9ec231.svg",i=>{i.setAttrs({x:ir/2-20,y:35,scaleX:1}),this.layer.add(i),this.layer.draw()}),this.layer.add(r),this.layer.add(t),this.layer.add(e)}drawRow1(){const r={...Ni,x:3,y:jt+8},t={...Ri,x:r.width+8,y:jt+8},e={...Se,width:r.width,height:r.height,x:r.x,y:r.y+r.height/2-ae/2,text:this.firstPerson.name},i={...Se,width:t.width,height:t.height,x:t.x,y:t.y+t.height/2-ae/2,text:`${this.currency}${this.firstPerson.salary}`};this.layer.add(new ut.Rect(r)),this.layer.add(new ut.Rect(t)),this.layer.add(new ut.Text(e)),this.layer.add(new ut.Text(i))}drawRow2(){const r={...Ni,x:3,y:jt+8+Fe+5},t={...Ri,x:r.width+8,y:jt+8+Fe+5},e={...Se,width:r.width,height:r.height,x:r.x,y:r.y+r.height/2-ae/2,text:this.secondPerson.name},i={...Se,width:t.width,height:t.height,x:t.x,y:t.y+t.height/2-ae/2,text:`${this.currency}${this.secondPerson.salary}`};this.layer.add(new ut.Rect(r)),this.layer.add(new ut.Rect(t)),this.layer.add(new ut.Text(e)),this.layer.add(new ut.Text(i))}draw(){this.layer.draw()}}customElements.define("share-canvas",sl);const hl={state:{firstPerson:{name:"person 1",salary:0,percent:0,total:0},secondPerson:{name:"person 2",salary:0,percent:0,total:0},currency:"",sumOfDebts:0,basePercentage:0},mutations:{updateFirstPerson(a){this.state.firstPerson={...this.state.firstPerson,...a}},updateSecondPerson(a){this.state.secondPerson={...this.state.secondPerson,...a}},setDebts(a){this.state.sumOfDebts=a===""?0:a},setBasePercentage(a){this.state.basePercentage=a===""?0:a},reset(){this.state.firstPerson.salary=0,this.state.firstPerson.percent=0,this.state.firstPerson.total=0,this.state.secondPerson.salary=0,this.state.secondPerson.percent=0,this.state.secondPerson.total=0,this.state.sumOfDebts=0,this.state.basePercentage=0}}},ll="/splitfair-app/assets/App-BA8Ww35l.css";class dl extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.firstSalary="0",this.secondSalary="0",this.expenses="0",this.selectedField="firstSalary",this.showCanvas=!1,this.store=hl,this.onFocusFirstSalaryBound=this.onFocusFirstSalary.bind(this),this.onFocusSecondSalaryBound=this.onFocusSecondSalary.bind(this),this.onFocusExpensesBound=this.onFocusExpenses.bind(this)}connectedCallback(){this.render()}onInputFirstName(r){this.store.mutations.updateFirstPerson({name:r.target.value}),this.render()}onInputSecondName(r){this.store.mutations.updateSecondPerson({name:r.target.value}),this.render()}onFocusFirstSalary(){this.setSelectedField("firstSalary")}onFocusSecondSalary(){this.setSelectedField("secondSalary")}onFocusExpenses(){this.setSelectedField("expenses")}onTapButtonNumberpad(r){const t=r.detail;if(t==="<"){this.selectedField==="firstSalary"?this.firstSalary="0":this.selectedField==="secondSalary"?this.secondSalary="0":this.selectedField==="expenses"&&(this.expenses="0"),this.render();return}if(t!=="Enter"){if(this.selectedField==="firstSalary"){if(this.firstSalary.length>7)return;this.firstSalary=this.firstSalary==="0"?t:this.firstSalary+t}else if(this.selectedField==="secondSalary"){if(this.secondSalary.length>7)return;this.secondSalary=this.secondSalary==="0"?t:this.secondSalary+t}else if(this.selectedField==="expenses"){if(this.expenses.length>7)return;this.expenses=this.expenses==="0"?t:this.expenses+t}this.render()}}calculate(){if(this.firstSalary==="0"||this.secondSalary==="0"||this.expenses==="0")return;let r=0,t=0;const e=(o,s=1)=>parseFloat(o.toFixed(s)),i={salary:this.firstSalary,total:0},n={salary:this.secondSalary,total:0};for(;r<=parseFloat(this.expenses);)i.total=e(Number(this.firstSalary)/100*t,0),n.total=e(Number(this.secondSalary)/100*t,0),r=i.total+n.total,t+=.01;this.store.mutations.setDebts(parseFloat(this.expenses)),this.store.mutations.setBasePercentage(e(t)),this.store.mutations.updateFirstPerson(i),this.store.mutations.updateSecondPerson(n),this.render()}onClickClear(){this.firstSalary="0",this.secondSalary="0",this.expenses="0",this.store.mutations.reset(),this.render()}onClickShare(){this.showCanvas=!0,this.render()}setSelectedField(r){this.selectedField=r,this.render()}render(){const r=this.store.state.firstPerson,t=this.store.state.secondPerson,e=this.store.state.currency,i=this.store.state.basePercentage,n=i!==0,o=r.name?r.name:"First person",s=t.name?t.name:"Second person";this.shadowRoot.innerHTML=`
      <link rel="stylesheet" href="${ll}">
      <div class="App">
        <div class="bg"></div>
        <header>
          <div class="wrap-logo">
            <div class="block block-02"></div>
             <div class="block block-03">
                <img src="/splitfair-app/logo.svg" alt="logo" class="logo" />
             </div>
            <div class="block block-04"></div>
          </div>
        </header>
        <section class="incomings">
          <div class="wrap-income">
            <h2 class="block label">
              <input
                value="${r.name}"
                type="text"
                placeholder="Name"
                tabindex="1"
                class="input"
                autofocus
              />
            </h2>
            <div class="block income ${this.selectedField==="firstSalary"?"active":""}">
              ${this.firstSalary!=="0"?`<span>${e}</span>`:""}
              <input
                value="${this.firstSalary}"
                type="text"
                placeholder="salary"
                tabindex="3"
                class="input firstSalaryField"
                readonly
              />
            </div>
          </div>
          <div class="wrap-income">
            <h2 class="block label">
              <input
                value="${t.name}"
                type="text"
                placeholder="Name"
                tabindex="2"
                class="input"
              />
            </h2>
            <div class="block income ${this.selectedField==="secondSalary"?"active":""}">
              ${this.secondSalary!=="0"?`<span>${e}</span>`:""}
              <input
                value="${this.secondSalary}"
                type="number"
                placeholder="salary"
                tabindex="4"
                class="input secondSalaryField"
                readonly
              />
            </div>
          </div>
        </section>
        <section class="expenses ${this.selectedField==="expenses"?"active":""}">
          <div class="block label">Expenses</div>
          <div class="block value">
            ${this.expenses!=="0"?`<span>${e}</span>`:""}
            <input
              value="${this.expenses}"
              type="text"
              placeholder="expenses"
              tabindex="5"
              class="input expensesField"
              readonly
            />
          </div>
        </section>
        <a class="block split-btn" tabindex="6"> Split </a>
        <number-pad></number-pad>
        ${n?`
        <section class="results">
          <div class="block title">Results</div>
          <div class="wrap-results">
            <div class="block label">${o}</div>
            <div class="block value">${e}${r.total}</div>
          </div>
          <div class="wrap-results">
            <div class="block label">${s}</div>
            <div class="block value">${e}${t.total}</div>
          </div>
          <div class="block percent-each">%${i} each</div>
          <div class="wrap-buttons">
            <div class="block share">Share</div>
            <div class="block clear">Clear</div>
          </div>
        </section>
        `:""}
        ${this.showCanvas?`<share-canvas first-person='${JSON.stringify(r)}' second-person='${JSON.stringify(t)}' currency='${e}'></share-canvas>`:""}
      </div>
    `;const h=this.shadowRoot.querySelectorAll('input[placeholder="Name"]');h[0].addEventListener("input",this.onInputFirstName),h[1].addEventListener("input",this.onInputSecondName),this.shadowRoot.querySelector(".firstSalaryField").addEventListener("focus",this.onFocusFirstSalaryBound),this.shadowRoot.querySelector(".secondSalaryField").addEventListener("focus",this.onFocusSecondSalaryBound),this.shadowRoot.querySelector(".expensesField").addEventListener("focus",this.onFocusExpensesBound),this.shadowRoot.querySelector(".split-btn").addEventListener("click",this.calculate),this.shadowRoot.querySelector("number-pad").addEventListener("tapped-button",this.onTapButtonNumberpad),n&&(this.shadowRoot.querySelector(".clear").addEventListener("click",this.onClickClear),this.shadowRoot.querySelector(".share").addEventListener("click",this.onClickShare))}}customElements.define("app-component",dl);class cl extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.menuOpened=!1,this.desktopOnly=!0}connectedCallback(){const r=window.matchMedia("(max-width: 600px)");this.desktopOnly=!r.matches,r.addEventListener("change",this.screenTest),this.render()}moveAppSideways(r){this.menuOpened=r.detail,this.render()}screenTest(r){this.desktopOnly=!r.matches,this.render()}render(){this.shadowRoot.innerHTML=`
      <style>
        :host {
          --light-bg: #d9e4ea;
          --dark-bg: #333333;
          --gray: #bdbdbd;
          --black: #0d0b0d;
          --green: #0ecb66;
          --red: #fa4f23;
          --blue: #0b98dd;
          --white: #ffffff;
          --light-bg-02: #cbc9c9;
          --block-height: calc((100vh / 9) - 11px);
          --block-min-height: 55px;
          --block-max-height: 84px;
          --block-height-header: calc(100vh / 9);
          font-family: 'Avenir', Helvetica, Arial, sans-serif;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
          text-align: center;
          overflow-y: auto;
          overflow-x: hidden;
          width: 100vw;
          height: 100vh;
          position: relative;
            cursor: url(/splitfair-app/cursor-red.png), auto;
          display: flex;
          justify-content: center;
          align-items: center;
        }

        .Application__link {
          position: absolute;
          text-decoration: none;
          color: var(--black);
          font-size: 28px;
          z-index: 1;
          transition: opacity 250ms ease;
        }

        .Application__link.menuOpened {
          opacity: 0;
          pointer-events: none;
        }

        .Application__link.logo {
          top: 4vw;
          left: 5vw;
        }

        .Application__version {
          position: absolute;
          bottom: 4vw;
          left: 5vw;
          color: var(--black);
          font-size: 28px;
          opacity: 0.4;
          transition: opacity 250ms ease;
        }

        .Application__version.menuOpened {
          opacity: 0;
          pointer-events: none;
        }
      </style>
      ${this.desktopOnly?`<a href="#" class="Application__link logo ${this.menuOpened?"menuOpened":""}"> splitfair </a>`:""}
      ${this.desktopOnly?`<span class="Application__version ${this.menuOpened?"menuOpened":""}"> v0.1 </span>`:""}
      <app-component class="${this.menuOpened?"menuOpened":""}"></app-component>
      ${this.desktopOnly?"<download-app-section></download-app-section>":""}
      ${this.desktopOnly?"<about-section></about-section>":""}
    `,this.desktopOnly&&(this.shadowRoot.querySelector("download-app-section").addEventListener("is-menu-open",this.moveAppSideways),this.shadowRoot.querySelector("about-section").addEventListener("is-menu-open",this.moveAppSideways))}}customElements.define("splitfair-application",cl);const ul=document.createElement("splitfair-application");document.getElementById("app").appendChild(ul);
//# sourceMappingURL=index-Ci2Wujnn.js.map
